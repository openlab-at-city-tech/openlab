function badgeos_add_new_deduct_step(e){jQuery.post(ajaxurl,{action:"add_deduct_step",achievement_id:e},function(e){jQuery(e).appendTo("#deduct_steps_list"),new_step_menu_order=Number(jQuery("#deduct_steps_list li.step-row").eq(-2).children('input[name="order"]').val())+1,jQuery("#deduct_steps_list li.step-row:last").children('input[name="order"]').val(new_step_menu_order),jQuery("#deduct_steps_list li.step-row:last").children(".select-trigger-type").change()})}function badgeos_delete_deduct_step(e){jQuery.post(ajaxurl,{action:"delete_deduct_step",step_id:e},function(t){jQuery(".step-"+e).remove()})}function badgeos_update_deduct_steps(e){jQuery(".save-deduct-steps-spinner").show(),step_data={action:"update_deduct_steps",steps:[]};var t=0;jQuery("#deduct_steps_list .step-row").each(function(){var e=jQuery(this),s=e.find(".select-trigger-type").val(),i=e.find(".badgeos-select-visit-post").val(),d=e.find(".badgeos-select-visit-page").val(),a=e.find("#badgeos_dedpoint_step_dynamic_section_"+s+" .badgeos_dedpoint_step_ddl_dynamic").val(),n=e.find("#badgeos_dedpoint_step_dynamic_section_"+s+" .badgeos_dedpoint_step_ddl_dynamic").attr("id"),_=e.find(".badgeos_dedpoint_step_fields_"+a+":input").serialize(),o={step_id:e.attr("data-step-id"),order:e.find('input[name="order"]').val(),required_count:e.find(".required-count").val(),point_value:e.find(".point-value").val(),trigger_type:s,achievement_type:e.find(".select-achievement-type").val(),num_of_years:e.find(".badgeos-num-of-years").val(),num_of_days:e.find(".badgeos-num-of-days").val(),num_of_months:e.find(".badgeos-num-of-months").val(),badgeos_subtrigger_id:n,badgeos_subtrigger_value:a,badgeos_fields_data:_,visit_post:i,visit_page:d,achievement_post:"badgeos_specific_new_comment"===s?e.find("input.select-achievement-post").val():e.find("select.select-achievement-post").val(),title:e.find(".step-title .title").val()};e.trigger("update_step_data",[o,e]),step_data.steps.push(o),t++}),0==t&&jQuery(".save-deduct-steps-spinner").hide(),jQuery.post(ajaxurl,step_data,function(e){var t=jQuery.parseJSON(e);jQuery.each(t,function(e,t){jQuery("#step-"+e+"-title").val(t)}),jQuery(".save-deduct-steps-spinner").hide()})}jQuery(document).ready(function(e){e("#_badgeos_earned_by").change(function(){"triggers"==e(this).val()?e("#badgeos_steps_ui").show():e("#badgeos_steps_ui").hide()}).change(),e("#deduct_steps_list").sortable({update:function(){e("#deduct_steps_list li").each(function(t,s){e(this).children('input[name="order"]').val(t)})}}),e("#deduct_steps_list").on("change",".select-trigger-type",function(){var t=e(this).val(),s=e(this).siblings(".select-achievement-type"),i=e(this).siblings(".badgeos-select-visit-post"),d=e(this).siblings(".badgeos-select-visit-page"),a=e(this).siblings(".badgeos-num-of-years"),n=e(this).siblings(".badgeos-num-of-days"),_=e(this).siblings(".badgeos-num-of-months");"any-achievement"==t||"all-achievements"==t||"specific-achievement"==t?s.show():s.hide(),"badgeos_wp_not_login"==t||"badgeos_on_completing_num_of_day"==t?n.show():n.hide(),"badgeos_on_completing_num_of_year"==t?a.show():a.hide(),"badgeos_on_completing_num_of_month"==t?_.show():_.hide(),"badgeos_visit_a_page"==t||"badgeos_award_author_on_visit_page"==t?d.show():d.hide(),"badgeos_visit_a_post"==t||"badgeos_award_author_on_visit_post"==t?i.show():i.hide(),e(".badgeos_dedpoint_step_fields").hide(),e(".badgeos_dedpoint_step_ddl_dynamic").hide(),e("#badgeos_dedpoint_step_ddl_dynamic_"+t).show().trigger("change"),s.change()}),e(".badgeos_dedpoint_step_ddl_dynamic").on("change",function(){e(".badgeos_dedpoint_step_subddl_dynamic").hide(),e(".badgeos_dedpoint_step_subtxt_dynamic").hide(),main_trigger=e(this).data("trigger"),curr_trigger=e(this).val(),e(".badgeos_dedpoint_step_subddl_"+curr_trigger).show(),e(".badgeos_dedpoint_step_subtxt_"+curr_trigger).show()}),e(".select-trigger-type").change(),e("#deduct_steps_list").on("change",".select-achievement-type",function(){var t=e(this),s=t.val(),i=t.parent("li").attr("data-step-id"),d=[t.siblings('input[name="post_id"]').val()],a=t.siblings(".select-trigger-type").val();""!==s&&"specific-achievement"==a?e.post(ajaxurl,{action:"post_deduct_select_ajax",achievement_type:s,step_id:i,excluded_posts:d},function(e){t.siblings("select.select-achievement-post").html(e),t.siblings("select.select-achievement-post").show()}):(t.siblings(".select-achievement-post").hide(),"badgeos_specific_new_comment"==a&&t.siblings("input.select-achievement-post").show())}),e(".select-achievement-type").change()});