function badgeos_add_new_award_step(e){jQuery.post(ajaxurl,{action:"add_award_step",achievement_id:e},function(e){jQuery(e).appendTo("#award_steps_list"),new_step_menu_order=Number(jQuery("#award_steps_list li.step-row").eq(-2).children('input[name="order"]').val())+1,jQuery("#award_steps_list li.step-row:last").children('input[name="order"]').val(new_step_menu_order),jQuery("#award_steps_list li.step-row:last").children(".select-trigger-type").change()})}function badgeos_delete_award_step(e){jQuery.post(ajaxurl,{action:"delete_award_step",step_id:e},function(t){jQuery(".step-"+e).remove()})}function badgeos_update_award_steps(e){jQuery(".save-award-steps-spinner").show(),step_data={action:"update_award_steps",steps:[]};var t=0;jQuery("#award_steps_list .step-row").each(function(){var e=jQuery(this),a=e.find(".select-trigger-type").val(),s=e.find(".badgeos-select-visit-post").val(),i=e.find(".badgeos-select-visit-page").val(),d=e.find("#badgeos_awardpoint_step_dynamic_section_"+a+" .badgeos_awardpoint_step_ddl_dynamic").val(),n=e.find("#badgeos_awardpoint_step_dynamic_section_"+a+" .badgeos_awardpoint_step_ddl_dynamic").attr("id"),_=e.find(".badgeos_awardpoint_step_fields_"+d+":input").serialize(),r={step_id:e.attr("data-step-id"),order:e.find('input[name="order"]').val(),required_count:e.find(".required-count").val(),point_value:e.find(".point-value").val(),trigger_type:a,achievement_type:e.find(".select-achievement-type").val(),badgeos_subtrigger_id:n,badgeos_subtrigger_value:d,badgeos_fields_data:_,visit_post:s,num_of_years:e.find(".badgeos-num-of-years").val(),visit_page:i,achievement_post:"badgeos_specific_new_comment"===a?e.find("input.select-achievement-post").val():e.find("select.select-achievement-post").val(),title:e.find(".step-title .title").val()};e.trigger("update_step_data",[r,e]),step_data.steps.push(r),t++}),0==t&&jQuery(".save-award-steps-spinner").hide(),jQuery.post(ajaxurl,step_data,function(e){var t=jQuery.parseJSON(e);jQuery.each(t,function(e,t){jQuery("#step-"+e+"-title").val(t)}),jQuery(".save-award-steps-spinner").hide()})}jQuery(document).ready(function(e){e("#_badgeos_earned_by").change(function(){"triggers"==e(this).val()?e("#badgeos_steps_ui").show():e("#badgeos_steps_ui").hide()}).change(),e("#award_steps_list").sortable({update:function(){e("#award_steps_list li").each(function(t,a){e(this).children('input[name="order"]').val(t)})}}),e("#award_steps_list").on("change",".select-trigger-type",function(){var t=e(this).val(),a=e(this).siblings(".select-achievement-type"),s=e(this).siblings(".badgeos-select-visit-post"),i=e(this).siblings(".badgeos-select-visit-page"),d=e(this).siblings(".badgeos-num-of-years");"any-achievement"==t||"all-achievements"==t||"specific-achievement"==t?a.show():a.hide(),"badgeos_visit_a_page"==t||"badgeos_award_author_on_visit_page"==t?i.show():i.hide(),"badgeos_visit_a_post"==t||"badgeos_award_author_on_visit_post"==t?s.show():s.hide(),"badgeos_on_completing_num_of_year"==t?d.show():d.hide(),e(".badgeos_awardpoint_step_fields").hide(),e(".badgeos_awardpoint_step_ddl_dynamic").hide(),e("#badgeos_awardpoint_step_ddl_dynamic_"+t).show().trigger("change"),a.change()}),e(".badgeos_awardpoint_step_ddl_dynamic").on("change",function(){e(".badgeos_awardpoint_step_subddl_dynamic").hide(),e(".badgeos_awardpoint_step_subtxt_dynamic").hide(),main_trigger=e(this).data("trigger"),curr_trigger=e(this).val(),e(".badgeos_awardpoint_step_subddl_"+curr_trigger).show(),e(".badgeos_awardpoint_step_subtxt_"+curr_trigger).show()}),e(".select-trigger-type").change(),e("#award_steps_list").on("change",".select-achievement-type",function(){var t=e(this),a=t.val(),s=t.parent("li").attr("data-step-id"),i=[t.siblings('input[name="post_id"]').val()],d=t.siblings(".select-trigger-type").val();""!==a&&"specific-achievement"==d?e.post(ajaxurl,{action:"post_award_select_ajax",achievement_type:a,step_id:s,excluded_posts:i},function(e){t.siblings("select.select-achievement-post").html(e),t.siblings("select.select-achievement-post").show()}):(t.siblings(".select-achievement-post").hide(),"badgeos_specific_new_comment"==d&&t.siblings("input.select-achievement-post").show())}),e(".select-achievement-type").change()});