function QuizChoice(e,i,c,t){this.text=e,this.value=i||e,this.isSelected=!1,this.price="",this.gquizIsCorrect=c,this.gquizWeight=t}function StartChangeQuizType(e){var i=GetSelectedField();return i.gquizFieldType=e,jQuery.each(i.choices,function(e){i.choices[e].gquizIsCorrect=!1,i.choices[e].gquizWeight=0}),StartChangeInputType(e,i)}function GenerateQuizChoiceValue(e){return"gquiz"+e.id+"xxxxxxxx".replace(/[xy]/g,function(e){var i=16*Math.random()|0;return("x"==e?i:3&i|8).toString(16)})}function gquiz_toggle_correct_choice(e,i){var c=GetSelectedField();if("radio"==c.inputType||"select"==c.inputType){for(var t=0;t<c.choices.length;t++)c.choices[t].gquizIsCorrect&&(c.choices[t].gquizIsCorrect=!1);jQuery("button.gquiz-button-correct-choice").each(function(e){jQuery(this).removeClass("chosen-as-correct")}),jQuery(e).addClass("chosen-as-correct"),c.choices[i].gquizIsCorrect=!0}else"checkbox"==c.inputType&&(jQuery(e).hasClass("chosen-as-correct")?(jQuery(e).removeClass("chosen-as-correct"),jQuery(e).attr("title",gquiz_strings.defineAsCorrect).attr("alt","Not correct")):(jQuery(e).attr("title",gquiz_strings.defineAsIncorrect).attr("alt","Correct"),jQuery(e).addClass("chosen-as-correct")),e=c.choices[i].gquizIsCorrect,c.choices[i].gquizIsCorrect=!e);gquiz_maybe_display_choices_help(c),RefreshSelectedFieldPreview()}function gquizToggleValues(){jQuery("#gquiz_gfield_settings_choices_container").toggleClass("gquiz-choice-values-visible")}function gquiz_maybe_display_choices_help(e){for(var i=!0,c=0;c<e.choices.length;c++)e.choices[c].gquizIsCorrect&&(i=!1);i?jQuery(".gquiz-choices-help").show():jQuery(".gquiz-choices-help").hide()}function gquizGetChoices(e){gquizVars.imagesUrl;for(var i,c="",t=0;t<e.choices.length;t++)i="gquiz-button-correct-choice",!0===e.choices[t].gquizIsCorrect&&(i+=" chosen-as-correct"),c+="<li class='gquiz-choice-row' data-index='"+t+"'>",c+='<i class="gquiz-choice-handle"></i>',c+="<button class='"+i+"' title='"+gquiz_strings.toggleCorrectIncorrect+"' onclick=\"gquiz_toggle_correct_choice(this, '"+t+"');\"></button>",c+="<input type='text' id='gquiz-choice-text-"+t+"' value=\""+e.choices[t].text.replace(/"/g,"&quot;")+"\"  class='field-choice-input field-choice-text' />",c+="<input type='text' id='gquiz-choice-value-"+t+"' value=\""+e.choices[t].value+"\" class='field-choice-input field-choice-value' >",void 0===e.choices[t].gquizWeight&&(e.choices[t].gquizWeight=1==e.choices[t].gquizIsCorrect?1:0),c+="<input id='gquiz-choice-weight-"+t+"' type='text' class='gquiz-choice-weight' onkeyup='gquizSetFieldChoice("+t+");' value='"+e.choices[t].gquizWeight+"' /> ",c+="<button class='gf_insert_field_choice gquiz-insert-choice' aria-label='Add Answer'></button>",1<e.choices.length&&(c+="<button class='gf_delete_field_choice gquiz-delete-choice' aria-label='Remove Answer'></button>"),c+="</li>";return c+='<div class="gquiz-choices-help" style="display:none">'+gquiz_strings.markAnAnswerAsCorrect+"</div>"}function gquizSetFieldChoice(e){var i=jQuery("#gquiz-choice-text-"+e).val(),c=jQuery("#gquiz-choice-value-"+e).val(),t=jQuery("#gquiz-choice-weight-"+e).val(),o=GetSelectedField();o.choices[e].text=i,o.choices[e].value=o.enableChoiceValue?c:i,o.choices[e].gquizWeight=t,jQuery("#field_choices :radio, #field_choices :checkbox").each(function(e){o.choices[e].isSelected=this.checked}),LoadBulkChoices(o),UpdateFieldChoices(GetInputType(o))}function gquizInsertChoice(e){var i=GetSelectedField(),c=new QuizChoice("",GenerateQuizChoiceValue(i),!1,0);i.choices.splice(e,0,c),gquizLoadChoices(),UpdateFieldChoices(GetInputType(i))}function gquizDeleteChoice(e){var i=GetSelectedField(),c=jQuery("#gquiz-choice-value-"+e).val();HasConditionalLogicDependency(i.id,c)&&!confirm(gf_vars.conditionalLogicDependencyChoice)||(i.choices.splice(e,1),gquizLoadChoices(),UpdateFieldChoices(GetInputType(i)))}function gquizLoadChoices(){jQuery("#gquiz-field-choices").html(gquizGetChoices(field)),gquiz_maybe_display_choices_help(field)}function gquizToggleWeightedScore(e){SetFieldProperty("gquizWeightedScoreEnabled",e.checked),jQuery("#gquiz_gfield_settings_choices_container").toggleClass("gquiz-weighted-score")}function gquizFieldTypeChange(e){""!=jQuery(e).val()&&jQuery("#field_settings").slideUp(function(){StartChangeQuizType(jQuery("#gquiz-field-type").val())})}function gquizOpenBulkAdd(e){tb_show(e,"#TB_inline?height=500&amp;width=600&amp;inlineId=gfield_bulk_add","")}function gform_new_choice_quiz(e,i){return"quiz"==e.type&&(i.value=GenerateQuizChoiceValue(e),i.gquizIsCorrect=!1,i.gquizWeight=0),i}function gquiz_toggle_answer_explanation(e){e?jQuery(".gquiz-setting-answer-explanation").show():jQuery(".gquiz-setting-answer-explanation").hide()}function gquizMoveFieldChoice(e,i){var c=GetSelectedField(),t=c.choices[e];c.choices.splice(e,1),c.choices.splice(i,0,t),gquizLoadChoices(),UpdateFieldChoices(GetInputType(c))}function SetDefaultValues_quiz(e){return e.gquizFieldType="radio",e.label="Untitled Quiz Field",e.inputType="radio",e.inputs=null,e.enableChoiceValue=!0,e.enablePrice=!1,e.gquizEnableRandomizeQuizChoices=!1,e.gquizShowAnswerExplanation=!1,e.gquizAnswerExplanation="",e.gquizWeightedScoreEnabled=!1,e.choices||(e.choices=new Array(new QuizChoice(gquiz_strings.firstChoice,GenerateQuizChoiceValue(e),!1,0),new QuizChoice(gquiz_strings.secondChoice,GenerateQuizChoiceValue(e),!1,0),new QuizChoice(gquiz_strings.thirdChoice,GenerateQuizChoiceValue(e),!1,0))),e}jQuery(document).bind("gform_load_field_choices",function(e,i){"quiz"==i.type&&(jQuery("#gquiz-field-choices").html(gquizGetChoices(i)),gquiz_maybe_display_choices_help(i))}),jQuery(document).on("gform_load_field_settings",function(e,i,c){var t;"quiz"==i.type&&(void 0===i.gquizEnableRandomizeQuizChoices&&(i.gquizEnableRandomizeQuizChoices=!1),jQuery("#gquiz-randomize-quiz-choices").prop("checked",i.gquizEnableRandomizeQuizChoices),jQuery("#gquiz-field-type").val(i.gquizFieldType),jQuery("#gquiz-question").val(i.label),jQuery("#gquiz-answer-explanation").val(i.gquizAnswerExplanation),null==i.gquizShowAnswerExplanation&&(i.gquizShowAnswerExplanation=!1),t=i.gquizShowAnswerExplanation,void 0===i.gquizWeightedScoreEnabled&&(i.gquizWeightedScoreEnabled=!1),jQuery("#gquiz-weighted-score-enabled").prop("checked",i.gquizWeightedScoreEnabled),i.gquizWeightedScoreEnabled?jQuery("#gquiz_gfield_settings_choices_container").addClass("gquiz-weighted-score"):jQuery("#gquiz_gfield_settings_choices_container").removeClass("gquiz-weighted-score"),jQuery("#gquiz-show-answer-explanation").prop("checked",t),gquiz_toggle_answer_explanation(t),jQuery("li.label_setting").hide(),jQuery("#gquiz-field-type").prop("disabled",has_entry(i.id)))}),gform.addFilter("gform_editor_field_settings",function(e,i){return"quiz"!==i.type?e:e.filter(function(e){return-1===[".choices_setting",".duplicate_setting"].indexOf(e)})}),jQuery(document).ready(function(){jQuery("#gquiz-field-choices").sortable({axis:"y",handle:".gquiz-choice-handle",update:function(e,i){gquizMoveFieldChoice(i.item.data("index"),i.item.index())}}),jQuery(".gquiz-setting-choices").on("input propertychange",".field-choice-input",function(e){var i=jQuery(this);gquizSetFieldChoice(i.closest("li.gquiz-choice-row").data("index")),(i.hasClass("field-choice-text")||i.hasClass("field-choice-value"))&&(CheckChoiceConditionalLogicDependency(this),e.stopPropagation())}).on("click",".gquiz-insert-choice",function(){gquizInsertChoice(jQuery(this).closest("li.gquiz-choice-row").data("index")+1)}).on("click",".gquiz-delete-choice",function(){gquizDeleteChoice(jQuery(this).closest("li.gquiz-choice-row").data("index"))})});