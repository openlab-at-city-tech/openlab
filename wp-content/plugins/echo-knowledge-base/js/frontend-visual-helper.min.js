"use strict";jQuery(document).ready(function(e){function t(){const t=e("body").width();let i="",a=0,n=0;for(const t of o)if(e(t.checkSelector).length){i=t.prefix,a=Math.round(e(t.containerSelector).width()),n=Math.round(e(t.searchSelector).width());break}i&&(n&&e(`.js-epkb-${i}-search-width`).text(`${n}px`),a&&e(`.js-epkb-${i}-width-container`).text(`${a}px`),t&&e(`.js-epkb-${i}-width`).text(`${t}px`))}function i(e,t,i){if("show"===e){let e='<div class="epkb-admin-dialog-box-loading"><div class="epkb-admin-dbl__header"><div class="epkb-admin-dbl-icon epkbfa epkbfa-hourglass-half"></div>'+(t?'<div class="epkb-admin-text">'+t+"</div>":"")+'</div></div><div class="epkb-admin-dialog-box-overlay"></div>';i.append(e)}else"remove"===e&&(i.find(".epkb-admin-dialog-box-loading").remove(),i.find(".epkb-admin-dialog-box-overlay").remove())}localStorage.getItem("epkb_template_changed")&&(setTimeout(function(){e(".js-epkb-accordion-toggle#epkb-vshelp-switch-template").trigger("click")},100),localStorage.removeItem("epkb_template_changed")),e(".js-epkb-accordion-toggle").on("click",function(t){t.preventDefault(),e(".epkb-vshelp-accordion-body").not(e(this).parents(".epkb-vshelp-accordion-wrapper").find(".epkb-vshelp-accordion-body")).slideUp(),e(this).parents(".epkb-vshelp-accordion-wrapper").find(".epkb-vshelp-accordion-body").slideToggle()}),e(".js-epkb-side-menu-toggle").on("change",function(t){let i=e(this),o=e(".epkb-vshelp-side-menu-wrapper"),a=e(".epkb-vshelp-info-icon"),n=e(".epkb-vshelp-info-modal"),l=e(".epkb-vshelp-hide-switcher");i.prop("checked")?(o.slideDown(),a.show(),l.addClass("epkb-vshelp-hide-switcher--hidden")):(o.slideUp(),a.hide(),n.hide(),l.removeClass("epkb-vshelp-hide-switcher--hidden"));let s={action:"epkb_visual_helper_update_switch_settings",setting_name:i.attr("name"),kb_id:e(this).data("kbid")};e.ajax({type:"POST",dataType:"json",data:s,url:epkb_vars.ajaxurl}).success(function(e){})}),e(".epkb-vshelp-hide-switcher").on("click",function(){e(this).parents(".epkb-vshelp-toggle-wrapper").hide();let t={action:"epkb_visual_helper_update_switch_settings",kb_id:e(this).data("kbid")};e.ajax({type:"POST",dataType:"json",data:t,url:epkb_vars.ajaxurl}).success(function(e){})}),e(".epkb-settings-control-circle-radio input").on("change",function(){let t={action:"epkb_visual_helper_switch_template",kb_id:e(this).data("kbid"),current_template:e(this).val(),prop_name:e(this).attr("name")};e(".eckb-kb-no-content").length||e("body").append('<div class="eckb-kb-no-content"></div>'),i("show","",e("body .eckb-kb-no-content")),e.ajax({type:"POST",dataType:"json",data:t,url:epkb_vars.ajaxurl}).success(function(t){t.success?(localStorage.setItem("epkb_template_changed",!0),window.location.reload(!0)):i("remove","",e("#epkb-modular-main-page-container .eckb-kb-no-content"))})});const o=[{checkSelector:"#epkb-modular-main-page-container",prefix:"mp",containerSelector:"#epkb-ml__module-categories-articles",searchSelector:"#epkb-ml__row-1"},{checkSelector:"#eckb-article-page-container-v2",prefix:"ap",containerSelector:"#eckb-article-body",searchSelector:"#eckb-article-header"},{checkSelector:"#eckb-archive-body",prefix:"cp",containerSelector:"#eckb-archive-body",searchSelector:"#eckb-archive-header"}];t(),e(window).on("resize",function(){t()}),function(){let t=e(".epkb-vshelp-info-modal");const i=e(".js-epkb-side-menu-toggle").prop("checked")?"":' style="display: none;"';t.each(function(t,o){let a=e(o),n=a.data("selectors").split(","),l=0;for(let t of n){let o=e(t).eq(0);if(o.length){let e=a.data("section-id");o.addClass("epkb-vshelp--has-info-icon"),o.append('<span class="ep_font_icon_info epkb-vshelp-info-icon epkb-vshelp-info-icon--'+e+"-"+l+'" data-section-id="'+e+'"'+i+"></span>"),l++}}})}(),e(document).on("click",".epkb-vshelp-info-icon",function(t){t.stopPropagation(),t.preventDefault(),e(".epkb-vshelp-background").remove();let i=e(this).data("section-id"),o=e(this).offset(),a=o.top,n=o.left,l=e('.epkb-vshelp-info-modal[data-section-id="'+i+'"]'),s="epkb-vshelp-info-modal--triangle-right";if(l.length)if(e(this).hasClass("epkb-vshelp-info-modal--active"))e(this).removeClass("epkb-vshelp-info-modal--active"),l.hide();else{e("#epkb-modular-main-page-container, #eckb-article-page-container-v2, #eckb-archive-page-container").append('<div class="epkb-vshelp-background"></div>');let t="";switch(a>l.find(".epkb-vshelp-info-modal__title").outerHeight()+35&&(a=a-l.find(".epkb-vshelp-info-modal__title").outerHeight()/2-e(this).outerHeight()),t=n>l.outerWidth()+35?"rightSpace":e(window).outerWidth()-n>l.outerWidth()+35?"leftSpace":"center"){case"rightSpace":n=n-l.outerWidth()-35;break;case"leftSpace":n=n+e(this).outerHeight()+35,s="epkb-vshelp-info-modal--triangle-left";break;case"center":n=e(window).outerWidth()/2-l.outerWidth()/2,a=a+e(this).outerHeight()+70,s=""}l.css({top:a+"px",left:n+"px"}),e(".epkb-vshelp-info-icon").removeClass("epkb-vshelp-info-modal--active"),e(".epkb-vshelp-info-modal").hide().removeClass("epkb-vshelp-info-modal--triangle-right epkb-vshelp-info-modal--triangle-left"),e(this).addClass("epkb-vshelp-info-modal--active"),l.addClass(s).show()}}),e(document).on("click",function(t){e(t.target).closest(".epkb-vshelp-info-icon, .epkb-vshelp-info-modal").length||(e(".epkb-vshelp-info-icon").removeClass("epkb-vshelp-info-modal--active"),e(".epkb-vshelp-info-modal").hide(),e(".epkb-vshelp-background").remove())})});