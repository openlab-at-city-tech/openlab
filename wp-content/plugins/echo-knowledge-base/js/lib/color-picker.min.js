!function(e,t){var o;o={options:{defaultColor:!1,change:!1,clear:!1,hide:!0,palettes:!0,width:255,mode:"hsv",type:"full",slider:"horizontal"},_createHueOnly:function(){var e,t=this,o=t.element;o.hide(),e="hsl("+o.val()+", 100, 50)",o.iris({mode:"hsl",type:"hue",hide:!1,color:e,change:function(e,o){"function"==typeof t.options.change&&t.options.change.call(this,e,o)},width:t.options.width,slider:t.options.slider})},_create:function(){if(e.support.iris&&"undefined"!=typeof epkb_editor){var t=this,o=t.element;if(e.extend(t.options,o.data()),"hue"===t.options.type)return t._createHueOnly();t.close=e.proxy(t.close,t),t.initialValue=o.val(),o.addClass("epkb-color-picker"),o.parent("label").length||(o.wrap("<label></label>"),t.wrappingLabelText=e('<span class="screen-reader-text"></span>').insertBefore(o).text(epkb_editor.color_value)),t.wrappingLabel=o.parent(),t.wrappingLabel.wrap('<div class="epkb-picker-container" />'),t.wrap=t.wrappingLabel.parent(),t.toggler=e('<button type="button" class="button epkb-color-result" aria-expanded="false"><span class="epkb-color-result-text"></span></button>').insertBefore(t.wrappingLabel).css({backgroundColor:t.initialValue}),t.toggler.find(".epkb-color-result-text").text(epkb_editor.select_color),t.pickerContainer=e('<div class="epkb-picker-holder" />').insertAfter(t.wrappingLabel),t.button=e('<input type="button" class="button button-small" />'),t.options.defaultColor?t.button.addClass("epkb-picker-default").val(epkb_editor.default).attr("aria-label",epkb_editor.select_default_color):t.button.addClass("epkb-picker-clear").val(epkb_editor.clear).attr("aria-label",epkb_editor.clear_color),t.wrappingLabel.wrap('<span class="epkb-picker-input-wrap hidden" />').after(t.button),t.inputWrapper=o.closest(".epkb-picker-input-wrap"),o.iris({target:t.pickerContainer,hide:t.options.hide,width:t.options.width,mode:t.options.mode,palettes:t.options.palettes,change:function(e,o){t.toggler.css({backgroundColor:o.color.toString()}),"function"==typeof t.options.change&&t.options.change.call(this,e,o)}}),o.val(t.initialValue),t._addListeners(),t.options.hide||t.toggler.trigger("click")}},_addListeners:function(){var t=this;t.wrap.on("click.epkbcolorpicker",function(e){e.stopPropagation()}),t.toggler.on("click",function(){t.toggler.hasClass("epkb-picker-open")?t.close():t.open()}),t.element.change(function(o){var i=e(this).val();""!==i&&"#"!==i||(t.toggler.css("backgroundColor",""),"function"==typeof t.options.clear&&t.options.clear.call(this,o))}),t.button.on("click",function(o){var i=e(this);i.hasClass("epkb-picker-clear")?(t.element.val(""),t.toggler.css("backgroundColor",""),"function"==typeof t.options.clear&&t.options.clear.call(this,o)):i.hasClass("epkb-picker-default")&&t.element.val(t.options.defaultColor).change()})},open:function(){this.element.iris("toggle"),this.inputWrapper.removeClass("hidden"),this.wrap.addClass("epkb-picker-active"),this.toggler.addClass("epkb-picker-open").attr("aria-expanded","true"),e("body").trigger("click.epkbcolorpicker").on("click.epkbcolorpicker",this.close)},close:function(){this.element.iris("toggle"),this.inputWrapper.addClass("hidden"),this.wrap.removeClass("epkb-picker-active"),this.toggler.removeClass("epkb-picker-open").attr("aria-expanded","false"),e("body").off("click.epkbcolorpicker",this.close)},color:function(e){if(void 0===e)return this.element.iris("option","color");this.element.iris("option","color",e)},defaultColor:function(e){if(void 0===e)return this.options.defaultColor;this.options.defaultColor=e}},e.widget("epkb.epkbColorPicker",o)}(jQuery);