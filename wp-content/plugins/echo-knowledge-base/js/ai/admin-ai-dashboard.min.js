(function(){"use strict";const{useState:e,useEffect:t,createElement:a}=wp.element;const{__:s}=wp.i18n;const{showError:n,showSuccess:o,makeApiRequest:i}=window.EPKB_AI_Util_React||{};const l=({settings:t,tabData:i,isLoading:l,onTabSwitch:c})=>{const r=i?.status||null;const d=t?.show_get_started||r?.show_get_started;const[p,b]=e([]);const[u,k]=e("");const m=()=>{if(!r){return null}if(d){return null}if(!d&&(r.overall==="error"||r.overall==="warning")){const e=[...r.issues||[],...r.warnings||[]];if(e.length>0){return a("div",{className:"epkb-ai-status-issues"},a("div",{className:"epkb-ai-status-section"},a("h3",null,s("Warnings","echo-knowledge-base")),e.map(((e,t)=>a("div",{key:t,className:"epkb-ai-notice epkb-ai-notice-warning"},a("p",null,e.message),e.action&&a("p",{className:"epkb-ai-action"},e.link?a("a",{href:e.link,className:"epkb-ai-button epkb-ai-button-small"},e.action):e.action))))))}return a("div",{className:"epkb-ai-status-issues"},r.warnings.length>0&&a("div",{className:"epkb-ai-status-section"},a("h3",null,s("Warnings","echo-knowledge-base")),r.warnings.map(((e,t)=>a("div",{key:t,className:"epkb-ai-notice epkb-ai-notice-warning"},a("p",null,e.message),e.action&&a("p",{className:"epkb-ai-action"},e.link?a("a",{href:e.link,className:"epkb-ai-button epkb-ai-button-small"},e.action):e.action))))))}return null};const g=()=>a("div",{className:"epkb-ai-welcome-setup"},a("div",{className:"epkb-ai-welcome-header"},a("h2",null,s("Welcome to AI Features!","echo-knowledge-base")),a("p",null,s("Let's get you set up with AI-powered chat and search in just a few steps.","echo-knowledge-base"))),a("div",{className:"epkb-ai-setup-steps-welcome"},a("div",{className:"epkb-ai-setup-step-welcome"},a("span",{className:"epkb-ai-step-icon epkbfa epkbfa-key"}),a("h3",null,s("Step 1: Configure API Key & Privacy","echo-knowledge-base")),a("p",null,s("Add your OpenAI API key and accept the data privacy agreement.","echo-knowledge-base")),a("button",{className:"epkb-ai-button epkb-ai-button-primary",onClick:()=>{if(c){c("general-settings")}}},s("Go to Settings","echo-knowledge-base"))),a("div",{className:"epkb-ai-setup-step-welcome"},a("span",{className:"epkb-ai-step-icon epkbfa epkbfa-rocket"}),a("h3",null,s("Step 2: Enable AI Chat and/or AI Search","echo-knowledge-base")),a("p",null,s("Enable AI Search or Chat features for your website.","echo-knowledge-base"))),a("div",{className:"epkb-ai-setup-step-welcome"},a("span",{className:"epkb-ai-step-icon epkbfa epkbfa-database"}),a("h3",null,s("Step 3: Add Training Data & Sync","echo-knowledge-base")),a("p",null,s("Select content and sync it to OpenAI for AI processing.","echo-knowledge-base")))));const h=e=>a("div",{className:"epkb-ai-setup-needed"},a("div",{className:"epkb-ai-setup-header"},a("h3",null,s("Complete Your Setup","echo-knowledge-base")),a("p",null,s("Just a few more steps to enable AI features:","echo-knowledge-base"))),a("div",{className:"epkb-ai-setup-steps-list"},e.map(((e,t)=>a("div",{key:t,className:"epkb-ai-setup-item"},a("div",{className:"epkb-ai-setup-item-content"},a("span",{className:"epkb-ai-step-number"},t+1),a("div",null,a("p",{className:"epkb-ai-setup-message"},e.message),e.link&&a("a",{href:e.link,className:"epkb-ai-button epkb-ai-button-small epkb-ai-button-primary"},e.action))))))));const f=()=>{const e=i?.dashboard_stats||{};return a("div",{className:"epkb-ai-stats-grid"},Object.values(e).map(((e,t)=>a("div",{key:t,className:"epkb-ai-stat-box"+(e.is_coming_soon?" epkb-ai-stat-box-coming-soon":""),style:{borderTopColor:e.color}},a("div",{className:"epkb-ai-stat-header"},a("div",{className:"epkb-ai-stat-icon",style:{backgroundColor:e.color+"15"}},a("span",{className:e.icon,style:{color:e.color}})),a("h3",null,e.title)),a("div",{className:"epkb-ai-stat-content"},e.is_coming_soon?a("div",{className:"epkb-ai-coming-soon"},a("span",{className:"epkb-ai-coming-soon-badge"},e.value),a("p",{className:"epkb-ai-stat-description"},e.description)):a("div",null,a("p",{className:"epkb-ai-stat-description"},e.description),(e.show_as_main||e.total!==undefined)&&a("div",{className:"epkb-ai-stat-numbers"},a("span",{className:"epkb-ai-stat-number"},e.value||"0"))),e.bottom_text&&a("div",{className:"epkb-ai-stat-bottom"},a("span",null,e.bottom_text)))))))};const v=()=>{if(!d){return null}const e=r?.checks?.api_key?.status==="success";const n=r?.checks?.disclaimer?.status==="success";const o=t?.ai_search_enabled&&t.ai_search_enabled!=="off";const l=t?.ai_chat_enabled&&t.ai_chat_enabled!=="off";const p=o||l;const b=i?.dashboard_stats?.training_data?.synced>0;const u=!d;const k=e&&n;const m=p;const g=b;return a("div",{className:"epkb-ai-setup-guide"},a("h3",null,s("Setup Steps","echo-knowledge-base")),a("div",{className:"epkb-ai-setup-steps"},a("div",{className:"epkb-ai-setup-step"},a("span",{className:"epkb-ai-step-number"+(k?" epkb-ai-step-completed":"")},k?"":"1"),a("h4",null,s("Configure API Key & Privacy","echo-knowledge-base")),a("p",null,s("Add your OpenAI API key and accept the data privacy agreement","echo-knowledge-base")),!k&&a("button",{className:"epkb-ai-button epkb-ai-button-small",onClick:()=>{if(c){c("general-settings")}}},s("Go to Settings","echo-knowledge-base"))),a("div",{className:"epkb-ai-setup-step"},a("span",{className:"epkb-ai-step-number"+(m?" epkb-ai-step-completed":"")},m?"":"2"),a("h4",null,s("Enable AI Chat and/or AI Search","echo-knowledge-base")),a("p",null,s("Enable AI Search or Chat features for your website","echo-knowledge-base")),!m&&k&&a("button",{className:"epkb-ai-button epkb-ai-button-small",onClick:()=>{if(c){c("search")}}},s("Enable AI Features","echo-knowledge-base"))),a("div",{className:"epkb-ai-setup-step"},a("span",{className:"epkb-ai-step-number"+(g?" epkb-ai-step-completed":"")},g?"":"3"),a("h4",null,s("Add Training Data & Sync","echo-knowledge-base")),a("p",null,s("Select content and sync it to OpenAI for AI processing","echo-knowledge-base")),!g&&m&&a("button",{className:"epkb-ai-button epkb-ai-button-small",onClick:()=>{if(c){c("training-data")}}},s("Go to Training Data","echo-knowledge-base")))))};const w=(e,t,a)=>new Promise((n=>{const o=e?.first_name||"";const i=e?.email||"";const l=e?.site_url||window.location.origin;const c=e=>{const t=document.createElement("div");t.textContent=e;return t.innerHTML};const r=document.createElement("div");r.className="epkb-ai-vote-dialog-overlay";r.style.cssText=`\n\t\t\t\t\tposition: fixed;\n\t\t\t\t\ttop: 0;\n\t\t\t\t\tleft: 0;\n\t\t\t\t\tright: 0;\n\t\t\t\t\tbottom: 0;\n\t\t\t\t\tbackground: rgba(0, 0, 0, 0.5);\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tz-index: 9999999;\n\t\t\t\t`;const d=document.createElement("div");d.className="epkb-ai-vote-dialog";d.style.cssText=`\n\t\t\t\t\tbackground: white;\n\t\t\t\t\tborder-radius: 8px;\n\t\t\t\t\tpadding: 24px;\n\t\t\t\t\tmax-width: 500px;\n\t\t\t\t\twidth: 90%;\n\t\t\t\t\tbox-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n\t\t\t\t\tposition: relative;\n\t\t\t\t\tz-index: 9999999;\n\t\t\t\t`;const p=`\n\t\t\t\t\t<h3 style="margin: 0 0 16px 0; font-size: 18px; font-weight: 600;">\n\t\t\t\t\t\t${s("Vote for Top 3 Features","echo-knowledge-base")}\n\t\t\t\t\t</h3>\n\t\t\t\t\t<p style="margin: 0 0 20px 0; color: #555; line-height: 1.5;">\n\t\t\t\t\t\t${s("Help us prioritize features by providing your information:","echo-knowledge-base")}\n\t\t\t\t\t</p>\n\t\t\t\t\t<form id="epkb-vote-form" style="display: flex; flex-direction: column; gap: 15px;">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label style="display: block; margin-bottom: 5px; font-weight: 500;">\n\t\t\t\t\t\t\t\t${s("First Name","echo-knowledge-base")} <span style="color: #999; font-weight: bold; font-size: 0.9em;">${s("(optional)","echo-knowledge-base")}</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<input type="text" \n\t\t\t\t\t\t\t\t   id="epkb-vote-first-name" \n\t\t\t\t\t\t\t\t   value="${c(o)}"\n\t\t\t\t\t\t\t\t   style="width: 100%; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label style="display: block; margin-bottom: 5px; font-weight: 500;">\n\t\t\t\t\t\t\t\t${s("Email","echo-knowledge-base")} <span style="color: #999; font-weight: bold; font-size: 0.9em;">${s("(optional)","echo-knowledge-base")}</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<input type="email" \n\t\t\t\t\t\t\t\t   id="epkb-vote-email" \n\t\t\t\t\t\t\t\t   value="${c(i)}"\n\t\t\t\t\t\t\t\t   style="width: 100%; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${t.includes("other-feature")?`\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label style="display: block; margin-bottom: 5px; font-weight: 500;">\n\t\t\t\t\t\t\t\t${s("Describe Your Feature Request","echo-knowledge-base")} <span style="color: red;">*</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\tid="epkb-vote-other-feature-text"\n\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\tplaceholder="${s("Please describe the feature you would like to see...","echo-knowledge-base")}"\n\t\t\t\t\t\t\t\tstyle="width: 100%; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; min-height: 80px; resize: vertical;">${c(a)}</textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`:""}\n\t\t\t\t\t\t<div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 10px;">\n\t\t\t\t\t\t\t<button type="button" class="epkb-ai-button epkb-ai-button-secondary" id="epkb-vote-cancel">\n\t\t\t\t\t\t\t\t${s("Cancel","echo-knowledge-base")}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type="submit" class="epkb-ai-button epkb-ai-button-primary" id="epkb-vote-submit">\n\t\t\t\t\t\t\t\t${s("Submit Vote","echo-knowledge-base")}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t`;d.innerHTML=p;r.appendChild(d);document.body.appendChild(r);const b=d.querySelector("#epkb-vote-form");const u=d.querySelector("#epkb-vote-cancel");const k=d.querySelector("#epkb-vote-first-name");const m=d.querySelector("#epkb-vote-email");if(k){k.focus()}const g=e=>{e.preventDefault();const t={first_name:k.value.trim(),email:m.value.trim(),site_url:l};const a=d.querySelector("#epkb-vote-other-feature-text");if(a){t.other_feature_text=a.value.trim();if(!t.other_feature_text){alert(s("Please describe the feature you would like to see.","echo-knowledge-base"));a.focus();return}}if(t.email){const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!e.test(t.email)){alert(s("Please enter a valid email address.","echo-knowledge-base"));m.focus();return}}f();n(t)};const h=()=>{f();n(null)};const f=()=>{document.body.removeChild(r)};b.addEventListener("submit",g);u.addEventListener("click",h);r.addEventListener("click",(e=>{if(e.target===r){h()}}));document.addEventListener("keydown",(function e(t){if(t.key==="Escape"){document.removeEventListener("keydown",e);h()}}))}));const y=async()=>{if(p.length===0){n(s("Please select at least one feature to vote for.","echo-knowledge-base"));return}const e=i?.current_user||{};const t=await w(e,p,u);if(!t){return}const a={...t,features:p,action:"epkb_vote_for_features",_wpnonce_epkb_ajax_action:epkb_vars.nonce};if(t.other_feature_text){a.other_feature_text=t.other_feature_text}const l=document.createElement("div");l.className="epkb-ai-loading-overlay";l.style.cssText=`\n\t\t\t\tposition: fixed;\n\t\t\t\ttop: 0;\n\t\t\t\tleft: 0;\n\t\t\t\tright: 0;\n\t\t\t\tbottom: 0;\n\t\t\t\tbackground: rgba(0, 0, 0, 0.5);\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tjustify-content: center;\n\t\t\t\tz-index: 9999999;\n\t\t\t`;l.innerHTML=`\n\t\t\t\t<div style="background: white; padding: 20px; border-radius: 8px;">\n\t\t\t\t\t${s("Submitting your vote...","echo-knowledge-base")}\n\t\t\t\t</div>\n\t\t\t`;document.body.appendChild(l);jQuery.ajax({type:"POST",dataType:"json",url:epkb_vars.ajax_url,data:a,success:function(e){document.body.removeChild(l);if(e.success){const t=e.data&&e.data.message?e.data.message:s("Thank you for voting!","echo-knowledge-base");o(t);b([])}else{const t=e.data&&e.data.message?e.data.message:s("Failed to submit vote. Please try again.","echo-knowledge-base");n(t)}},error:function(e,t,a){document.body.removeChild(l);n(s("An error occurred. Please try again.","echo-knowledge-base")+" ["+a+"]");console.error("Vote submission error:",a)}})};const N=()=>{const e=i?.news||[];if(e.length===0){return null}return a("div",{className:"epkb-ai-news-section"},a("h3",null,s("Latest AI Updates","echo-knowledge-base")),a("div",{className:"epkb-ai-news-items"},e.map(((e,t)=>a("div",{key:t,className:`epkb-ai-news-item epkb-ai-news-${e.type}`},a("div",{className:"epkb-ai-news-header"},a("span",{className:"epkb-ai-news-date"},e.date),a("span",{className:`epkb-ai-news-badge epkb-ai-news-badge-${e.type}`},e.type)),a("h4",null,e.title),a("p",null,e.description),e.link&&a("a",{href:e.link,target:"_blank",className:"epkb-ai-news-link"},s("Learn more","echo-knowledge-base")," â†’"))))))};const x=()=>{const e=i?.upcoming_features||[];if(e.length===0){return null}const t=e=>{b((t=>{if(t.includes(e)){if(e==="other-feature"){k("")}return t.filter((t=>t!==e))}else{return[...t,e]}}))};return a("div",{className:"epkb-ai-upcoming-features"},a("h3",null,s("Vote for Top 3 Features","echo-knowledge-base")+"!"),a("p",{style:{marginBottom:"20px",color:"#666"}},s("Select the features you would like to see implemented:","echo-knowledge-base")),a("div",{className:"epkb-ai-features-grid"},e.map(((e,n)=>a("div",{key:n,className:"epkb-ai-feature-card"+(p.includes(e.id)?" epkb-ai-feature-selected":"")+(e.released?" epkb-ai-feature-released":""),style:{cursor:e.released?"default":"pointer",position:"relative"}},a("div",{className:"epkb-ai-feature-header",onClick:e.released?undefined:()=>t(e.id)},a("span",{className:`epkb-ai-feature-icon ${e.icon}`}),a("div",{className:"epkb-ai-feature-content"},a("div",{className:"epkb-ai-feature-title-row"},a("h4",null,e.title)),a("p",null,e.description)),e.released?a("span",{className:"epkb-ai-feature-released-badge",style:{padding:"6px 12px",background:"#10B981",color:"white",borderRadius:"4px",fontWeight:"600",fontSize:"14px"}},s("Released","echo-knowledge-base")):a("input",{type:"checkbox",id:`feature-${e.id}`,checked:p.includes(e.id),onChange:()=>t(e.id),onClick:e=>e.stopPropagation()})))))),a("div",{className:"epkb-ai-vote-button-container",style:{marginTop:"30px",textAlign:"center",padding:"20px",background:"#f8f9fa",borderRadius:"8px"}},a("button",{className:"epkb-ai-button epkb-ai-button-primary epkb-ai-button-large",onClick:y,disabled:p.length===0,style:{padding:"12px 30px",fontSize:"16px",opacity:p.length===0?"0.5":"1",cursor:p.length===0?"not-allowed":"pointer"}},a("span",{className:"epkbfa epkbfa-thumbs-up",style:{marginRight:"8px"}}),s("Vote for Top 3 Features","echo-knowledge-base")),p.length>0&&a("p",{style:{marginTop:"10px",color:"#666",fontSize:"14px"}},`${p.length} ${p.length===1?s("feature selected","echo-knowledge-base"):s("features selected","echo-knowledge-base")}`)),a("div",{className:"epkb-ai-upcoming-features-disclaimer"},a("p",null,s("Note: Your feedback helps us prioritize development. Features are subject to change.","echo-knowledge-base"))))};const _=()=>{const e=i?.quick_links||{};const t=e.steps||[];if(t.length===0){return null}return a("div",{className:"epkb-ai-quick-links"},a("h3",null,s("Setup Steps","echo-knowledge-base")),a("div",{className:"epkb-ai-links-grid"},t.map(((e,t)=>{let n="epkb-ai-quick-link";if(e.completed){n+=" epkb-ai-quick-link-completed"}if(e.disabled){n+=" epkb-ai-quick-link-disabled"}return a(e.disabled?"div":"a",{key:t,href:e.disabled?undefined:e.link,target:e.external?"_blank":"_self",className:n},a("span",{className:e.icon+(e.completed?" epkb-ai-step-completed":"")}),a("div",null,a("h4",null,e.title),a("p",null,e.description),e.completed&&a("span",{className:"epkb-ai-step-badge"},s("Completed","echo-knowledge-base"))))}))))};const S=()=>{const e=i?.tools_link;if(!e){return null}return a("div",{className:"epkb-ai-tools-link-section",style:{marginTop:"30px"}},a("a",{href:e.link,className:"epkb-ai-tools-link"},a("span",{className:e.icon}),a("div",null,a("h4",null,e.title),a("p",null,e.description))))};const A=i?.quick_links||{};const C=A.all_completed===true;return a("div",{className:"epkb-ai-dashboard-container epkb-ai-dashboard-beta"},v(),m(),f(),a("div",{className:"epkb-ai-dashboard-columns"},a("div",{className:"epkb-ai-dashboard-main"},x()),a("div",{className:"epkb-ai-dashboard-sidebar"},!C&&_(),N(),C&&_(),S())))};window.EPKB_AI_Dashboard={AIAdminDashboard:l}})();