!function(n){"use strict";redux.field_objects=redux.field_objects||{},redux.field_objects.gallery=redux.field_objects.gallery||{},redux.field_objects.gallery.init=function(e){e=n.redux.getSelector(e,"gallery"),n(e).each(function(){var e=n(this),i=e;(i=e.hasClass("redux-field-container")?i:e.parents(".redux-field-container:first")).is(":hidden")||i.hasClass("redux-field-init")&&(i.removeClass("redux-field-init"),e.on({click:function(e){var l,a,i,t,d;if(wp.media.view.Settings.Gallery=wp.media.view.Settings.Gallery.extend({template:function(){}}),l=n(this).closest("fieldset"),"clear-gallery"===e.currentTarget.id)l.find(".gallery_values").val(""),l.find(".screenshot").html("");else if("undefined"!=typeof wp&&wp.media&&wp.media.gallery)return e.preventDefault(),i=(e=l.find(".gallery_values").val())?'[gallery ids="'+e+'"]':'[gallery ids="0"]',a=wp.media.gallery.edit(i),e||(i=n("body").find("#"+a.el.id),d=i.find(".uploader-inline"),t=i.find(".media-toolbar .spinner"),setTimeout(function(){d.hasClass("hidden")&&(d.removeClass("hidden"),t.removeClass("is-active"))},400)),a.state("gallery-edit").on("update",function(e){var i;l.find(".screenshot").html(""),e=e.models.map(function(e){return i=e.toJSON(),i=(void 0!==i.sizes&&void 0!==i.sizes.thumbnail?i.sizes.thumbnail:i).url,i='<a class="of-uploaded-image" href="'+i+'"><img class="redux-option-image" src="'+i+'" alt="" /></a>',l.find(".screenshot").append(i),e.id}),l.find(".gallery_values").val(e.join(",")),redux_change(l.find(".gallery_values")),a.detach()}),!1}},".gallery-attachments"))})}}(jQuery);