!function(P){"use strict";var D=[],W=!1,M=!0;redux.field_objects=redux.field_objects||{},redux.field_objects.typography=redux.field_objects.typography||{},redux.field_objects.typography.init=function(e){e=P.redux.getSelector(e,"typography"),P(e).each(function(){var e=P(this),t=e;(t=e.hasClass("redux-field-container")?t:e.parents(".redux-field-container:first")).is(":hidden")||(void 0===redux.field_objects.pro&&(M=!1),e.each(function(){P(this).find(".redux-typography-container").each(function(){var e,t,a,r=P(this),o=r,s=P(this).find(".redux-typography-family"),i=s.data("value"),d=P(this).find(".redux-typography-family").parents(".redux-container-typography:first").data("id"),p=P("#"+d+" .redux-typography-google").val(),n=[],y=[],l=P("#"+d+" .redux-typography-font-family").data("user-fonts");if(!(o=r.hasClass("redux-field-container")?o:r.parents(".redux-field-container:first")).is(":hidden")&&o.hasClass("redux-field-init")){if(o.removeClass("redux-field-init"),void 0===i?s=P(this):""!==i&&P(s).val(i),l=l?1:0,p=p?1:0,void 0!==redux.customfonts&&n.push(redux.customfonts),void 0!==redux.typekitfonts&&n.push(redux.typekitfonts),void 0!==redux.stdfonts&&0==l&&n.push(redux.stdfonts),1==l){for(e in redux.optName.typography[d])if(redux.optName.typography[d].hasOwnProperty(e))for(a in t=redux.optName.typography[d].std_font)t.hasOwnProperty(a)&&y.push({id:a,text:a,"data-google":"false"});n.push({text:"Standard Fonts",children:y})}(1==p||!0===p&&void 0!==redux.googlefonts)&&n.push(redux.googlefonts),i=n,l=P(this).find(".redux-typography-family").data("value"),P(this).find(".redux-typography-family").addClass("ignore-change"),P(this).find(".redux-typography-family").select2({data:i}),P(this).find(".redux-typography-family").val(l).trigger("change"),P(this).find(".redux-typography-family").removeClass("ignore-change"),r.find(".redux-typography-family").hasClass("redux-typography-family")||r.find(".redux-typography-style").select2(),P(this).find(".redux-typography-align").select2(),P(this).find(".redux-typography-family-backup").select2(),P(this).find(".redux-typography-transform").select2(),P(this).find(".redux-typography-font-variant").select2(),P(this).find(".redux-typography-decoration").select2(),P(this).find(".redux-insights-data-we-collect-typography").on("click",function(e){e.preventDefault(),P(this).parent().find(".description").toggle()}),redux.field_objects.typography.select(s,!0,!1,null,!0),P(this).find(".redux-typography-family, .redux-typography-family-backup, .redux-typography-style, .redux-typography-subsets, .redux-typography-align").on("change",function(e){var t,a,r=P(this).attr("id"),r=P("#"+r);P(this).hasClass("redux-typography-family")?r.val()&&(a=(t=P(this).select2("data"))?t[0].text:null,r.data("value",a),D=t[0],W=!0,redux.field_objects.typography.select(r,!0,!1,a,!0)):(e=r.val(),r.data("value",e),(P(this).hasClass("redux-typography-align")||P(this).hasClass("redux-typography-subsets")||P(this).hasClass("redux-typography-family-backup")||P(this).hasClass("redux-typography-transform")||P(this).hasClass("redux-typography-font-variant")||P(this).hasClass("redux-typography-decoration"))&&(r.find('option[selected="selected"]').attr("selected",!1),r.find('option[value="'+e+'"]').attr("selected","selected")),P(this).hasClass("redux-typography-subsets")&&r.siblings(".typography-subsets").val(e),redux.field_objects.typography.select(P(this),!0,!1,null,!1))}),P(this).find(".redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter, .redux-typography-margin-top, .redux-typography-margin-bottom").on("keyup",function(){redux.field_objects.typography.select(P(this).parents(".redux-container-typography:first"))}),P(this).find(".redux-typography-color, .redux-typography-shadow-color").wpColorPicker({change:function(e,t){P(this).val(t.color.toString()),redux.field_objects.typography.select(P(this).parents(".redux-container-typography:first"))}}),P(this).find(".redux-typography-size").numeric({allowMinus:!1}),P(this).find(".redux-typography-height, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:!0}),P(this).find(".redux-typography").on("select2:unselecting",function(){var e,t,a=P(this).data("select2").options;a.set("disabled",!0),setTimeout(function(){a.set("disabled",!1)},1),e=P(this).attr("id"),(t=P("#"+e)).data("value",""),P(this).hasClass("redux-typography-family")?(P(this).find(".redux-typography-family").addClass("ignore-change"),P(this).val(null).trigger("change"),P(this).find(".redux-typography-family").removeClass("ignore-change"),redux.field_objects.typography.select(t,!0,!1,null,!0)):((P(this).hasClass("redux-typography-align")||P(this).hasClass("redux-typography-subsets")||P(this).hasClass("redux-typography-family-backup")||P(this).hasClass("redux-typography-transform")||P(this).hasClass("redux-typography-font-variant")||P(this).hasClass("redux-typography-decoration"))&&P("#"+e+' option[selected="selected"]').removeAttr("selected"),P(this).hasClass("redux-typography-subsets")&&t.siblings(".typography-subsets").val(""),P(this).hasClass("redux-typography-family-backup")&&(P(this).find(".redux-typography-family-backup").addClass("ignore-change"),t.val(null).trigger("change"),P(this).find(".redux-typography-family-backup").removeClass("ignore-change")),redux.field_objects.typography.select(P(this),!0,!1,null,!1))}),redux.field_objects.typography.updates(P(this)),window.onbeforeunload=null,o.removeClass("redux-field-init"),M||redux.field_objects.typography.sliderInit(r)}})}))})},redux.field_objects.typography.sliderInit=function(p){p.find(".redux-typography-slider").each(function(){var e=P(this).data("id"),t=P(this).data("min"),a=P(this).data("max"),r=P(this).data("step"),o=P(this).data("default"),s=P(this).data("label"),i=Boolean(P(this).data("rtl")),t=[t,a],d=P(this).reduxNoUiSlider({range:t,start:o,handles:1,step:r,connect:"lower",behaviour:"tap-drag",rtl:i,serialization:{resolution:1},slide:function(){P(this).next("#redux-slider-value-"+e).attr("value",d.val()),P(this).prev("label").html(s+":  <strong>"+d.val()+"px</strong>"),redux.field_objects.typography.select(p)}})})},redux.field_objects.typography.updates=function(o){o.find(".update-google-fonts").on("click",function(e){var t=P(this).data("action"),a=P(this).parent().parent(),r=a.attr("data-nonce");return a.find("p").text(redux_typography_ajax.update_google_fonts.updating),a.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.updating),a.removeClass("updating-message updated-message notice-success notice-warning notice-error").addClass("update-message notice-warning updating-message"),P.ajax({type:"post",dataType:"json",url:redux_typography_ajax.ajaxurl,data:{action:"redux_update_google_fonts",nonce:r,data:t},error:function(e){console.log(e),a.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),e=(e=e.error)&&': "'+e+'"',a.find("p").html(redux_typography_ajax.update_google_fonts.error.replace("%s",t).replace("|msg",e)),a.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.error),redux.field_objects.typography.updates(o)},success:function(e){console.log(e),"success"===e.status?(a.find("p").html(redux_typography_ajax.update_google_fonts.success),a.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.success),a.removeClass("updating-message notice-warning").addClass("updated-message notice-success"),P(".redux-update-google-fonts").not(".notice-success").remove()):(a.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),e=(e=e.error)&&': "'+e+'"',a.find("p").html(redux_typography_ajax.update_google_fonts.error.replace("%s",t).replace("|msg",e)),a.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.error),redux.field_objects.typography.updates(o))}}),e.preventDefault(),!1})},redux.field_objects.typography.size=function(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&(a+=1);return a},redux.field_objects.typography.makeBool=function(e){return"false"!==e&&"0"!==e&&!1!==e&&0!==e&&("true"===e||"1"===e||!0===e||1===e||void 0)},redux.field_objects.typography.contrastColour=function(e){var t="#444444";return""!==e&&(e=e.replace("#",""),t=128<=(299*parseInt(e.substring(0,2),16)+587*parseInt(e.substring(2,2),16)+114*parseInt(e.substring(4,2),16))/1e3?"#444444":"#ffffff"),t},redux.field_objects.typography.hexToInt=function(e){return 0===e.indexOf("#")&&(e=e.slice(1)),parseInt(e,16)},redux.field_objects.typography.select=function(e,t,a,r,o){var s,i,d,p,n,y,l,h,g,u,f,c,x,v,m,b,_,w,C,j,k,z,I,O,S=!1,T="",B='<option value=""></option>',N="",F=P(e).parents(".redux-container-typography:first").data("id");void 0===F&&(F=P(e).data("id")),s=P("#"+F),i=(i=P("#"+F+"-family").val())||null,r&&(i=r),r=s.find("select.redux-typography-family-backup").val(),p=s.find(".redux-typography-size").val(),n=s.find(".redux-typography-height").val(),y=s.find(".redux-typography-word").val(),l=s.find(".redux-typography-letter").val(),h=s.find("select.redux-typography-align").val(),g=s.find("select.redux-typography-transform").val(),u=s.find("select.redux-typography-font-variant").val(),f=s.find("select.redux-typography-decoration").val(),c=s.find("select.redux-typography-style").val(),x=s.find("select.redux-typography-subsets").val(),v=s.find(".redux-typography-color").val(),z=s.find(".redux-typography-margin-top").val(),I=s.find(".redux-typography-margin-bottom").val(),k=s.find(".typography-style"),j=s.data("units"),void 0===y&&(y="0"),void 0===l&&(l="0"),0<k.length&&(O=JSON.parse(decodeURIComponent(k.data("weights")))),!0===W?(d=redux.field_objects.typography.makeBool(D["data-google"]),s.find(".redux-typography-google-font").val(d)):d=redux.field_objects.typography.makeBool(s.find(".redux-typography-google-font").val()),o&&(s.hasClass("typography-initialized")||(c=s.find("select.redux-typography-style").data("value"),x=s.find("select.redux-typography-subsets").data("value"),""!==c&&(c=String(c)),x=String(x)),void 0===redux.fonts.google&&(d=!1),T=!0===d&&i in redux.fonts.google?redux.fonts.google[i]:void 0!==redux.fonts.typekit&&i in redux.fonts.typekit?(S=!0,redux.fonts.typekit[i]):O,P(e).hasClass("redux-typography-subsets")&&s.find("input.typography-subsets").val(x),P(e).hasClass("redux-typography-family")?(!0===d?(P.each(T.variants,function(e,t){t.id===c||1===redux.field_objects.typography.size(T.variants)?(N=' selected="selected"',c=t.id):N="",B+='<option value="'+t.id+'"'+N+">"+t.name.replace(/\+/g," ")+"</option>"}),a&&s.find(".redux-typography-style").select2("destroy"),s.find(".redux-typography-style").html(B).select2(),N="",B='<option value=""></option>',P.each(T.subsets,function(e,t){x===t.id||1===redux.field_objects.typography.size(T.subsets)?(N=' selected="selected"',x=t.id,s.find("input.typography-subsets").val(x)):N="",B+='<option value="'+t.id+'"'+N+">"+t.name.replace(/\+/g," ")+"</option>"}),a&&s.find(".redux-typography-subsets").select2("destroy"),s.find(".redux-typography-subsets").html(B).select2({width:"100%"}),s.find(".redux-typography-subsets").parent().fadeIn("fast"),s.find(".typography-family-backup").fadeIn("fast")):!0===S?(P.each(T.variants,function(e,t){c===t.id||1===redux.field_objects.typography.size(T.variants)?(N=' selected="selected"',c=t.id):N="",B+='<option value="'+t.id+'"'+N+">"+t.name.replace(/\+/g," ")+"</option>"}),s.find(".redux-typography-style").select2("destroy"),s.find(".redux-typography-style").html(B).select2(),s.find(".redux-typography-subsets").parent().fadeOut("fast"),s.find(".typography-family-backup").fadeOut("fast")):s.find(".redux-typography-style")&&(P.each(O,function(e,t){c===e||"normal"===e?(N=' selected="selected"',s.find(".typography-style select2-selection__rendered").text(t)):N="",B+='<option value="'+e+'"'+N+">"+t.replace("+"," ")+"</option>"}),a&&s.find(".redux-typography-style").select2("destroy"),s.find(".redux-typography-style").html(B).select2()),s.find(".redux-typography-font-family").val(i)):P(e).hasClass("redux-typography-family-backup")&&""!==r?s.find(".redux-typography-font-family-backup").val(r):(T=O)&&(P.each(T,function(e,t){c===e||"normal"===e?(N=' selected="selected"',s.find(".typography-style select2-selection__rendered").text(t)):N="",B+='<option value="'+e+'"'+N+">"+t.replace("+"," ")+"</option>"}),a&&s.find(".redux-typography-style").select2("destroy"),s.find(".redux-typography-style").html(B).select2(),s.find(".redux-typography-subsets").parent().fadeOut("fast"),s.find(".typography-family-backup").fadeOut("fast"))),o&&(s.find(".redux-typography-style").addClass("ignore-change"),0===s.find("select.redux-typography-style option[value='"+c+"']").length?(c="",s.find("select.redux-typography-style").val("").trigger("change")):"400"===c&&s.find("select.redux-typography-style").val(c).trigger("change"),s.find(".redux-typography-style").removeClass("ignore-change"),0===s.find("select.redux-typography-subsets option[value='"+x+"']").length)&&(x="",s.find(".redux-typography-style").addClass("ignore-change"),s.find("select.redux-typography-subsets").val("").trigger("change"),s.find("input.typography-subsets").val(x),s.find(".redux-typography-style").removeClass("ignore-change")),P("."+("style_link_"+F)).remove(),null!==i&&"inherit"!==i&&s.hasClass("typography-initialized")&&(k=i.replace(/\s+/g,"+"),!0===d?(S=k,c&&""!==c&&(S+=":"+c.replace(/\-/g," ")),x&&""!==x&&(S+="&subset="+x),!1===W&&"undefined"!=typeof WebFont&&WebFont&&WebFont.load({google:{families:[S]}}),s.find(".redux-typography-google").val(!0)):s.find(".redux-typography-google").val(!1)),c&&-1!==c.indexOf("italic")?(s.find(".typography-preview").css("font-style","italic"),s.find(".typography-font-style").val("italic"),c=c.replace("italic","")):(s.find(".typography-preview").css("font-style","normal"),s.find(".typography-font-style").val("")),s.find(".typography-font-weight").val(c),Boolean(s.find(".redux-typography-height").data("allow-empty"))||(n=n||p),""===p||void 0===p?s.find(".typography-font-size").val(""):(r=s.find(".redux-typography-size").data("unit"),s.find(".typography-font-size").val(p+r)),""===n||void 0===n?s.find(".typography-line-height").val(""):(_=s.find(".redux-typography-height").data("unit"),s.find(".typography-line-height").val(n+_)),""===y||void 0===y?s.find(".typography-word-spacing").val(""):(w=s.find(".redux-typography-word").data("unit"),s.find(".typography-word-spacing").val(y+w)),""===l||void 0===l?s.find(".typography-letter-spacing").val(""):(C=s.find(".redux-typography-letter").data("unit"),s.find(".typography-letter-spacing").val(l+C)),""===z||void 0===z?s.find(".typography-margin-top").val(""):(m=s.find(".redux-typography-margin-top").data("unit"),s.find(".typography-margin-top").val(z+m)),""===I||void 0===I?s.find(".typography-margin-bottom").val(""):(b=s.find(".redux-typography-margin-bottom").data("unit"),s.find(".typography-margin-bottom").val(I+b)),s.hasClass("typography-initialized")&&(0===s.find(".typography-preview").data("preview-size")&&s.find(".typography-preview").css("font-size",p+j),s.find(".typography-preview").css({"font-weight":c,"text-align":h,"font-family":i+", sans-serif","padding-top":z+m,"padding-bottom":I+b}),"none"===i&&""===i&&s.find(".typography-preview").css("font-family","inherit"),n&&s.find(".typography-preview").css("line-height",n+_),y&&s.find(".typography-preview").css("word-spacing",y+w),l&&s.find(".typography-preview").css("letter-spacing",l+C),v&&(s.find(".typography-preview").css("color",v),O=redux.field_objects.typography.hexToInt(v),a=redux.field_objects.typography.hexToInt("ffffff"),redux.field_objects.typography.hexToInt("dddddd")<=O&&O<=a?s.find(".typography-preview").css("background-color","black"):s.find(".typography-preview").css("background-color","")),M||redux.field_objects.typography.previewShadow(F),s.find(".typography-style select2-selection__rendered").text(s.find(".redux-typography-style option:selected").text()),s.find(".typography-script select2-selection__rendered").text(s.find(".redux-typography-subsets option:selected").text()),h&&s.find(".typography-preview").css("text-align",h),g&&s.find(".typography-preview").css("text-transform",g),u&&s.find(".typography-preview").css("font-variant",u),f&&s.find(".typography-preview").css("text-decoration",f),s.find(".typography-preview").slideDown()),s.hasClass("typography-initialized")||s.addClass("typography-initialized"),W=!1,t||redux_change(e)},redux.field_objects.typography.previewShadow=function(e){var t=P("#"+e+" .redux-typography-shadow-color").val(),a=P("#redux-slider-value-"+e+"-h").val(),r=P("#redux-slider-value-"+e+"-v").val(),o=P("#redux-slider-value-"+e+"-b").val();t&&P("#"+e+" .typography-preview").css("text-shadow",a+"px "+r+"px "+o+"px "+t)}}(jQuery);