!function(k){"use strict";redux.field_objects=redux.field_objects||{},redux.field_objects.color_scheme=redux.field_objects.color_scheme||{},redux.field_objects.color_scheme.nonce="",redux.field_objects.color_scheme.fieldID="",redux.field_objects.color_scheme.optName="",redux.field_objects.color_scheme.el="",redux.field_objects.color_scheme.showTooltips="",redux.field_objects.color_scheme.default_params={},redux.field_objects.color_scheme.hexToRGBA=function(e,c){let o;return o=null===e?"":(e=e.replace("#",""),"rgba("+parseInt(e.substring(0,2),16)+","+parseInt(e.substring(2,4),16)+","+parseInt(e.substring(4,6),16)+","+c+")")},redux.field_objects.color_scheme.init=function(e){e=e||k(document).find(".redux-group-tab:visible").find(".redux-container-color_scheme:visible"),k(e).each(function(){var e=k(this);let c=e;redux.field_objects.color_scheme.el=e,(c=e.hasClass("redux-field-container")?c:e.parents(".redux-field-container:first")).is(":hidden")||c.hasClass("redux-field-init")&&(c.removeClass("redux-field-init"),redux.field_objects.color_scheme.modInit(e),redux.field_objects.color_scheme.setAccordions(e),redux.field_objects.color_scheme.import(e),redux.field_objects.color_scheme.delete(e),redux.field_objects.color_scheme.save(e),redux.field_objects.color_scheme.qtip(e))})},redux.field_objects.color_scheme.qtip=function(e){let o,c,t,s,d,r,l,i,n=!1;!1===redux.field_objects.color_scheme.showTooltips&&(n=!0),""!==(o=e.find(".redux-color-scheme-container").data("tooltips"))&&(o=decodeURIComponent(o),o=JSON.parse(o),!(c="")===o.style.shadow&&(c="qtip-shadow"),!(t="")===o.style.rounded&&(t="qtip-rounded"),(s="")!==o.style.color&&(s="qtip-"+o.style.color),(d="")!==o.style.style&&(d="qtip-"+o.style.style),i=(i=c+","+s+","+t+","+d).replace(/,/g," "),r=o.position.my,l=o.position.at,r=k.redux.verifyPos(r.toLowerCase(),!0),l=k.redux.verifyPos(l.toLowerCase(),!1),k("li.redux-cs-qtip").each(function(){var e=k(this).attr("qtip-content"),c=k(this).attr("qtip-title");""===e&&""===c||(!0===n?k(this).qtip("destroy",!0):k(this).qtip({content:{text:e,title:c},show:{effect:function(){"slide"===o.effect.show_effect?k(this).slideDown(o.effect.show_duration):"fade"===o.effect.show_effect?k(this).fadeIn(o.effect.show_duration):k(this).show()},event:o.effect.show_event},hide:{effect:function(){"slide"===o.effect.hide_effect?k(this).slideUp(o.effect.hide_duration):"fade"===o.effect.hide_effect?k(this).fadeOut(o.effect.hide_duration):k(this).hide()},event:o.effect.hide_event},style:{classes:i},position:{my:r,at:l}}))}))},redux.field_objects.color_scheme.setAccordions=function(e){let c;var o=e.find("ul.redux-scheme-layout");const t=o.data("open-icon"),s=o.data("close-icon");!0===Boolean(e.find(".redux-color-scheme-container").data("accordion"))?(e.find(".redux-color-scheme-accordion-section").each(function(){!1===(c=Boolean(k(this).data("state")))?k(this).hide():(k(this).prev(".redux-color-scheme-accordion").find(".el").removeClass(t).addClass(s),redux.field_objects.color_scheme.initColorPicker(k(this)))}),e.find(".redux-color-scheme-accordion").on("click",function(e){e.preventDefault(),(e=k(this).next(".redux-color-scheme-accordion-section")).is(":visible")?(k(this).find(".el").removeClass(s).addClass(t),e.slideUp()):(k(this).find(".el").removeClass(t).addClass(s),redux.field_objects.color_scheme.initColorPicker(e),e.slideDown())})):redux.field_objects.color_scheme.initColorPicker(e)},redux.field_objects.color_scheme.modInit=function(c){var e;redux.field_objects.color_scheme.nonce=c.find(".redux-color-scheme-container").data("nonce"),redux.field_objects.color_scheme.fieldID=c.find(".redux-color-scheme-container").data("id"),redux.field_objects.color_scheme.optName=c.find(".redux-color-scheme-container").data("opt-name"),redux.field_objects.color_scheme.showTooltips=c.find(".redux-color-scheme-container").data("show-tooltips"),redux.field_objects.color_scheme.default_params={triggerChange:!0,allowClear:!1},0<(e=c.find(".redux-container-color_scheme").find(".select2_params")).length&&(e=e.val(),e=JSON.parse(e),redux.field_objects.color_scheme.default_params=k.extend({},redux.field_objects.color_scheme.default_params,e)),c.find(".redux-scheme-select").select2(redux.field_objects.color_scheme.default_params),c.find("select.redux-color-scheme-opt-select").select2(redux.field_objects.color_scheme.default_params),c.find("input.redux-scheme-input-"+redux.field_objects.color_scheme.fieldID).on("click",function(e){this.focus(),this.select(),e.preventDefault()}),c.find("input.redux-scheme-input-"+redux.field_objects.color_scheme.fieldID).val(c.find("#redux-scheme-select-"+redux.field_objects.color_scheme.fieldID).val()),c.find("#redux-scheme-select-"+redux.field_objects.color_scheme.fieldID).on("change",function(){redux.field_objects.color_scheme.selectChange(c)}),c.find("#redux-"+redux.field_objects.color_scheme.fieldID+"-tooltip-checkbox").on("change",function(){var e=k(this).is(":checked");k(this).val(e),redux.field_objects.color_scheme.showTooltips=e,redux.field_objects.color_scheme.qtip(c)})},redux.field_objects.color_scheme.import=function(o){const t=redux.field_objects.color_scheme.fieldID;o.find(".redux-import-scheme-button").on("click",function(){k("#redux-color-scheme-upload-file").trigger("click")}),document.getElementById("redux-color-scheme-upload-file").addEventListener("change",function(){var e=document.getElementById("redux-color-scheme-upload-file").files[0];if("application/json"===e.type){const c=new FileReader;c.readAsText(e),c.onload=function(){var e=c.result,e={action:"redux_color_schemes",nonce:redux.field_objects.color_scheme.nonce,opt_name:redux.field_objects.color_scheme.optName,type:"import",content:e};k.post(redux_ajax_script.ajaxurl,e,function(e){e=JSON.parse(e),console.log(e),o.find("#redux-"+t+"-scheme-message-notice h2").html(e.data),k.blockUI({message:o.find("#redux-"+t+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),k("#redux-"+t+"-scheme-ok").on("click",function(){return k.unblockUI(),!0===e.result&&(window.onbeforeunload="",location.reload()),!1})})},c.onerror=function(){console.log(c.error)}}})},redux.field_objects.color_scheme.delete=function(t){const s=redux.field_objects.color_scheme.fieldID;t.find("#redux-"+s+"-delete-scheme-button").on("click",function(e){let o;if(e.preventDefault(),"default"===(o=t.find("#redux-scheme-select-"+s).val()).toLowerCase())return t.find("#redux-"+s+"-scheme-message-notice h2").html("Cannot delete the <strong>Default</strong> scheme, as it is reserved."),k.blockUI({message:t.find("#redux-"+s+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),k("#redux-"+s+"-scheme-ok").on("click",function(){return k.unblockUI(),!1}),!1;k.blockUI({message:t.find("#redux-"+s+"-delete-scheme-question"),theme:!1,css:{width:"500px",padding:"5px"}}),k("#redux-"+s+"-delete-scheme-yes").on("click",function(){var e,c;o&&(e={action:"redux_color_schemes",nonce:redux.field_objects.color_scheme.nonce,opt_name:redux.field_objects.color_scheme.optName,type:"delete",scheme_id:o,field_id:s},c=t.find("#redux-"+s+"-scheme-wait-message h1").html(),k.blockUI({message:"<h1>"+c+"deleting scheme.<h1/>",theme:!1,css:{width:"500px",padding:"5px"}}),k.post(redux_ajax_script.ajaxurl,e,function(e){"success"===e?(t.find("#redux-scheme-select-"+s+" option[value='"+o+"']").remove(),t.find(".redux-scheme-select").select2(),t.find(".redux-scheme-select").val("Default").trigger("change"),t.find("input.redux-scheme-input-"+s).val(""),t.find("#redux-"+s+"-scheme-message-notice h2").html("The <strong>"+o+"</strong> scheme has been removed.<br/><br/>The color table has been reset to default values."),k.blockUI({message:t.find("#redux-"+s+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),k("#redux-"+s+"-scheme-ok").on("click",function(){return k.unblockUI(),redux.field_objects.color_scheme.updateSchemeHTML(0,t),!1})):(t.find("#redux-"+s+"-scheme-message-notice h2").html("Delete failed: "+e),k.blockUI({message:t.find("#redux-"+s+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),k("#redux-"+s+"-scheme-ok").on("click",function(){return k.unblockUI(),!1}))}))}),k("#redux-"+s+"-delete-scheme-no").on("click",function(){return k.unblockUI(),!1})})},redux.field_objects.color_scheme.save=function(s){const d=redux.field_objects.color_scheme.fieldID;s.find("#redux-"+d+"-save-scheme-button").on("click",function(e){let c,o;var t;let r=[];return e.preventDefault(),""!==(c=(c=(c=s.find("input.redux-scheme-input-"+d).val()).replace(/^\s+|\s+$/gm,"")).replace(/[^a-z0-9\s\-]/gi,""))&&("default"===c.toLowerCase()?(s.find("#redux-"+d+"-scheme-message-notice h2").html("The name <strong>Default</strong> cannot be used as it is reserved."),k.blockUI({message:s.find("#redux-"+d+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),k("#redux-"+d+"-scheme-ok").on("click",function(){return k.unblockUI(),!1}),!1):(s.find(".redux-scheme-layout-container").each(function(){var e=k(this).children(".redux-color-scheme"),c=e.data("title"),o=e.data("id"),t=e.data("hex-color"),s=e.data("alpha"),d=e.data("rgba"),e=e.data("group");r.push({id:o,title:c,color:t,alpha:s,rgba:d,group:e})}),r=JSON.stringify(r),r=encodeURIComponent(r),void((o=s.find(".redux-scheme-input-"+d).val())&&(e={action:"redux_color_schemes",nonce:redux.field_objects.color_scheme.nonce,opt_name:redux.field_objects.color_scheme.optName,type:"save",scheme_name:o,scheme_data:r,field_id:d},t=s.find("#redux-"+d+"-scheme-wait-message h1").html(),k.blockUI({message:"<h1>"+t+"saving scheme.</h1>",theme:!1,css:{width:"500px",padding:"5px"}}),s.find(".redux-scheme-select").select2("destroy"),k.post(redux_ajax_script.ajaxurl,e,function(e){s.find("#redux-scheme-select-"+d).on("change",function(){redux.field_objects.color_scheme.selectChange(s)}),"fail"===e?s.find("#redux-"+d+"-scheme-message-notice h2").html("The scheme <strong>"+o+"</strong> already exists and cannot be added again."):(s.find("#redux-scheme-select-"+d).replaceWith(e),s.find("#redux-"+d+"-scheme-message-notice h2").html("The scheme <strong>"+o+"</strong> has been added to your scheme list.")),k.blockUI({message:s.find("#redux-"+d+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),k("#redux-"+d+"-scheme-ok").on("click",function(){return k.unblockUI(),!1}),s.find("#redux-scheme-select-"+redux.field_objects.color_scheme.fieldID).on("change",function(){redux.field_objects.color_scheme.selectChange(s)}),s.find(".redux-scheme-select").select2(redux.field_objects.color_scheme.default_params),s.find("select.redux-color-scheme-opt-select").select2(redux.field_objects.color_scheme.default_params)})))))})},redux.field_objects.color_scheme.selectChange=function(e){var c,o=redux.field_objects.color_scheme.fieldID;e.find("ul.redux-scheme-layout").fadeOut(),c=e.find("#redux-scheme-select-"+o).val(),e.find("#redux-scheme-select-"+o+" option[value='']").remove(),e.find("input.redux-scheme-input-"+o).val(c),redux.field_objects.color_scheme.updateSchemeHTML(c,e)},redux.field_objects.color_scheme.updateSchemeHTML=function(e,c){var o=redux.field_objects.color_scheme.fieldID,t=c.find("#redux-"+o+"-scheme-wait-message h1").html();k.blockUI({message:"<h1>"+t+"updating scheme.</h1>",theme:!1,css:{width:"500px",padding:"5px"}}),t=c.find(".redux-color-scheme").attr("class"),e={action:"redux_color_schemes",nonce:redux.field_objects.color_scheme.nonce,opt_name:redux.field_objects.color_scheme.optName,type:"update",scheme_id:e,field_id:o,field_class:t},k.post(redux_ajax_script.ajaxurl,e,function(e){c.find("ul.redux-scheme-layout").replaceWith(e),redux.field_objects.color_scheme.setAccordions(c),c.find("ul.redux-scheme-layout").fadeIn(),k.unblockUI(),redux_change(c.find(".redux-color-scheme-container")),c.find("select.redux-color-scheme-opt-select").select2(redux.field_objects.color_scheme.default_params),"function"==typeof reduxColorSchemeAfterUpdateHTML&&reduxColorSchemeAfterUpdateHTML(k(this),c)})},redux.field_objects.color_scheme.initColorPicker=function(d){var e=redux.field_objects.color_scheme.fieldID,c=d.find(".redux-color-scheme"),o=c.data("current-alpha"),t=c.data("current-color");let r=c.data("output-transparent");var s=redux.field_objects.color_scheme.el.find(".redux-color-scheme-container");let l=s.data("palette");var i=s.data("picker-gap"),n=s.data("picker-font-size"),a=s.data("show-input"),f=s.data("show-initial"),u=s.data("show-alpha"),h=s.data("allow-empty"),m=s.data("show-palette"),x=s.data("show-palette-only"),_=s.data("show-selection-palette"),p=Number(s.data("max-palette-size")),b=s.data("clickout-fires-change"),g=String(s.data("choose-text")),j=String(s.data("cancel-text")),v=s.data("show-buttons"),w=String(s.data("container-class")),s=String(s.data("replacer-class"));d.find("li.redux-scheme-layout").css("width",i),d.find(".redux-layout-label").attr("style","font-size: "+n+"!important"),Number(null==o?1:o),t=""===t||"transparent"===t?"":t,r=Boolean(""!==r&&r),l=decodeURIComponent(l),null===(l=JSON.parse(l))&&(l=[["#000000","#434343","#666666","#999999","#b7b7b7","#cccccc","#d9d9d9","#efefef","#f3f3f3","#ffffff"],["#980000","#ff0000","#ff9900","#ffff00","#00ff00","#00ffff","#4a86e8","#0000ff","#9900ff","#ff00ff"],["#e6b8af","#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d9ead3","#c9daf8","#cfe2f3","#d9d2e9","#ead1dc"],["#dd7e6b","#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#a4c2f4","#9fc5e8","#b4a7d6","#d5a6bd"],["#cc4125","#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6d9eeb","#6fa8dc","#8e7cc3","#c27ba0"],["#a61c00","#cc0000","#e69138","#f1c232","#6aa84f","#45818e","#3c78d8","#3d85c6","#674ea7","#a64d79"],["#85200c","#990000","#b45f06","#bf9000","#38761d","#134f5c","#1155cc","#0b5394","#351c75","#741b47"],["#5b0f00","#660000","#783f04","#7f6000","#274e13","#0c343d","#1c4587","#073763","#20124d","#4c1130"]]),String(""===i?"60px":i),String(""===n?"11px":n),a=Boolean(""!==a&&a),f=Boolean(""!==f&&f),u=Boolean(""!==u&&u),h=Boolean(""!==h&&h),m=Boolean(""!==m&&m),x=Boolean(""!==x&&x),_=Boolean(""!==_&&_),b=Boolean(""!==b&&b),v=Boolean(""!==v&&v),c.spectrum({color:t,showAlpha:u,showInput:a,allowEmpty:h,className:"redux-full-spectrum",showInitial:f,showPalette:m,showSelectionPalette:_,maxPaletteSize:p,showPaletteOnly:x,clickoutFiresChange:b,chooseText:g,cancelText:j,showButtons:v,containerClassName:w,replacerClassName:s,preferredFormat:"hex6",localStorageKey:"redux.spectrum."+e,palette:l,change:function(e){let c,o,t;let s;o=null===e?(c=!0===r?"transparent":null,null):(c=e.toHexString(),e.getAlpha()),t="transparent"!==c?redux.field_objects.color_scheme.hexToRGBA(c,o):"transparent",e=k(this).data("block-id"),e=d.find("input#"+e+"-data"),s=e.val(),s=decodeURIComponent(s),(s=JSON.parse(s)).color=c,s.alpha=o,s.rgba=t,s=JSON.stringify(s),s=encodeURIComponent(s),e.val(s),redux_change(redux.field_objects.color_scheme.el.find(".redux-color-scheme-container"))}})}}(jQuery);