!function(x){"use strict";let p;redux.field_objects=redux.field_objects||{},redux.field_objects.multi_media=redux.field_objects.multi_media||{},redux.field_objects.multi_media.init=function(e){e=e||x(document).find(".redux-group-tab:visible").find(".redux-container-multi_media:visible"),x(e).each(function(){var e=x(this);let i=e;(i=e.hasClass("redux-field-container")?i:e.parents(".redux-field-container:first")).is(":hidden")||i.hasClass("redux-field-init")&&(i.removeClass("redux-field-init"),redux.field_objects.multi_media.bindDelete(e),e.find(".redux_upload_button").off().on("click",function(e){redux.field_objects.multi_media.addFile(e,x(this).parents("fieldset.redux-field:first"),x(this))}),redux.field_objects.multi_media.modInit(e))})},redux.field_objects.multi_media.bindDelete=function(e){e.find(".redux_remove_file_button").off("click").on("click",function(e){redux.field_objects.multi_media.removeFile(e,x(this).parents("fieldset.redux-field:first"),x(this))})},redux.field_objects.multi_media.modInit=function(){p=redux_multi_media_l10},redux.field_objects.multi_media.removeErrMsgs=function(e){x("#"+e+" .attach_list li.redux-file-exists").each(function(e,i){x(i).remove()}),x("#"+e+" .attach_list li.redux-max-limit").each(function(e,i){x(i).remove()})},redux.field_objects.multi_media.selExists=function(e,t){let l,d=!1;return x("#"+e+" .attach_list li").each(function(e,i){if(0!==(l=x(i).find("input#filelist-"+t)).length)return!(d=!0)}),d},redux.field_objects.multi_media.addFile=function(e,i,t){let r,l;let o;let c=!0;const f=t.prev("input").attr("id"),m=x("#"+f),_=m.data("name"),h=i.attr("data-id");e.preventDefault(),r,redux.field_objects.multi_media.removeErrMsgs(h),t=x(i).find(".library-filter").data("lib-filter"),o=x(i).find(".redux-multi-media-container").data("max-file-upload"),void 0!==t&&""!==t&&(l=[],t=decodeURIComponent(t),t=JSON.parse(t),x.each(t,function(e,i){l.push(i)})),(r=wp.media({multiple:!0,title:p.title,library:{type:l},button:{text:p.upload_file}})).on("select",function(){let t=0,l;const d=[],s=[],n=[],a=[];var e=r.state().get("selection").toJSON();const u=x("#"+h+" .attach_list").children().length;m.val(e.url),x("#"+f+"_id").val(e.id),x(e).each(function(){let e,i;return o<=0||t+u<o?redux.field_objects.multi_media.selExists(h,this.id)?(e=(e=p.dup_warn).replace("%s","<strong>"+this.filename+"</strong>"),c='<li class="redux-file-exists">'+e+"</li>",a.push(c),!(l=!1)):(this.type&&"image"===this.type?(c='<li class="img_status"><img width="50" height="50" src="'+this.url+'" class="attachment-50x50" alt="'+this.filename+'"><p><a href="#" class="redux_remove_file_button" rel="'+f+"["+this.id+']">'+p.remove_image+'</a></p><input type="hidden" id="filelist-'+this.id+'" name="'+_+"["+this.id+']" value="'+this.url+'"></li>',n.push(c),l=!0):(c="<li>"+p.file+" <strong>"+this.filename+'</strong>&nbsp;&nbsp;&nbsp; (<a href="'+this.url+'" target="_blank" rel="external">'+p.download+'</a> / <a href="#" class="redux_remove_file_button" rel="'+f+"["+this.id+']">'+p.remove_file+'</a>)<input type="hidden" id="filelist-'+this.id+'" name="'+_+"["+this.id+']" value="'+this.url+'"></li>',s.push(c)),void t++):(i=(i=p.max_warn).replace("%s","<strong>"+o+"</strong>"),c='<li class="redux-max-limit">'+i+"</li>",a.push(c),!1)}),x.isEmptyObject(n)||x(n).each(function(e,i){d.push(i),l=!0}),x.isEmptyObject(s)||x(s).each(function(e,i){d.push(i),l=!0}),x.isEmptyObject(a)||x(a).each(function(e,i){d.push(i)}),x(d).each(function(){m.siblings(".redux_media_status").slideDown().append(this)}),r.close(),!0===l&&(redux.field_objects.multi_media.bindDelete(i),redux_change(x(i).find(".redux_media_status")))}),r.open()},redux.field_objects.multi_media.removeFile=function(e,i,t){var l;return e.preventDefault(),t.is(".attach_list .redux_remove_file_button")?(t.parents("li").remove(),redux_change(x(i).find(".redux_media_status"))):(e=t.attr("rel"),l=t.parents(".img_status"),i.find("input#"+e).val(""),i.find("input#"+e+"_id").val(""),(l.length?l:t.parents(".redux_media_status")).html("")),!1}}(jQuery);