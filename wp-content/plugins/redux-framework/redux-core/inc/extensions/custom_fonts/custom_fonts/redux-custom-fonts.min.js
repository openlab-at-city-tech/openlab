!function(r){"use strict";var a,c,f=!1;redux.field_objects=redux.field_objects||{},redux.field_objects.custom_fonts=redux.field_objects.custom_fonts||{},redux.field_objects.custom_fonts.init=function(t){t=t||r(document).find(".redux-group-tab:visible").find(".redux-container-custom_font:visible"),r(t).each(function(){var t=r(this),e=t;(e=t.hasClass("redux-field-container")?e:t.parents(".redux-field-container:first")).is(":hidden")||e.hasClass("redux-field-init")&&(e.removeClass("redux-field-init"),redux.field_objects.custom_fonts.modInit(t))})},redux.field_objects.custom_fonts.modInit=function(n){var t=r(".redux-ajax-security").data("opt-name");a=redux_custom_fonts_l10,c=void 0===t?redux:redux.optName,n.find(".checkbox").on("click",function(){var t,e,o=0;"custom-font-convert"===r(this).attr("id")&&(r(this).is(":checked")?(t="",e=1,n.find(".conversion-types").removeClass("is-disabled")):(t="disabled",e=.7,n.find(".conversion-types").addClass("is-disabled")),n.find("#custom-font-eot,#custom-font-svg,#custom-font-ttf,#custom-font-woff,#custom-font-woff2").prop("disabled",t),n.find(".conversion-types").css("opacity",e)),r(this).is(":checked")&&(o=r(this).parent().find(".checkbox-check").attr("data-val")),r(this).parent().find(".checkbox-check").val(o),redux_change(r(this))}),n.find(".remove-font").off("click").on("click",function(){redux.field_objects.custom_fonts.remove_font(n,r(this).parents("fieldset.redux-field:first"))}),n.find(".media_add_font").off().on("click",function(t){redux.field_objects.custom_fonts.add_font(n,t,r(this).parents("fieldset.redux-field:first"))}),n.find(".fontDelete").on("click",function(t){var e=r(this).parents("td:first");return t.preventDefault(),e.find(".spinner").show(),(t=r(this).data()).action="redux_custom_fonts",t.nonce=r(this).parents(".redux-container-custom_font:first").find(".media_add_font").attr("data-nonce"),r.post(ajaxurl,t,function(t){(t=JSON.parse(t)).type&&"success"===t.type?(1===e.parents("table:first").find("tr").length?e.parents("table:first"):e.parents("tr:first")).fadeOut().remove():(alert(a.delete_error+" "+t.msg),e.find(".spinner").hide())}),!1})},redux.field_objects.custom_fonts.startTimer=function(o,n){var s;r.ajax({url:ajaxurl,type:"POST",data:{action:"redux_custom_font_timer"},beforeSend:function(){},success:function(t){var e;!1===f?(setTimeout(redux.field_objects.custom_fonts.startTimer(o,n),500),e=c.args.please_wait+": "+n+"<br><br>"+t):(e=a.complete,t="finished"),""!==t&&s!==t&&(r(".blockUI.blockMsg h2").html(e),s=t)}})},redux.field_objects.custom_fonts.add_font=function(s,t,i){var d;t.preventDefault(),(d=wp.media({multiple:!1,library:{type:["application","font"]},title:"Redux Custom Fonts:  "+a.media_title,button:{text:a.media_button}})).on("select",function(){var t,e,o=d.state().get("selection").first(),n=i.find(".font-error");n.slideUp(),n.find("span").text(""),d.close(),"application"!==o.attributes.type&&"font"!==o.attributes.type||(t=r(i).find(".media_add_font").attr("data-nonce"),e=r("#custom-font-convert").is(":checked"),o="application/zip "===(t={action:"redux_custom_fonts",nonce:t,attachment_id:o.id,title:o.attributes.title,mime:o.attributes.mime,filename:o.attributes.filename,conversion:Boolean(e)}).mime?a.unzip:a.convert,redux.field_objects.custom_fonts.startTimer(s,o),r.blockUI({message:"<h2>"+c.args.please_wait+": "+o+"</h2>"}),r.post(ajaxurl,t,function(t){if(console.log("Redux Custom Fonts API Response (For support purposes)"),console.log(t),"success"===(t=JSON.parse(t)).type){if(""!==t.msg)return r.unblockUI(),n.find("span").html(t.msg+"  "+a.partial),n.slideDown(),void(f=!0);window.onbeforeunload="",location.reload()}else"error"===t.type?(r.unblockUI(),n.find("span").html(t.msg)):(r.unblockUI(),n.find("span").text(a.unknown)),n.slideDown();f=!0}))}),d.open()},redux.field_objects.custom_fonts.remove_font=function(t,e){e.find(".remove-image").addClass("hide")},redux.field_objects.custom_fonts.sleep=function(t){for(var e=(new Date).getTime(),o=0;o<1e7&&!((new Date).getTime()-e>t);o+=1);}}(jQuery);