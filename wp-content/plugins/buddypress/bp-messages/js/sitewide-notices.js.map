{"version":3,"sources":["bp-messages/js/sitewide-notices.js"],"names":["bpSitewideNoticeBlock","constructor","settings","path","dismissPath","root","nonce","start","document","querySelectorAll","forEach","dismissButton","addEventListener","event","preventDefault","fetch","method","headers","then","response","json","data","dismissed","elem","remove","window","bpSitewideNoticeBlockSettings","bpSitewideNotice","readyState"],"mappings":";AAKA,MAAMA,EACLC,YAAaC,GACN,MAAA,KAAEC,EAAF,YAAQC,EAAR,KAAqBC,EAArB,MAA2BC,GAAUJ,EACtCC,KAAAA,KAAOA,EACPC,KAAAA,YAAcA,EACdC,KAAAA,KAAOA,EACPC,KAAAA,MAAQA,EAGdC,QAECC,SAASC,iBAAkB,8CAA+CC,QAAWC,IACpFA,EAAcC,iBAAkB,QAAWC,IAC1CA,EAAMC,iBAENC,MAAO,KAAKV,KAAO,KAAKD,YAAa,CACpCY,OAAQ,OACRC,QAAS,CACO,aAAA,KAAKX,SAElBY,KACDC,GAAcA,EAASC,QACxBF,KACCG,SACI,IAAuBA,QAAQ,IAAuBA,EAAKC,WAAaD,EAAKC,WACjFd,SAASC,iBAAkB,6BAA8BC,QAAWa,IACnEA,EAAKC,kBAWb,MAAMtB,EAAWuB,OAAOC,+BAAiC,GACnDC,EAAmB,IAAI3B,EAAuBE,GAE/C,YAAcM,SAASoB,WAC3BpB,SAASI,iBAAkB,mBAAoBe,EAAiBpB,SAEhEoB,EAAiBpB","file":"sitewide-notices.js","sourceRoot":"../src/js","sourcesContent":["/**\n * Front-end Sitewide notices block class.\n *\n * @since 9.0.0\n */\nclass bpSitewideNoticeBlock {\n\tconstructor( settings ) {\n\t\tconst { path, dismissPath, root, nonce } = settings;\n\t\tthis.path = path;\n\t\tthis.dismissPath = dismissPath;\n\t\tthis.root = root;\n\t\tthis.nonce = nonce;\n\t}\n\n\tstart() {\n\t\t// Listen to each Block's dismiss button clicks\n\t\tdocument.querySelectorAll( '.bp-sitewide-notice-block a.dismiss-notice' ).forEach( ( dismissButton ) => {\n\t\t\tdismissButton.addEventListener( 'click', ( event ) => {\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\tfetch( this.root + this.dismissPath, {\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'X-WP-Nonce' : this.nonce,\n\t\t\t\t\t}\n\t\t\t\t} ).then(\n\t\t\t\t\t( response ) => response.json()\n\t\t\t\t).then(\n\t\t\t\t\t( data ) => {\n\t\t\t\t\t\tif ( 'undefined' !== typeof data && 'undefined' !== typeof data.dismissed && data.dismissed ) {\n\t\t\t\t\t\t\tdocument.querySelectorAll( '.bp-sitewide-notice-block' ).forEach( ( elem ) => {\n\t\t\t\t\t\t\t\telem.remove();\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t} );\n\t\t} );\n\t}\n}\n\n// widget_bp_core_sitewide_messages buddypress widget wp-block-bp-sitewide-notices > bp-sitewide-notice > a.dismiss-notice\nconst settings = window.bpSitewideNoticeBlockSettings || {};\nconst bpSitewideNotice = new bpSitewideNoticeBlock( settings );\n\nif ( 'loading' === document.readyState ) {\n\tdocument.addEventListener( 'DOMContentLoaded', bpSitewideNotice.start() );\n} else {\n\tbpSitewideNotice.start();\n}\n"]}