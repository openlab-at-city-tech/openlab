{"version":3,"sources":["bp-members/js/dynamic-members.js"],"names":["i18n","__","sprintf","wp","dynamicWidgetBlock","bp","bpMembersWidgetBlock","loop","members","container","type","tmpl","useTemplate","selector","document","querySelector","output","length","forEach","member","last_activity","extra","timediff","total_friend_count","friendsCount","parseInt","registered_since","avatar_alt","name","innerHTML","start","blocks","block","i","query_args","list","closest","getItems","querySelectorAll","navItem","addEventListener","event","preventDefault","target","classList","remove","add","newType","getAttribute","settings","window","bpDynamicMembersSettings","bpDynamicMembersBlocks","bpDynamicMembers","readyState"],"mappings":";AAGA,MACCA,MAAM,GACLC,EADK,QAELC,IAEEC,IAKE,mBACLC,GACGC,GAOJ,MAAMC,UAA6BF,EAClCG,KAAMC,EAAU,GAAIC,EAAY,GAAIC,EAAO,UACpCC,MAAAA,EAAO,MAAMC,YAAa,2BAC1BC,EAAWC,SAASC,cAAe,IAAMN,GAC3CO,IAAAA,EAAS,GAERR,GAAWA,EAAQS,OACvBT,EAAQU,QAAWC,IACb,GAAA,WAAaT,GAAQS,EAAOC,cAEhCD,EAAOE,MAAQnB,EAASD,EAAI,YAAa,cAAgBkB,EAAOC,cAAcE,eACxE,GAAK,YAAcZ,GAAQS,EAAOI,mBAAqB,CACvDC,MAAAA,EAAeC,SAAUN,EAAOI,mBAAoB,IAGzDJ,EAAOE,MADH,IAAMG,EACKvB,EAAI,aAAc,cACtB,IAAMuB,EACFvB,EAAI,WAAY,cAGhBC,EAASD,EAAI,aAAc,cAAgBkB,EAAOI,wBAEvD,WAAab,GAAQS,EAAOO,mBAEvCP,EAAOE,MAAQnB,EAASD,EAAI,gBAAiB,cAAgBkB,EAAOO,mBAIrEP,EAAOQ,WAAazB,EAASD,EAAI,wBAAyB,cAAgBkB,EAAOS,MAEjFZ,GAAUL,EAAMQ,KAGjBH,EAAS,6BAA+Bf,EAAI,oBAAqB,cAAiB,SAGnFY,EAASgB,UAAYb,EAGtBc,QACMC,KAAAA,OAAOb,QAAS,CAAEc,EAAOC,KACvB,MAAA,SAAEpB,GAAamB,GACf,KAAEtB,GAASsB,EAAME,WACjBC,EAAOrB,SAASC,cAAe,IAAMF,GAAWuB,QAAS,+BAGzDC,MAAAA,SAAU3B,EAAMuB,GAGtBE,EAAKG,iBAAkB,mBAAoBpB,QAAWqB,IACrDA,EAAQC,iBAAkB,QAAWC,IACpCA,EAAMC,iBAGND,EAAME,OAAOP,QAAS,iBAAkBrB,cAAe,aAAc6B,UAAUC,OAAQ,YACvFJ,EAAME,OAAOC,UAAUE,IAAK,YAEtBC,MAAAA,EAAUN,EAAME,OAAOK,aAAc,gBAEtCD,IAAY,KAAKhB,OAAQE,GAAIC,WAAWxB,MACtC2B,MAAAA,SAAUU,EAASd,UAQ/B,MAAMgB,EAAWC,OAAOC,0BAA4B,GAC9CpB,EAASmB,OAAOE,wBAA0B,GAC1CC,EAAmB,IAAI/C,EAAsB2C,EAAUlB,GAExD,YAAcjB,SAASwC,WAC3BxC,SAAS0B,iBAAkB,mBAAoBa,EAAiBvB,SAEhEuB,EAAiBvB","file":"dynamic-members.js","sourceRoot":"../src/js","sourcesContent":["/**\n * WordPress dependencies.\n */\nconst {\n\ti18n: {\n\t\t__,\n\t\tsprintf,\n\t},\n} = wp;\n\n/**\n * BuddyPress dependencies.\n */\nconst {\n\tdynamicWidgetBlock,\n} = bp;\n\n/**\n * Front-end Dynamic Members Widget Block class.\n *\n * @since 9.0.0\n */\nclass bpMembersWidgetBlock extends dynamicWidgetBlock {\n\tloop( members = [], container = '', type = 'active' ) {\n\t\tconst tmpl = super.useTemplate( 'bp-dynamic-members-item' );\n\t\tconst selector = document.querySelector( '#' + container );\n\t\tlet output = '';\n\n\t\tif ( members && members.length ) {\n\t\t\tmembers.forEach( ( member ) => {\n\t\t\t\tif ( 'active' === type && member.last_activity ) {\n\t\t\t\t\t/* translators: %s: last activity timestamp (e.g. \"Active 1 hour ago\") */\n\t\t\t\t\tmember.extra = sprintf( __( 'Active %s', 'buddypress' ), member.last_activity.timediff );\n\t\t\t\t} else if ( 'popular' === type && member.total_friend_count ) {\n\t\t\t\t\tconst friendsCount = parseInt( member.total_friend_count, 10 );\n\n\t\t\t\t\tif ( 0 === friendsCount ) {\n\t\t\t\t\t\tmember.extra = __( 'No friends', 'buddypress' );\n\t\t\t\t\t} else if ( 1 === friendsCount ) {\n\t\t\t\t\t\tmember.extra = __( '1 friend', 'buddypress' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t/* translators: %s: total friend count (more than 1). */\n\t\t\t\t\t\tmember.extra = sprintf( __( '%s friends', 'buddypress' ), member.total_friend_count );\n\t\t\t\t\t}\n\t\t\t\t} else if ( 'newest' === type && member.registered_since ) {\n\t\t\t\t\t/* translators: %s is time elapsed since the registration date happened */\n\t\t\t\t\tmember.extra = sprintf( __( 'Registered %s', 'buddypress' ), member.registered_since );\n\t\t\t\t}\n\n\t\t\t\t/* translators: %s: member name */\n\t\t\t\tmember.avatar_alt = sprintf( __( 'Profile picture of %s', 'buddypress' ), member.name );\n\n\t\t\t\toutput += tmpl( member );\n\t\t\t} );\n\t\t} else {\n\t\t\toutput = '<div class=\"widget-error\">' + __( 'No members found.', 'buddypress' ) + '</div>';\n\t\t}\n\n\t\tselector.innerHTML = output;\n\t}\n\n\tstart() {\n\t\tthis.blocks.forEach( ( block, i ) => {\n\t\t\tconst { selector } = block;\n\t\t\tconst { type } = block.query_args;\n\t\t\tconst list = document.querySelector( '#' + selector ).closest( '.bp-dynamic-block-container' );\n\n\t\t\t// Get default Block's type members.\n\t\t\tsuper.getItems( type, i );\n\n\t\t\t// Listen to Block's Nav item clics\n\t\t\tlist.querySelectorAll( '.item-options a' ).forEach( ( navItem ) => {\n\t\t\t\tnavItem.addEventListener( 'click', ( event ) => {\n\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t// Changes the displayed filter.\n\t\t\t\t\tevent.target.closest( '.item-options' ).querySelector( '.selected' ).classList.remove( 'selected' );\n\t\t\t\t\tevent.target.classList.add( 'selected' );\n\n\t\t\t\t\tconst newType = event.target.getAttribute( 'data-bp-sort' );\n\n\t\t\t\t\tif ( newType !== this.blocks[ i ].query_args.type ) {\n\t\t\t\t\t\tsuper.getItems( newType, i );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} );\n\t\t} );\n\t}\n}\n\nconst settings = window.bpDynamicMembersSettings || {};\nconst blocks = window.bpDynamicMembersBlocks || {};\nconst bpDynamicMembers = new bpMembersWidgetBlock( settings, blocks );\n\nif ( 'loading' === document.readyState ) {\n\tdocument.addEventListener( 'DOMContentLoaded', bpDynamicMembers.start() );\n} else {\n\tbpDynamicMembers.start();\n}\n"]}