function add_option(e){var t=document.getElementById(e+"_more"),o=document.getElementById(e+"_option_number").value,i=document.createElement("div"),r=document.createElement("span"),n=document.createElement("input"),d=document.createElement("label"),a=document.createElement("input"),l=document.createTextNode(XProfileAdmin.text.defaultValue),u=document.createTextNode(XProfileAdmin.text.deleteLabel),s=document.createElement("div"),c=document.createElement("a");i.setAttribute("id",e+"_div"+o),i.setAttribute("class","bp-option sortable"),r.setAttribute("class","bp-option-icon grabber"),n.setAttribute("type","text"),n.setAttribute("name",e+"_option["+o+"]"),n.setAttribute("id",e+"_option"+o),"checkbox"===e||"multiselectbox"===e?(a.setAttribute("type","checkbox"),a.setAttribute("name","isDefault_"+e+"_option["+o+"]")):(a.setAttribute("type","radio"),a.setAttribute("name","isDefault_"+e+"_option")),a.setAttribute("value",o),c.setAttribute("href",'javascript:hide("'+e+"_div"+o+'")'),c.setAttribute("class","delete"),c.appendChild(u),s.setAttribute("class","delete-button"),s.appendChild(c),d.appendChild(document.createTextNode(" ")),d.appendChild(a),d.appendChild(document.createTextNode(" ")),d.appendChild(l),d.appendChild(document.createTextNode(" ")),i.appendChild(r),i.appendChild(document.createTextNode(" ")),i.appendChild(n),i.appendChild(d),i.appendChild(s),t.appendChild(i),enableSortableFieldOptions(e),document.getElementById(e+"_option"+o).focus(),o++,document.getElementById(e+"_option_number").value=o}function show_options(e){for(var t,o=0;o<XProfileAdmin.do_settings_section_field_types.length;o++)document.getElementById(XProfileAdmin.do_settings_section_field_types[o]).style.display="none";t=0<=XProfileAdmin.do_settings_section_field_types.indexOf(e)?(document.getElementById(e).style.display="","on"):(jQuery("#do-autolink").val(""),""),""===XProfileAdmin.do_autolink&&jQuery("#do-autolink").val(t),jQuery("#field-type-visibiliy-metabox, #field-type-required-metabox, #field-type-autolink-metabox, #field-type-member-types, #field-signup-position-metabox").show(),-1!==XProfileAdmin.hide_required_metabox.indexOf(e)&&jQuery("#field-type-required-metabox").hide(),-1!==XProfileAdmin.hide_signup_position_metabox.indexOf(e)&&jQuery("#field-signup-position-metabox").hide(),-1!==XProfileAdmin.hide_allow_custom_visibility_metabox.indexOf(e)&&jQuery("#field-type-visibiliy-metabox").hide(),-1!==XProfileAdmin.hide_do_autolink_metabox.indexOf(e)&&jQuery("#field-type-autolink-metabox").hide(),-1!==XProfileAdmin.hide_member_types_metabox.indexOf(e)&&jQuery("#field-type-member-types").hide(),jQuery(document).trigger("bp-xprofile-show-options",e)}function hide(e){if(!document.getElementById(e))return!1;document.getElementById(e).style.display="none";e=e.replace("div","option");document.getElementById(e).value=""}function toggle_no_member_type_notice(){var e,t=jQuery("input.member-type-selector");t.length&&(e=!1,t.each(function(){if(jQuery(this).is(":checked"))return!(e=!0)}),e?jQuery("p.member-type-none-notice").addClass("hide"):jQuery("p.member-type-none-notice").removeClass("hide"))}var fixHelper=function(e,t){return t.children().each(function(){jQuery(this).width(jQuery(this).width())}),t};function enableSortableFieldOptions(){jQuery(".bp-options-box").sortable({cursor:"move",items:"div.sortable",tolerance:"intersect",axis:"y"}),jQuery(".sortable, .sortable span").css("cursor","move")}function destroySortableFieldOptions(){jQuery(".bp-options-box").sortable("destroy"),jQuery(".sortable, .sortable span").css("cursor","default")}function titleHint(e){e=e||"title";var t=jQuery("#"+e),o=jQuery("#"+e+"-prompt-text");""===t.val()?o.removeClass("screen-reader-text"):o.addClass("screen-reader-text"),o.on("click",function(){jQuery(this).addClass("screen-reader-text"),t.trigger("focus")}),t.on("blur",function(){""===this.value&&o.removeClass("screen-reader-text")}).on("focus",function(){o.addClass("screen-reader-text")}).on("keydown",function(e){o.addClass("screen-reader-text"),jQuery(this).off(e)})}jQuery(function(){var n=!1,e=(jQuery("#bp-xprofile-add-field #title").trigger("focus"),toggle_no_member_type_notice(),jQuery("input.member-type-selector").on("change",function(){toggle_no_member_type_notice()}),jQuery("a.ajax-option-delete").on("click",function(){var e=this.id.split("-")[1];jQuery.post(ajaxurl,{action:"xprofile_delete_option",cookie:encodeURIComponent(document.cookie),_wpnonce:jQuery("input#_wpnonce").val(),option_id:e},function(){})}),jQuery('[id^="sort_order_"]').on("change",function(){"custom"!==jQuery(this).val()?destroySortableFieldOptions():enableSortableFieldOptions(jQuery("#fieldtype :selected").val())}),jQuery("ul#field-group-tabs").show(),jQuery("ul#field-group-tabs").sortable({cursor:"move",axis:"x",opacity:1,items:"li:not(.not-sortable)",tolerance:"intersect",update:function(){jQuery.post(ajaxurl,{action:"xprofile_reorder_groups",cookie:encodeURIComponent(document.cookie),_wpnonce_reorder_groups:jQuery("input#_wpnonce_reorder_groups").val(),group_order:jQuery(this).sortable("serialize")},function(){})}}).disableSelection(),jQuery("fieldset.field-group").sortable({cursor:"move",opacity:.7,items:"fieldset",tolerance:"pointer",update:function(){if(n)return!1;jQuery.post(ajaxurl,{action:"xprofile_reorder_fields",cookie:encodeURIComponent(document.cookie),_wpnonce_reorder_fields:jQuery("input#_wpnonce_reorder_fields").val(),field_order:jQuery(this).sortable("serialize"),field_group_id:jQuery(this).attr("id")},function(){})}}).disableSelection(),enableSortableFieldOptions(jQuery("#fieldtype :selected").val()),titleHint("title"),jQuery('input[name="date_format"]')),t=jQuery("#date-format-custom-value"),o=jQuery("#date-format-custom-sample"),i=(e.on("click",function(e){switch(e.target.value){case"elapsed":t.val(""),o.html("");break;case"custom":break;default:t.val(e.target.value),o.html(jQuery(e.target).siblings(".date-format-label").html())}}),jQuery("#date-format-custom")),r=(t.on("focus",function(){i.prop("checked","checked")}),jQuery("#date-format-custom-spinner"));t.on("change",function(e){r.addClass("is-active"),jQuery.post(ajaxurl,{action:"date_format",date:e.target.value},function(e){r.removeClass("is-active"),o.html(e)})});var d,a,e=jQuery("#tabs").tabs();a=e,d=jQuery("ul:first li",a).droppable({accept:".connectedSortable fieldset",hoverClass:"ui-state-hover",activeClass:"ui-state-acceptable",touch:"pointer",tolerance:"pointer",drop:function(e,t){function o(e){var t,o={action:"xprofile_reorder_fields",cookie:encodeURIComponent(document.cookie),_wpnonce_reorder_fields:jQuery("input#_wpnonce_reorder_fields").val()};a.tabs("option","active",d.index(i)),r=jQuery(i.find("a").attr("href")).find(".connectedSortable"),jQuery(r).find("p.nofields").hide("slow"),jQuery.extend(o,{field_group_id:jQuery(r).attr("id"),group_tab:jQuery(i).prop("id")}),t=jQuery(r).sortable("serialize"),e?(e=e.replace("draggable_field_","draggable_signup_field[]="),t?t+="&"+e:t=e,jQuery.extend(o,{new_signup_field_id:e})):(jQuery(this).appendTo(r).show("slow").animate({opacity:"1"},500),r=jQuery(i.find("a").attr("href")).find(".connectedSortable"),t=jQuery(r).sortable("serialize"),jQuery.extend(o,{field_group_id:jQuery(r).attr("id")})),jQuery.extend(o,{field_order:t}),jQuery.post(ajaxurl,o,function(e){e.data&&e.data.signup_field&&(jQuery(r).append(e.data.signup_field),e.data.field_id)&&jQuery("#draggable_field_"+e.data.field_id+" legend").append(jQuery("<span></span>").addClass("bp-signup-field-label").html(XProfileAdmin.signup_info))},"json").always(function(){n=!1})}var i=jQuery(this),r=jQuery(i.find("a").attr("href")).find(".connectedSortable");jQuery(i).removeClass("drop-candidate"),"signup-group"===jQuery(i).prop("id")?o(t.draggable.prop("id")):t.draggable.prop("id").match(/draggable_signup_field_([0-9]+)/)||t.draggable.hide("slow",o)},over:function(){n=!0,jQuery(this).addClass("drop-candidate")},out:function(){jQuery(this).removeClass("drop-candidate"),n=!1}}),jQuery("#signup-fields").on("click",".removal",function(e){e.preventDefault();var t=jQuery(e.target).attr("href").replace("#remove_field-",""),o=jQuery(e.target).closest("#draggable_signup_field_"+t);if(!t)return!1;jQuery.post(ajaxurl,{action:"xprofile_remove_signup_field",cookie:encodeURIComponent(document.cookie),_wpnonce_reorder_fields:jQuery("input#_wpnonce_reorder_fields").val(),signup_field_id:t},function(e){e.success&&(jQuery(o).remove(),jQuery("#draggable_field_"+t+" .bp-signup-field-label").remove())},"json")})});