/*! For license information please see block-controls.js.LICENSE.txt */
(()=>{var e={45:e=>{"use strict";e.exports={to12Hour:function(e){var t=e<12?"am":"pm";return{hour:(e+11)%12+1,meridiem:t,meridian:t}},to24Hour:function(e){return("am"===(e.meridiem||e.meridian)?0:12)+e.hour%12}}},942:(e,t)=>{var n;!function(){"use strict";var a={}.hasOwnProperty;function r(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=l(e,o(n)))}return e}function o(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return r.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)a.call(e,n)&&e[n]&&(t=l(t,n));return t}function l(e,t){return t?e?e+" "+t:e+t:e}e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(942),t=n.n(e),a=n(45),r=n.n(a);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,c(a.key),a)}}function c(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}function i(e,t,n){return t=u(t),function(e,t){if(t&&("object"==o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,s()?Reflect.construct(t,n||[],u(e).constructor):t.apply(e,n))}function s(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(s=function(){return!!e})()}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function g(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,l,c=[],i=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(a=o.call(n)).done)&&(c.push(a.value),c.length!==t);i=!0);}catch(e){s=!0,r=e}finally{try{if(!i&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw r}}return c}}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return m(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var p=wp.components,h=p.ButtonGroup,f=p.Button,y=p.DateTimePicker,k=(p.TextControl,p.CheckboxControl),C=p.Popover,_=p.Tooltip,w=p.SelectControl,E=(p.Icon,wp.element),R=E.Component,x=E.Fragment,S=E.useState,T=wp.i18n,O=T.__,B=T._x,P=wp.hooks.applyFilters;function A(e){var t=b(S(!1),2),n=t[0],a=t[1],r=function(){a(!n)},o=e.buttonLabel,l=e.dateLabel,c=e.date,i=e.onChangeDate,s=e.onDateClear,u=e.onInvalidDate,d=e.placement,g=e.offset;return React.createElement(x,null,React.createElement("div",{className:"advgb-advcalendar-control"},React.createElement("label",null,l),React.createElement("div",null,React.createElement(f,{isLink:!0,icon:"calendar",onClick:r},React.createElement(_,{text:O("Change date","advanced-gutenberg")},React.createElement("span",null,c?moment(c).format("MMMM DD YYYY, h:mm a"):o))),c&&React.createElement(f,{icon:"no-alt",className:"advgb-advcalendar-remove-icon",onClick:function(){return s()}}))),n&&React.createElement(C,{className:"advgb-advcalendar-popover",onClose:a.bind(null,!1),resize:!1,placement:d,offset:g},React.createElement("label",{className:"advgb-advcalendar-popover-label"},l,React.createElement(f,{icon:"no-alt",className:"advgb-advcalendar-remove-icon",onClick:r})),React.createElement(y,{currentDate:c,onChange:i,is12Hour:!0,isInvalidDate:u})))}function j(e){var t=[{slug:0,label:B("S","Sunday first letter","advanced-gutenberg")},{slug:1,label:O("M","advanced-gutenberg")},{slug:2,label:B("T","Tuesday first letter","advanced-gutenberg")},{slug:3,label:O("W","advanced-gutenberg")},{slug:4,label:B("T","Thursday first letter","advanced-gutenberg")},{slug:5,label:O("F","advanced-gutenberg")},{slug:6,label:B("S","Saturday first letter","advanced-gutenberg")}],n=e.label,a=e.days,r=void 0===a?[]:a,o=e.onChangeDays,l=b(S(Array.isArray(r)?r:[]),2),c=l[0],i=l[1];function s(e){return c.some((function(t){return t===e}))}return React.createElement(x,null,React.createElement("div",{className:"advgb-checkbox-wrapper"},React.createElement("label",null,n),React.createElement("div",{className:"advgb-checkbox-inline"},t.map((function(e){return React.createElement(k,{label:e.label,checked:s(e.slug),onChange:function(){return function(e){var n;if(s(e))n=c.filter((function(t){return t!==e}));else{var a=t.find((function(t){return t.slug===e}));n=[].concat(g(c),[a.slug])}var r=g(new Set(n));i(r),o&&o(n)}(e.slug)}})})))))}A.defaultProps={placement:"left",offset:40};var K=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=i(this,t,[e])).state={onChangeTime:null,currentTime:n.props.currentTime||null,hours:null,minutes:null,meridian:"am",onInit:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(t,e),n=t,(a=[{key:"componentWillMount",value:function(){var e=this.state,t=e.onChangeTime,n=e.currentTime,a=e.onInit;this.props.onChangeTime!==t&&this.setState({onChangeTime:this.props.onChangeTime}),this.props.currentTime!==n&&this.setState({currentTime:this.props.currentTime}),n&&n.includes(":")&&a&&this.setState({hours:n.split(":")[0],minutes:n.split(":")[1],meridian:parseInt(n.split(":")[0])>11?"pm":"am",onInit:!1})}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,a=(n.onChangeTime,n.currentTime,this.state),o=a.hours,l=a.minutes,c=a.meridian,i=t.hours,s=t.minutes,u=t.meridian;if(o!==i||l!==s||c!==u){if(!o&&!l)return;o&&!l&&this.setState({minutes:"00"}),l&&!o&&this.setState({hours:"01"});var d="".concat(this.appendZero(r().to24Hour({hour:parseInt(o),meridiem:c})),":").concat(l,":00");this.props.onChangeTime(d)}}},{key:"appendZero",value:function(e){if(!isNaN(e)){var t=parseInt(e);return t>9?t:"0".concat(t)}}},{key:"render",value:function(){var e=this,t=this.state,n=(t.onChangeTime,t.currentTime,t.hours),a=t.minutes,o=t.meridian;return React.createElement(x,null,React.createElement("div",{className:"advgb-advtime-control"},React.createElement("label",null,this.props.label),React.createElement("div",{className:"advgb-advtime-hours-minutes"},React.createElement("input",{type:"text",value:n?this.appendZero(r().to12Hour(parseInt(n)).hour):"",onChange:function(t){var n=Math.max(1,Math.min(12,Number(t.target.value)));e.setState({hours:e.appendZero(n)})},onKeyDown:function(t){var n=Number(t.target.value);"ArrowUp"===t.key&&n<12?e.setState({hours:e.appendZero(n+1)}):"ArrowDown"===t.key&&n>1&&e.setState({hours:e.appendZero(n-1)})},placeholder:"--"}),React.createElement("span",null,":"),React.createElement("input",{type:"text",value:a||"",onChange:function(t){var n=Math.max(0,Math.min(59,Number(t.target.value)));e.setState({minutes:e.appendZero(n)})},onKeyDown:function(t){var n=Number(t.target.value);"ArrowUp"===t.key&&n<59?e.setState({minutes:e.appendZero(n+1)}):"ArrowDown"===t.key&&n>0&&e.setState({minutes:e.appendZero(n-1)})},placeholder:"--"})),React.createElement(h,{className:"advgb-advtime-meridian"},React.createElement(f,{variant:null===o||"am"===o?"primary":"secondary",onClick:function(){e.setState({meridian:"am"})},disabled:!n||!a},O("AM","advanced-gutenberg")),React.createElement(f,{variant:"pm"===o?"primary":"secondary",onClick:function(){e.setState({meridian:"pm"})},disabled:!n||!a},O("PM","advanced-gutenberg"))),n&&a&&React.createElement(f,{className:"advgb-advtime-remove-icon",icon:"no-alt",onClick:function(){e.props.onTimeClear(),e.setState({hours:null,minutes:null,meridian:"am"})}})))}}])&&l(n.prototype,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,a}(R);function D(e){var t=e.label,n=e.currentTime,a=e.onChangeTime,r=e.onTimeClear;return React.createElement(K,{label:t,currentTime:n,onChangeTime:a,onTimeClear:r})}function F(e){var t=e.label,n=e.defaultTimezone;return React.createElement(x,null,P("advgb.timezoneControl",React.createElement(x,null,React.createElement("div",{className:"advgb-promo-overlay-area"},React.createElement("div",{className:"advgb-blur"},t,React.createElement(w,{value:n,options:[{label:n,value:n}],disabled:!0})),React.createElement("div",{class:"advgb-pro-overlay-wrap"},React.createElement("div",{class:"advgb-pro-small-overlay-text advgb-tooltips ppb-tooltips-library click","data-toggle":"ppbtooltip","data-placement":"top"},React.createElement("span",{class:"advgb-promo-text"},React.createElement("span",{class:"dashicons dashicons-lock",style:{color:"initial"}})," ",O("Pro feature","advanced-gutenberg")),React.createElement("span",{class:"tooltip-text"},React.createElement("p",null,O("PublishPress Blocks Pro supports Timezone configuration.","advanced-gutenberg")),React.createElement("p",null,React.createElement("a",{class:"clickable",href:"https://publishpress.com/links/blocks",target:"_blank"},O("Upgrade to Pro","advanced-gutenberg"))),React.createElement("i",null))))),React.createElement(React.Fragment,null)),e))}var N=function(e){return e.map((function(e){return e.title}))},M=function(e,t){var n=[];return null!==t&&(n=e.map((function(e){var n=t.find((function(t){return t.slug===e}));return void 0!==n&&n?n.title:e}))),n},I=function(e,t){var n=[];return e.map((function(e){var a=t.find((function(t){return t.title===e}));void 0!==a&&n.push(a.slug)})),n};function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){H(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e,t,n){return(t=W(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,W(a.key),a)}}function W(e){var t=function(e){if("object"!=z(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==z(t)?t:t+""}function G(e,t,n){return t=Y(t),function(e,t){if(t&&("object"==z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Z()?Reflect.construct(t,n||[],Y(e).constructor):t.apply(e,n))}function Z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Z=function(){return!!e})()}function Y(e){return Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Y(e)}function Q(e,t){return Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Q(e,t)}function V(){return V=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},V.apply(null,arguments)}function $(e){return function(e){if(Array.isArray(e))return J(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return J(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}!function(e,n,a,r,o,l,c){r=wp.blockEditor||wp.editor;var i=n.addFilter,s=e.sprintf,u=e.__,d=a.hasBlockSupport,g=r,b=g.InspectorControls,v=(g.BlockControls,o.DateTimePicker,o.ToggleControl),m=o.PanelBody,p=o.Notice,h=o.FormTokenField,f=o.SelectControl,y=o.TextControl,k=o.TextareaControl,C=(o.RadioControl,o.Button),_=o.TabPanel,w=o.Modal,E=l.createHigherOrderComponent,R=c.Component,x=c.Fragment;if(parseInt(advgbBlocks.block_controls)){var S=["core/freeform","core/legacy-widget","core/widget-area","core/column","advgb/tab","advgb/column"],T=function(){return void 0!==advgb_block_controls_vars.controls&&Object.keys(advgb_block_controls_vars.controls).length>0?advgb_block_controls_vars.controls:[]},O=function(e){return e&&(e.hasOwnProperty("dateFrom")||e.hasOwnProperty("dateTo")||e.hasOwnProperty("days")||e.hasOwnProperty("recurring"))},B=function(e){return void 0!==e&&e},P=function(e){var t=T(),n=0,a=[];return Object.keys(t).forEach((function(e){B(advgb_block_controls_vars.controls[e])&&a.push(e)})),a.forEach((function(t){z(e,t,"enabled")&&n++})),z(e,"presets","enabled")&&z(e,"presets","selected")&&z(e,"presets","selected").length>0&&n++,n>0},K=function(){var e=T(),t=0;return Object.keys(e).map((function(e){B(advgb_block_controls_vars.controls[e])&&t++})),t>0},z=function(e,t,n){if(void 0!==e&&e.length&&e.some((function(e){return e.control===t}))){var a=e.findIndex((function(e){return e.control===t}));if(a<0)return!1;var r=$(e)[a];return"schedule"===t?O(r)?"schedules"===n?[{dateFrom:r.dateFrom||null,dateTo:r.dateTo||null,recurring:r.recurring||!1,days:r.days||[],timeFrom:r.timeFrom||null,timeTo:r.timeTo||null,timezone:r.timezone||null}]:"enabled"===n?r.enabled||!1:r[n]:"schedules"===n?r.schedules||[]:"enabled"===n?r.enabled||!1:r.schedules&&r.schedules.length>0?r.schedules[0][n]:null:r[n]}return null},L=function(e){var t=e.index,n=e.schedule,a=e.onChange,r=e.onRemove,o=e.getTimezoneLabel,l=e.getTimezoneSlug,c=e.canRemove;return React.createElement("div",{style:{marginBottom:5,padding:5,border:"1px solid #ddd",borderRadius:4}},React.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16}},React.createElement("h4",null,s(u("Schedule #%d","advanced-gutenberg"),t+1)),c&&React.createElement(C,{isDestructive:!0,isLink:!0,onClick:r},u("Remove","advanced-gutenberg"))),React.createElement(A,{buttonLabel:u("Now","advanced-gutenberg"),dateLabel:u("Start showing","advanced-gutenberg"),date:n.dateFrom,onChangeDate:function(e){return a("dateFrom",e)},onDateClear:function(){return a("dateFrom",null)},onInvalidDate:!1}),React.createElement(A,{buttonLabel:u("Never","advanced-gutenberg"),dateLabel:u("Stop showing","advanced-gutenberg"),date:n.dateTo||null,onChangeDate:function(e){return a("dateTo",e)},onDateClear:function(){return a("dateTo",null)},onInvalidDate:function(e){if(n.dateFrom){var t=new Date(e.getTime());t.setHours(0,0,0,0);var a=new Date(n.dateFrom);return a.setHours(0,0,0,0),t.getTime()<a.getTime()}return!1}}),n.dateFrom&&n.dateTo&&React.createElement(v,{label:u("Recurring","advanced-gutenberg"),checked:n.recurring||!1,onChange:function(){return a("recurring",!n.recurring)},help:u("If Recurring is enabled, this block will be displayed every year between the selected dates.","advanced-gutenberg")}),React.createElement(j,{label:u("On these days (optional)","advanced-gutenberg"),days:n.days||[],onChangeDays:function(e){return a("days",e)}}),React.createElement("label",{style:{marginBottom:8,display:"block"}},u("Between these times (optional)","advanced-gutenberg")),React.createElement(D,{label:u("From","advanced-gutenberg"),currentTime:n.timeFrom||null,onChangeTime:function(e){return a("timeFrom",e)},onTimeClear:function(){return a("timeFrom",null)}}),React.createElement(D,{label:u("To","advanced-gutenberg"),currentTime:n.timeTo||null,onChangeTime:function(e){return a("timeTo",e)},onTimeClear:function(){return a("timeTo",null)}}),n.timeFrom&&n.timeTo&&"01/01/2020T"+n.timeFrom>="01/01/2020T"+n.timeTo&&React.createElement(p,{className:"advgb-notice-sidebar",status:"warning",isDismissible:!1},u('"To" time should be after "From" time!',"advanced-gutenberg")),React.createElement(F,{label:u("Timezone","advanced-gutenberg"),defaultTimezone:o(),value:n.timezone||l(),onChangeTimezone:function(e){return a("timezone",e)}}))};"undefined"!=typeof advgb_block_controls_vars&&void 0!==advgb_block_controls_vars.non_supported&&advgb_block_controls_vars.non_supported.length>0&&(S=[].concat($(S),$(advgb_block_controls_vars.non_supported)),S=$(new Set(S))),i("blocks.registerBlockType","advgb/blockControls",(function(e){return!S.includes(e.name)&&K()&&(e.attributes=V(e.attributes,{advgbBlockControls:{type:"array",items:{type:"object"},default:[]}})),e}));var W=E((function(e){return function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=G(this,n,[e])).state={taxModOptions:[],termOptions:[],searchTermWord:"",initArchive:!0,updateTaxLabels:!1},t.isPost=t.isPost.bind(t),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q(e,t)}(n,t),a=n,r=[{key:"getTermSlugs",value:function(e){var t=this,n=(this.getTaxonomies(),[]);return e.forEach((function(e){var a=t.getTaxonomies(),r=a.findIndex((function(t){return t.slug===e}));a[r].terms.forEach((function(e){n.push(e.slug)}))})),n}},{key:"getTaxonomies",value:function(){return void 0!==advgb_block_controls_vars.taxonomies&&advgb_block_controls_vars.taxonomies.length>0?advgb_block_controls_vars.taxonomies:[]}},{key:"getUserRoles",value:function(){return void 0!==advgb_block_controls_vars.user_roles&&advgb_block_controls_vars.user_roles.length>0?advgb_block_controls_vars.user_roles:[]}},{key:"getTerms",value:function(e){var t=this,n=(this.getTaxonomies(),[]);return e.forEach((function(e){var a=t.getTaxonomies(),r=a.findIndex((function(t){return t.slug===e}));a[r].terms.forEach((function(e){n.push({slug:e.slug,title:"".concat(e.title," (").concat(a[r].title,")")})}))})),n}},{key:"getPages",value:function(){return void 0!==advgb_block_controls_vars.page&&advgb_block_controls_vars.page.length>0?advgb_block_controls_vars.page:[]}},{key:"getBrowserOptions",value:function(){return[{slug:"chrome",title:"Chrome"},{slug:"firefox",title:"Firefox"},{slug:"safari",title:"Safari"},{slug:"edge",title:"Edge"},{slug:"opera",title:"Opera"},{slug:"internet explorer",title:"Internet Explorer"}]}},{key:"getOperatingSystemOptions",value:function(){return[{slug:"windows",title:"Windows"},{slug:"mac",title:"macOS"},{slug:"linux",title:"Linux"},{slug:"android",title:"Android"},{slug:"ios",title:"iOS"},{slug:"chrome os",title:"Chrome OS"}]}},{key:"getConditionOptions",value:function(){return[{label:"=",value:"="},{label:"!=",value:"!="},{label:"<",value:"<"},{label:">",value:">"},{label:"<=",value:"<="},{label:">=",value:">="},{label:"contains",value:"contains"},{label:"begins with",value:"beginsWith"},{label:"ends with",value:"endsWith"},{label:"does not contain",value:"doesNotContain"},{label:"does not begin with",value:"doesNotBeginWith"},{label:"does not end with",value:"doesNotEndWith"},{label:"is null",value:"null"},{label:"is not null",value:"notNull"},{label:"in",value:"in"},{label:"not in",value:"notIn"},{label:"between",value:"between"},{label:"not between",value:"notBetween"}]}},{key:"getCapabilitiesOptions",value:function(){return(void 0!==advgb_block_controls_vars.capabilities?advgb_block_controls_vars.capabilities:[]).map((function(e){return{slug:e,title:e.split("_").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" ")}}))}},{key:"changeControlKey",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=this.props,r=a.attributes,o=a.setAttributes,l=r.advgbBlockControls,c={control:"schedule",enabled:!0,schedules:[{dateFrom:null,dateTo:null,recurring:!1,days:[],timeFrom:null,timeTo:null,timezone:this.getTimezoneSlug()}]},i={control:"user_role",enabled:!0,roles:[],approach:"public"},s={control:"archive",enabled:!0,taxonomies:[],approach:"exclude"},u={control:"page",enabled:!0,pages:[],approach:"exclude"},d={control:"device_type",enabled:!0,devices:[]},g={control:"device_width",enabled:!0,min_width:"",max_width:""},b={control:"browser_device",enabled:!0,browsers:[],approach:"include"},v={control:"operating_system",enabled:!0,systems:[],approach:"include"},m={control:"cookie",enabled:!0,name:"",condition:"=",value:"",approach:"include"},p={control:"user_meta",enabled:!0,key:"",condition:"=",value:"",approach:"include"},h={control:"post_meta",enabled:!0,key:"",condition:"=",value:"",approach:"include"},f={control:"query_string",enabled:!0,queries:[],logic:"all",approach:"include"},y={control:"capabilities",enabled:!0,capabilities:[],approach:"include"},k={control:"presets",enabled:!0,selected:[],logic:"any"},C={control:"meta",activeTab:"custom"},_=!(void 0===l||!l.length),w=!(!_||!l.some((function(t){return t.control===e})));if(w){var E=l.findIndex((function(t){return t.control===e}));if(E<0)return!1;var R=$(l),x=R[E];if("schedule"===e){if(O(x)){var S={dateFrom:x.dateFrom||null,dateTo:x.dateTo||null,recurring:x.recurring||!1,days:x.days||[],timeFrom:x.timeFrom||null,timeTo:x.timeTo||null,timezone:x.timezone||this.getTimezoneSlug()};return R[E]={control:"schedule",enabled:x.enabled,schedules:[S]},"enabled"!==t&&"schedules"!==t?R[E].schedules[0][t]=n:R[E][t]=n,void o({advgbBlockControls:R})}if("schedules"===t)R[E]=q(q({},R[E]),{},{schedules:n});else if("enabled"===t)R[E]=q(q({},R[E]),{},{enabled:"boolean"==typeof n?n:!x.enabled});else{var T=$(x.schedules||[]);0===T.length&&T.push({dateFrom:null,dateTo:null,recurring:!1,days:[],timeFrom:null,timeTo:null,timezone:this.getTimezoneSlug()}),T[0][t]=n,R[E]=q(q({},R[E]),{},{schedules:T})}o({advgbBlockControls:R})}else R[E]="boolean"==typeof x[t]?q(q({},R[E]),{},H({},t,!x[t])):q(q({},R[E]),{},H({},t,n));o({advgbBlockControls:R})}else if(_&&!w){var B={};switch(e){case"schedule":B[e]=c;break;case"user_role":o({advgbBlockControls:[].concat($(l),[i])});break;case"archive":o({advgbBlockControls:[].concat($(l),[s])});break;case"page":o({advgbBlockControls:[].concat($(l),[u])});break;case"device_type":o({advgbBlockControls:[].concat($(l),[d])});break;case"device_width":o({advgbBlockControls:[].concat($(l),[g])});break;case"browser_device":o({advgbBlockControls:[].concat($(l),[b])});break;case"operating_system":o({advgbBlockControls:[].concat($(l),[v])});break;case"cookie":o({advgbBlockControls:[].concat($(l),[m])});break;case"user_meta":o({advgbBlockControls:[].concat($(l),[p])});break;case"post_meta":o({advgbBlockControls:[].concat($(l),[h])});break;case"query_string":o({advgbBlockControls:[].concat($(l),[f])});break;case"capabilities":o({advgbBlockControls:[].concat($(l),[y])});break;case"presets":o({advgbBlockControls:[].concat($(l),[k])});break;case"meta":o({advgbBlockControls:[].concat($(l),[C])})}B[e]&&o({advgbBlockControls:[].concat($(l),[B[e]])})}else{var P={};switch(e){case"schedule":P[e]=c;break;case"user_role":o({advgbBlockControls:[i]});break;case"archive":o({advgbBlockControls:[s]});break;case"page":o({advgbBlockControls:[u]});break;case"device_type":o({advgbBlockControls:[d]});break;case"device_width":o({advgbBlockControls:[g]});break;case"browser_device":o({advgbBlockControls:[b]});break;case"operating_system":o({advgbBlockControls:[v]});break;case"cookie":o({advgbBlockControls:[m]});break;case"user_meta":o({advgbBlockControls:[p]});break;case"post_meta":o({advgbBlockControls:[h]});break;case"query_string":o({advgbBlockControls:[f]});break;case"capabilities":o({advgbBlockControls:[y]});break;case"presets":o({advgbBlockControls:[k]});break;case"meta":o({advgbBlockControls:[C]})}P[e]&&o({advgbBlockControls:[P[e]]})}}},{key:"changeArchiveControl",value:function(e,t){var n=this,a=this.props,r=a.attributes,o=a.setAttributes,l=r.advgbBlockControls,c=[],i=l.findIndex((function(e){return"archive"===e.control}));if(i<0)return!1;var s=$(l);if("taxonomies"===e)t.forEach((function(e){var t=s[i].taxonomies.findIndex((function(t){return t.tax===e}));if(-1===t)c.push({tax:e,terms:[],all:!0});else{var n=s[i].taxonomies[t].terms.length?s[i].taxonomies[t].terms:[];n.length,c.push({tax:e,terms:n,all:!n.length})}})),s[i]=q(q({},s[i]),{},H({},"taxonomies",c)),o({advgbBlockControls:s});else if("terms"===e){var u={},d=this.currentArchiveControl("taxonomies");t.forEach((function(e){var t=n.state.termOptions.find((function(t){return t.slug===e}));void 0===u[t.tax]&&(u[t.tax]=[]),s[i].taxonomies.findIndex((function(e){return e.tax===t.tax})),d.includes(t.tax)&&u[t.tax].push(e)})),Object.keys(u).forEach((function(e){var t=s[i].taxonomies.findIndex((function(t){return t.tax===e}));t>=0&&(s[i].taxonomies[t]={tax:e,terms:u[e],all:!u[e].length})})),d.forEach((function(e){if(!Object.keys(u).includes(e)){var t=s[i].taxonomies.findIndex((function(t){return t.tax===e}));t>=0&&(s[i].taxonomies[t]={tax:e,terms:[],all:!0})}})),o({advgbBlockControls:s})}}},{key:"currentArchiveControl",value:function(e){var t=this.props,n=t.attributes,a=(t.setAttributes,n.advgbBlockControls),r=[],o=z(a,"archive","taxonomies").length?z(a,"archive","taxonomies"):[];return"taxonomies"===e?o.forEach((function(e){r.push(e.tax)})):"terms"===e&&o.forEach((function(e){e.terms.forEach((function(e){r.push(e)}))})),r}},{key:"taxonomiesChanged",value:function(){var e=this,t=this.props.attributes.advgbBlockControls,n=z(t,"archive","terms")?z(t,"archive","terms"):[],a=z(t,"archive","taxonomies")?z(t,"archive","taxonomies"):[];if(n.length){var r=[];n.forEach((function(t){var n=e.state.termOptions.findIndex((function(e){return e.slug===t}));a.includes(e.state.termOptions[n].tax)&&r.push(e.state.termOptions[n].slug)})),this.changeControlKey("archive","terms",r)}this.setState({termOptions:this.state.termOptions.filter((function(t){return e.currentArchiveControl("taxonomies").includes(t.tax)}))}),this.modifyTaxLabels()}},{key:"initArchiveControl",value:function(){var e=this;this.props.attributes.advgbBlockControls,wp.apiFetch({path:wp.url.addQueryArgs("advgb/v1/terms",{taxonomies:this.currentArchiveControl("taxonomies"),ids:this.currentArchiveControl("terms")})}).then((function(t){e.modifyTaxLabels(),e.setState({termOptions:t,initArchive:!1,updateTaxLabels:!1})}))}},{key:"iniTaxLabels",value:function(){var e=[];return this.getTaxonomies().forEach((function(t){e.push({slug:t.slug,title:s(u("All %s terms","advanced-gutenberg"),t.title),singular:t.title})})),e}},{key:"modifyTaxLabels",value:function(){var e=this.props.attributes.advgbBlockControls,t=z(e,"archive","taxonomies").length?z(e,"archive","taxonomies"):[],n=$(this.state.taxModOptions);n.forEach((function(e,a){var r=t.find((function(t){return e.slug===t.tax})),o=q({},n[a]);o.title=s(void 0!==r&&r.terms.length?u("Selected %s terms","advanced-gutenberg"):u("All %s terms","advanced-gutenberg"),o.singular),n[a]=o})),this.setState({taxModOptions:n,updateTaxLabels:!1})}},{key:"searchTerms",value:function(){var e=this,t=this.state,n=t.termOptions,a=t.searchTermWord;this.props.attributes.advgbBlockControls,wp.apiFetch({path:wp.url.addQueryArgs("advgb/v1/terms",{search:a,taxonomies:this.currentArchiveControl("taxonomies")})}).then((function(t){var a=[].concat($(n),$(t));a=Array.from(new Set(a.map((function(e){return e.slug})))).map((function(e){return a.find((function(t){return t.slug===e}))})),e.setState({termOptions:a})}))}},{key:"isPost",value:function(){var e=wp.data.select("core/editor");if(!e)return!1;var t=e.getCurrentPostId();return!!t&&"number"==typeof t}},{key:"getTimezoneLabel",value:function(){return void 0!==advgbBlocks.timezone&&advgbBlocks.timezone.length?advgbBlocks.timezone.replace(/_/g," "):u("WordPress settings timezone","advanced-gutenberg")}},{key:"getTimezoneSlug",value:function(){return void 0!==advgbBlocks.timezone&&advgbBlocks.timezone.length?advgbBlocks.timezone:"UTC"}},{key:"renderTabContent",value:function(e){var t=this.props.attributes.advgbBlockControls;switch(e){case"custom":return this.renderCustomControls(t);case"presets":return this.renderPresetControls(t);default:return null}}},{key:"componentDidMount",value:function(){var e=this;this.setState({taxModOptions:this.iniTaxLabels()}),window.AdvGBPresetData&&(this.presetDataSubscription=function(t){e.forceUpdate()},window.AdvGBPresetData.subscribe(this.presetDataSubscription))}},{key:"componentWillUnmount",value:function(){window.AdvGBPresetData&&this.presetDataSubscription&&window.AdvGBPresetData.unsubscribe(this.presetDataSubscription)}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,a=n.attributes,r=n.isSelected,o=n.name,l=a.advgbBlockControls,c=e.attributes.advgbBlockControls,i=this.state,s=i.searchTermWord,u=i.initArchive,d=t.searchTermWord;!this.isPost()&&!S.includes(o)&&r&&u&&B(advgb_block_controls_vars.controls.archive)&&z(l,"archive","enabled")&&this.currentArchiveControl("taxonomies").length&&this.currentArchiveControl("terms").length&&this.initArchiveControl(),s!==d&&s.length>2&&this.searchTerms(),!this.isPost()&&B(advgb_block_controls_vars.controls.archive)&&z(l,"archive","enabled")&&(z(c,"archive","taxonomies")!==z(l,"archive","taxonomies")||this.state.updateTaxLabels)&&this.taxonomiesChanged()}},{key:"renderCustomControls",value:function(e){var t=this,n=z(e,"query_string","queries"),a=Array.isArray(n)?n.join("\n"):n||"";return React.createElement(x,null,B(advgb_block_controls_vars.controls.schedule)&&React.createElement(x,null,React.createElement(v,{label:u("Schedule","advanced-gutenberg"),help:z(e,"schedule","enabled")?u("Choose when to start showing and/or stop showing this block.","advanced-gutenberg"):"",checked:z(e,"schedule","enabled"),onChange:function(){return t.changeControlKey("schedule","enabled")}}),z(e,"schedule","enabled")&&React.createElement(x,null,(z(e,"schedule","schedules")||[]).map((function(n,a){return React.createElement(L,{key:a,index:a,schedule:n,onChange:function(n,r){var o=$(z(e,"schedule","schedules")||[]);o[a][n]=r,t.changeControlKey("schedule","schedules",o)},onRemove:function(){var n=$(z(e,"schedule","schedules")||[]);n.length>1&&(n.splice(a,1),t.changeControlKey("schedule","schedules",n))},getTimezoneLabel:t.getTimezoneLabel,getTimezoneSlug:t.getTimezoneSlug,canRemove:(z(e,"schedule","schedules")||[]).length>1})})),React.createElement("div",{style:{marginBottom:16}},React.createElement(C,{style:{width:"100%",display:"block"},isSecondary:!0,onClick:function(){var n=z(e,"schedule","schedules")||[],a={dateFrom:null,dateTo:null,recurring:!1,days:[],timeFrom:null,timeTo:null,timezone:t.getTimezoneSlug()};t.changeControlKey("schedule","schedules",[].concat($(n),[a]))}},u("Add Another Schedule","advanced-gutenberg"))))),B(advgb_block_controls_vars.controls.user_role)&&React.createElement(x,null,React.createElement(v,{label:u("User roles","advanced-gutenberg"),help:z(e,"user_role","enabled")?u("Choose which users can see this block.","advanced-gutenberg"):"",checked:z(e,"user_role","enabled"),onChange:function(){return t.changeControlKey("user_role","enabled")}}),z(e,"user_role","enabled")&&React.createElement(x,null,React.createElement("div",{className:"advgb-revert-mb"},React.createElement(f,{value:z(e,"user_role","approach"),options:[{value:"public",label:u("Show to everyone","advanced-gutenberg")},{value:"hidden",label:u("Hide from everyone","advanced-gutenberg")},{value:"login",label:u("Show to logged in users","advanced-gutenberg")},{value:"logout",label:u("Show to logged out users","advanced-gutenberg")},{value:"include",label:u("Show to the selected user roles","advanced-gutenberg")},{value:"exclude",label:u("Hide from the selected user roles","advanced-gutenberg")}],onChange:function(e){return t.changeControlKey("user_role","approach",e)}})),("include"===z(e,"user_role","approach")||"exclude"===z(e,"user_role","approach"))&&React.createElement(x,null,React.createElement(h,{multiple:!0,label:u("Select user roles","advanced-gutenberg"),placeholder:u("Search","advanced-gutenberg"),suggestions:N(this.getUserRoles()),maxSuggestions:10,value:M(z(e,"user_role","roles")?z(e,"user_role","roles"):[],this.getUserRoles()),onChange:function(e){t.changeControlKey("user_role","roles",I(e,t.getUserRoles()))},__experimentalExpandOnFocus:!0}),("include"===z(e,"user_role","approach")||"exclude"===z(e,"user_role","approach"))&&!z(e,"user_role","roles").length&&React.createElement(p,{className:"advgb-notice-sidebar",status:"warning",isDismissible:!1,style:{marginBottom:30}},u("Please select at least one user role.","advanced-gutenberg"))))),B(advgb_block_controls_vars.controls.device_width)&&React.createElement(x,null,React.createElement(v,{label:u("Device Width","advanced-gutenberg"),help:z(e,"device_width","enabled")?u("Set minimum and maximum screen widths for this block to display.","advanced-gutenberg"):"",checked:z(e,"device_width","enabled"),onChange:function(){return t.changeControlKey("device_width","enabled")}}),z(e,"device_width","enabled")&&React.createElement(x,null,React.createElement(y,{type:"number",label:u("Minimum width (px)","advanced-gutenberg"),value:z(e,"device_width","min_width")||"",onChange:function(e){return t.changeControlKey("device_width","min_width",e)},placeholder:u("No minimum","advanced-gutenberg")}),React.createElement(y,{type:"number",label:u("Maximum width (px)","advanced-gutenberg"),value:z(e,"device_width","max_width")||"",onChange:function(e){return t.changeControlKey("device_width","max_width",e)},placeholder:u("No maximum","advanced-gutenberg")}))),B(advgb_block_controls_vars.controls.device_type)&&React.createElement(x,null,React.createElement(v,{label:u("Device Type","advanced-gutenberg"),help:z(e,"device_type","enabled")?u("Choose which devices this block should be visible on.","advanced-gutenberg"):"",checked:z(e,"device_type","enabled"),onChange:function(){return t.changeControlKey("device_type","enabled")}}),z(e,"device_type","enabled")&&React.createElement(x,null,React.createElement("div",{style:{paddingLeft:"17%"}},React.createElement(v,{label:u("Desktop","advanced-gutenberg"),checked:z(e,"device_type","devices").includes("desktop"),onChange:function(){var n=z(e,"device_type","devices"),a=n.includes("desktop")?n.filter((function(e){return"desktop"!==e})):[].concat($(n),["desktop"]);t.changeControlKey("device_type","devices",a)}}),React.createElement(v,{label:u("Tablet","advanced-gutenberg"),checked:z(e,"device_type","devices").includes("tablet"),onChange:function(){var n=z(e,"device_type","devices"),a=n.includes("tablet")?n.filter((function(e){return"tablet"!==e})):[].concat($(n),["tablet"]);t.changeControlKey("device_type","devices",a)}}),React.createElement(v,{label:u("Mobile","advanced-gutenberg"),checked:z(e,"device_type","devices").includes("mobile"),onChange:function(){var n=z(e,"device_type","devices"),a=n.includes("mobile")?n.filter((function(e){return"mobile"!==e})):[].concat($(n),["mobile"]);t.changeControlKey("device_type","devices",a)}}),React.createElement(v,{label:u("Bot","advanced-gutenberg"),checked:z(e,"device_type","devices").includes("robot"),onChange:function(){var n=z(e,"device_type","devices"),a=n.includes("robot")?n.filter((function(e){return"robot"!==e})):[].concat($(n),["robot"]);t.changeControlKey("device_type","devices",a)}})))),B(advgb_block_controls_vars.controls.browser_device)&&React.createElement(x,null,React.createElement(v,{label:u("Browser","advanced-gutenberg"),help:z(e,"browser_device","enabled")?u("Choose which browsers can see this block.","advanced-gutenberg"):"",checked:z(e,"browser_device","enabled"),onChange:function(){return t.changeControlKey("browser_device","enabled")}}),z(e,"browser_device","enabled")&&React.createElement(x,null,React.createElement(h,{multiple:!0,label:u("Select Browsers","advanced-gutenberg"),placeholder:u("Search browsers","advanced-gutenberg"),suggestions:N(this.getBrowserOptions()),maxSuggestions:10,value:M(z(e,"browser_device","browsers")||[],this.getBrowserOptions()),onChange:function(e){t.changeControlKey("browser_device","browsers",I(e,t.getBrowserOptions()))},__experimentalExpandOnFocus:!0}),React.createElement(f,{label:u("Approach","advanced-gutenberg"),value:z(e,"browser_device","approach"),options:[{label:u("Show to selected browsers","advanced-gutenberg"),value:"include"},{label:u("Hide from selected browsers","advanced-gutenberg"),value:"exclude"}],onChange:function(e){return t.changeControlKey("browser_device","approach",e)}}))),B(advgb_block_controls_vars.controls.operating_system)&&React.createElement(x,null,React.createElement(v,{label:u("Operating System","advanced-gutenberg"),help:z(e,"operating_system","enabled")?u("Choose which operating systems can see this block.","advanced-gutenberg"):"",checked:z(e,"operating_system","enabled"),onChange:function(){return t.changeControlKey("operating_system","enabled")}}),z(e,"operating_system","enabled")&&React.createElement(x,null,React.createElement(h,{multiple:!0,label:u("Select Operating Systems","advanced-gutenberg"),placeholder:u("Search operating systems","advanced-gutenberg"),suggestions:N(this.getOperatingSystemOptions()),maxSuggestions:10,value:M(z(e,"operating_system","systems")||[],this.getOperatingSystemOptions()),onChange:function(e){t.changeControlKey("operating_system","systems",I(e,t.getOperatingSystemOptions()))},__experimentalExpandOnFocus:!0}),React.createElement(f,{label:u("Approach","advanced-gutenberg"),value:z(e,"operating_system","approach"),options:[{label:u("Show to selected OS","advanced-gutenberg"),value:"include"},{label:u("Hide from selected OS","advanced-gutenberg"),value:"exclude"}],onChange:function(e){return t.changeControlKey("operating_system","approach",e)}}))),B(advgb_block_controls_vars.controls.cookie)&&React.createElement(x,null,React.createElement(v,{label:u("Cookie","advanced-gutenberg"),help:z(e,"cookie","enabled")?u("Show or hide block based on cookie values.","advanced-gutenberg"):"",checked:z(e,"cookie","enabled"),onChange:function(){return t.changeControlKey("cookie","enabled")}}),z(e,"cookie","enabled")&&React.createElement(x,null,React.createElement(y,{label:u("Cookie Name","advanced-gutenberg"),value:z(e,"cookie","name")||"",onChange:function(e){return t.changeControlKey("cookie","name",e)}}),React.createElement(f,{label:u("Condition","advanced-gutenberg"),value:z(e,"cookie","condition")||"=",options:this.getConditionOptions(),onChange:function(e){return t.changeControlKey("cookie","condition",e)}}),React.createElement(y,{label:u("Value","advanced-gutenberg"),value:z(e,"cookie","value")||"",onChange:function(e){return t.changeControlKey("cookie","value",e)}}),React.createElement(f,{label:u("Approach","advanced-gutenberg"),value:z(e,"cookie","approach"),options:[{label:u("Show block when condition matches","advanced-gutenberg"),value:"include"},{label:u("Hide block when condition matches","advanced-gutenberg"),value:"exclude"}],onChange:function(e){return t.changeControlKey("cookie","approach",e)}}))),B(advgb_block_controls_vars.controls.user_meta)&&React.createElement(x,null,React.createElement(v,{label:u("User Meta","advanced-gutenberg"),help:z(e,"user_meta","enabled")?u("Show or hide block based on user meta values.","advanced-gutenberg"):"",checked:z(e,"user_meta","enabled"),onChange:function(){return t.changeControlKey("user_meta","enabled")}}),z(e,"user_meta","enabled")&&React.createElement(x,null,React.createElement(y,{label:u("Meta Key","advanced-gutenberg"),value:z(e,"user_meta","key")||"",onChange:function(e){return t.changeControlKey("user_meta","key",e)}}),React.createElement(f,{label:u("Condition","advanced-gutenberg"),value:z(e,"user_meta","condition")||"=",options:this.getConditionOptions(),onChange:function(e){return t.changeControlKey("user_meta","condition",e)}}),React.createElement(y,{label:u("Value","advanced-gutenberg"),value:z(e,"user_meta","value")||"",onChange:function(e){return t.changeControlKey("user_meta","value",e)}}),React.createElement(f,{label:u("Approach","advanced-gutenberg"),value:z(e,"user_meta","approach"),options:[{label:u("Show block when condition matches","advanced-gutenberg"),value:"include"},{label:u("Hide block when condition matches","advanced-gutenberg"),value:"exclude"}],onChange:function(e){return t.changeControlKey("user_meta","approach",e)}}))),B(advgb_block_controls_vars.controls.post_meta)&&React.createElement(x,null,React.createElement(v,{label:u("Post Meta","advanced-gutenberg"),help:z(e,"post_meta","enabled")?u("Show or hide block based on post meta values.","advanced-gutenberg"):"",checked:z(e,"post_meta","enabled"),onChange:function(){return t.changeControlKey("post_meta","enabled")}}),z(e,"post_meta","enabled")&&React.createElement(x,null,React.createElement(y,{label:u("Meta Key","advanced-gutenberg"),value:z(e,"post_meta","key")||"",onChange:function(e){return t.changeControlKey("post_meta","key",e)}}),React.createElement(f,{label:u("Condition","advanced-gutenberg"),value:z(e,"post_meta","condition")||"=",options:this.getConditionOptions(),onChange:function(e){return t.changeControlKey("post_meta","condition",e)}}),React.createElement(y,{label:u("Value","advanced-gutenberg"),value:z(e,"post_meta","value")||"",onChange:function(e){return t.changeControlKey("post_meta","value",e)}}),React.createElement(f,{label:u("Approach","advanced-gutenberg"),value:z(e,"post_meta","approach"),options:[{label:u("Show block when condition matches","advanced-gutenberg"),value:"include"},{label:u("Hide block when condition matches","advanced-gutenberg"),value:"exclude"}],onChange:function(e){return t.changeControlKey("post_meta","approach",e)}}))),B(advgb_block_controls_vars.controls.query_string)&&React.createElement(x,null,React.createElement(v,{label:u("Query String","advanced-gutenberg"),help:z(e,"query_string","enabled")?u("Show or hide block based on URL query parameters.","advanced-gutenberg"):"",checked:z(e,"query_string","enabled"),onChange:function(){return t.changeControlKey("query_string","enabled")}}),z(e,"query_string","enabled")&&React.createElement(x,null,React.createElement(k,{label:u("Query Parameters","advanced-gutenberg"),help:u("Enter query parameter names, one per line","advanced-gutenberg"),value:a,onChange:function(e){t.changeControlKey("query_string","queries",e)},placeholder:u("utm_source\nutm_medium\nref","advanced-gutenberg")}),React.createElement(f,{label:u("Logic","advanced-gutenberg"),value:z(e,"query_string","logic")||"all",options:[{label:u("All parameters must be present","advanced-gutenberg"),value:"all"},{label:u("Any parameter must be present","advanced-gutenberg"),value:"any"}],onChange:function(e){return t.changeControlKey("query_string","logic",e)}}),React.createElement(f,{label:u("Approach","advanced-gutenberg"),value:z(e,"query_string","approach"),options:[{label:u("Show block when condition matches","advanced-gutenberg"),value:"include"},{label:u("Hide block when condition matches","advanced-gutenberg"),value:"exclude"}],onChange:function(e){return t.changeControlKey("query_string","approach",e)}}))),B(advgb_block_controls_vars.controls.capabilities)&&React.createElement(x,null,React.createElement(v,{label:u("Capabilities","advanced-gutenberg"),help:z(e,"capabilities","enabled")?u("Show or hide block based on user capabilities.","advanced-gutenberg"):"",checked:z(e,"capabilities","enabled"),onChange:function(){return t.changeControlKey("capabilities","enabled")}}),z(e,"capabilities","enabled")&&React.createElement(x,null,React.createElement(h,{multiple:!0,label:u("Select Capabilities","advanced-gutenberg"),placeholder:u("Search capabilities","advanced-gutenberg"),suggestions:N(this.getCapabilitiesOptions()),maxSuggestions:10,value:M(z(e,"capabilities","capabilities")||[],this.getCapabilitiesOptions()),onChange:function(e){t.changeControlKey("capabilities","capabilities",I(e,t.getCapabilitiesOptions()))},__experimentalExpandOnFocus:!0}),React.createElement(f,{label:u("Approach","advanced-gutenberg"),value:z(e,"capabilities","approach"),options:[{label:u("Show to users with selected capabilities","advanced-gutenberg"),value:"include"},{label:u("Hide from users with selected capabilities","advanced-gutenberg"),value:"exclude"}],onChange:function(e){return t.changeControlKey("capabilities","approach",e)}}))),!this.isPost()&&React.createElement(x,null,B(advgb_block_controls_vars.controls.archive)&&React.createElement(x,null,React.createElement(v,{label:u("Term archives","advanced-gutenberg"),help:z(e,"archive","enabled")?u("Choose on which taxonomies and terms archive pages your blocks can be displayed.","advanced-gutenberg"):"",checked:z(e,"archive","enabled"),onChange:function(){return t.changeControlKey("archive","enabled")}}),z(e,"archive","enabled")&&React.createElement(x,null,React.createElement("div",{className:"advgb-revert-mb--disabled",style:{marginBottom:20}},React.createElement(f,{value:z(e,"archive","approach"),options:[{value:"include",label:u("Show for selected terms","advanced-gutenberg")},{value:"exclude",label:u("Hide for selected terms","advanced-gutenberg")}],onChange:function(e){return t.changeControlKey("archive","approach",e)}})),React.createElement(h,{multiple:!0,label:u("Select taxonomies","advanced-gutenberg"),placeholder:u("Search taxonomies","advanced-gutenberg"),suggestions:N(this.state.taxModOptions||this.getTaxonomies()),maxSuggestions:10,value:M(this.currentArchiveControl("taxonomies"),this.state.taxModOptions||this.getTaxonomies()),onChange:function(e){t.changeArchiveControl("taxonomies",I(e,t.state.taxModOptions||t.getTaxonomies()))},__experimentalExpandOnFocus:!0}),z(e,"archive","taxonomies").length>0&&React.createElement(x,null,React.createElement(h,{multiple:!0,label:u("Filter terms","advanced-gutenberg"),placeholder:u("Search terms","advanced-gutenberg"),suggestions:N(this.state.termOptions),maxSuggestions:10,value:M(this.currentArchiveControl("terms"),this.state.termOptions),onChange:function(e){t.changeArchiveControl("terms",I(e,t.state.termOptions)),t.setState({updateTaxLabels:!0})},onInputChange:function(e){t.setState({searchTermWord:e})},__experimentalShowHowTo:!1}),React.createElement("div",{className:"advgb-revert-mb--disabled components-form-token-field__help",style:{marginBottom:20}},u("Use this filter to apply only to some terms.","advanced-gutenberg"))))),B(advgb_block_controls_vars.controls.page)&&React.createElement(x,null,React.createElement(v,{label:u("Pages","advanced-gutenberg"),help:z(e,"page","enabled")?u("Choose in which pages this block can be displayed.","advanced-gutenberg"):"",checked:z(e,"page","enabled"),onChange:function(){return t.changeControlKey("page","enabled")}}),z(e,"page","enabled")&&React.createElement(x,null,React.createElement("div",{className:"advgb-revert-mb"},React.createElement(f,{value:z(e,"page","approach"),options:[{value:"include",label:u("Show on the selected pages","advanced-gutenberg")},{value:"exclude",label:u("Hide on the selected pages","advanced-gutenberg")}],onChange:function(e){return t.changeControlKey("page","approach",e)}})),("include"===z(e,"page","approach")||"exclude"===z(e,"page","approach"))&&React.createElement(h,{multiple:!0,label:u("Select pages","advanced-gutenberg"),placeholder:u("Search","advanced-gutenberg"),suggestions:N(this.getPages()),maxSuggestions:10,value:M(z(e,"page","pages")?z(e,"page","pages"):[],this.getPages()),onChange:function(e){t.changeControlKey("page","pages",I(e,t.getPages()))},__experimentalExpandOnFocus:!0})))))}},{key:"renderPresetControls",value:function(e){var t=this;return React.createElement(x,null,React.createElement("div",{className:"advgb-preset-buttons"},React.createElement(C,{isPrimary:!0,onClick:function(){t.setState({showPresetModal:!0,modalMode:"create"})}},u("Manage Presets","advanced-gutenberg"))),React.createElement(h,{multiple:!0,label:u("Select Presets","advanced-gutenberg"),placeholder:u("Search presets","advanced-gutenberg"),suggestions:N(this.getPresetOptions()),maxSuggestions:10,value:M(z(e,"presets","selected")||[],this.getPresetOptions()),onChange:function(e){t.changeControlKey("presets","selected",I(e,t.getPresetOptions())),t.props.attributes.advgbBlockControls.find((function(e){return"presets"===e.control}))||t.changeControlKey("presets","enabled",!0)},__experimentalExpandOnFocus:!0}),React.createElement(f,{label:u("Preset Logic","advanced-gutenberg"),value:z(e,"presets","logic")||"any",options:[{label:u("Show if ANY preset matches","advanced-gutenberg"),value:"any"},{label:u("Show if ALL presets match","advanced-gutenberg"),value:"all"}],onChange:function(e){return t.changeControlKey("presets","logic",e)}}),this.state.showPresetModal&&this.renderPresetModal())}},{key:"renderPresetModal",value:function(){var e=this;return React.createElement(w,{title:"",onRequestClose:function(){return e.setState({showPresetModal:!1})},className:"advgb-preset-modal",isDismissible:!0,isFullScreen:!0,shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!0},window.AdvGBPresetManager&&wp.element.createElement(window.AdvGBPresetManager,{isModal:!1}))}},{key:"getPresetOptions",value:function(){return(window.AdvGBPresetData?window.AdvGBPresetData.getAllPresets():[]).map((function(e){return{slug:e.id,title:e.title}}))}},{key:"getActiveTab",value:function(){var e=this.props.attributes.advgbBlockControls;return z(e,"meta","activeTab")||"custom"}},{key:"setActiveTab",value:function(e){this.changeControlKey("meta","activeTab",e)}},{key:"render",value:function(){var t=this,n=this.props,a=n.attributes,r=(n.setAttributes,a.advgbBlockControls);return[this.props.isSelected&&!S.includes(this.props.name)&&K()&&React.createElement(b,{key:"advgb-bc-controls"},React.createElement(m,{title:u("Block Controls","advanced-gutenberg"),icon:"visibility",initialOpen:!1,className:P(r)?"advgb-feature-icon-active":""},React.createElement(_,{className:"advgb-block-controls-tabs",activeClass:"active-tab",initialTabName:this.getActiveTab(),onSelect:function(e){return t.setActiveTab(e)},tabs:[{name:"custom",title:u("Custom Rules","advanced-gutenberg"),className:"tab-custom"},{name:"presets",title:u("Presets","advanced-gutenberg"),className:"tab-presets"}]},(function(e){return t.renderTabContent(e.name)})))),React.createElement(e,V({key:"block-edit-advgb-dates"},this.props))]}}],r&&U(a.prototype,r),Object.defineProperty(a,"prototype",{writable:!1}),a;var a,r}(R)}),"withEditControls");i("editor.BlockEdit","advgb/addBlockControls",W),i("editor.BlockListBlock","advgb/loadBackendBlockControls",E((function(e){return function(n){if(!S.includes(n.name)&&d(n.name,"advgb/blockControls",!0)&&K()){var a=n.attributes.advgbBlockControls,r=!1===n.isSelected&&P(a)?"advgb-bc-editor-preview":"";return React.createElement(e,V({},n,{className:t()(n.className,r),advgbBlockControls:"".concat(a)}))}return React.createElement(e,n)}}),"withAttributes"))}}(wp.i18n,wp.hooks,wp.blocks,wp.blockEditor,wp.components,wp.compose,wp.element)})()})();
//# sourceMappingURL=block-controls.js.map