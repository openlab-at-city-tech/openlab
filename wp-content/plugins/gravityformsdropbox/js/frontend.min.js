window.GFDropbox=null,function(n){GFDropbox=function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);var s=this;this.init=function(){this.createDropboxButton(),this.refreshPreview(),this.setupPreviewBind()},this.createDropboxButton=function(){var e=Dropbox.createChooseButton({extensions:this.extensions,linkType:this.linkType,multiselect:this.multiselect,success:this.uploadHandler});document.querySelector("#field_"+this.formId+"_"+this.inputId+" .ginput_container").appendChild(e)},this.getFieldValue=function(){var e=document.getElementById("input_"+this.formId+"_"+this.inputId).value||[];try{return e?JSON.parse(e):[]}catch(e){return[]}},this.getFileName=function(e){return e.split("/").pop().split("?dl=").shift()},this.refreshPreview=function(){var e=document.getElementById("gform_preview_"+this.formId+"_"+this.inputId),t=s.getFieldValue();for(e.innerHTML="",i=0;i<t.length;i++){var n=this.getFileName(t[i]);html='<div class="ginput_preview">',html+='<img class="gform_delete" src="'+this.deleteImage+'" alt="'+this.deleteText+'" title="'+this.deleteText+'" data-file="'+n+'" /> ',html+="<strong>"+n+"</strong>",html+="</div>",e.innerHTML+=html}},this.removeFile=function(e){var t=this.getFieldValue();for(i=0;i<t.length;i++){this.getFileName(t[i])===e&&t.splice(i,1)}this.setFieldValue(t),this.refreshPreview()},this.setFieldValue=function(e){document.getElementById("input_"+this.formId+"_"+this.inputId).value=JSON.stringify(e)},this.setupPreviewBind=function(){var e=n("#gform_preview_"+this.formId+"_"+this.inputId);n(e).on("click",".ginput_preview img",function(){s.removeFile(n(this).attr("data-file"))})},this.uploadHandler=function(e){var t=s.getFieldValue()&&s.multiselect?s.getFieldValue():[];for(i=0;i<e.length;i++)t.push(e[i].link);s.setFieldValue(t),s.refreshPreview()},this.init()}}(jQuery);