"use strict";jQuery(function(s){s("select.select2").select2(),s("label.tooltip, span.tooltip").tooltip();function e(){"text"===a.val()&&(l.show(),i.attr("required","required"),o.removeAttr("required"),0<s.trim(i.val()).length?(i.css({"border-color":"","border-width":""}),n.val(""),d.prop("disabled",!1).html("Refresh preview image")):(i.css({"border-color":"red","border-width":"1px"}),d.prop("disabled",!0).html("Enter watermark text..."),n.val("Watermark text is a required field.")))}function r(){"image"===a.val()&&(l.show(),o.attr("required","required"),i.removeAttr("required"),""!==o.val()?(d.prop("disabled",!1).html("Refresh preview image"),o.css({"border-color":"","border-width":""}),n.val("")):(d.prop("disabled",!0).html("Enter watermark image URL..."),o.css({"border-color":"red","border-width":"1px"}),n.val("Watermark URL is a required field.")))}function t(e){s(".watermark_field").each(function(){"show"===e?s(this).fadeIn().removeClass("hidden"):s(this).fadeOut().addClass("hidden")})}var a=s("#watermark_source"),i=s("#watermark_text"),o=s("#watermark_image_url"),l=s("#watermark_customization"),d=s("#nextgen_settings_preview_refresh"),n=s("#ngg_errors_in_tab");s("#lightbox_library").on("change",function(){var e="lightbox_library_"+s(this).find(":selected").val();s(".lightbox_library_settings").each(function(){s(this).attr("id")!=e&&s(this).fadeOut("fast")}),s("#"+e).fadeIn()}).trigger("change"),l.attr("rel","watermark_"+a.val()+"_source"),a.on("change",function(){s("#"+l.attr("rel")).css("display","").addClass("hidden"),s("#"+s(this).val()).hasClass("hidden")||s("#"+s(this).val()).removeClass("hidden"),l.attr("rel","watermark_"+a.val()+"_source").trigger("click")});a.on("change",function(){switch(s(this).val()){case"text":t("show"),e();break;case"image":t("show"),r();break;default:t("hide")}}).trigger("change"),i.on("blur",function(){e()}),o.on("blur",function(){r()}),d.on("click",function(e){e.preventDefault();var e=s(this).parents("form:first"),a=s(this),i=s(a).html();return s(a).attr("disabled","disabled").html("Processing..."),s("body").css("cursor","wait"),s.ajax({type:e.attr("method"),url:s(this).data("refresh-url"),data:e.serialize()+"&action=get_watermark_preview_url",dataType:"json",success:function(e){var r=a.prev(),e=e.thumbnail_url;-1!=(queryPos=e.indexOf("?"))&&(e=e.substring(0,queryPos)),r.attr("src",e+"?"+(new Date).getTime()),s(a).prop("disabled",!1).html(i),s("body").css("cursor","default")},error:function(e,r,t){s(a).prop("disabled",!1).html(i),s("body").css("cursor","default")}}),!1})});