!function(l,a){function d(l){return ngg_plupload.translate(l)||l}function e(a,e){e.contents().each(function(a,d){d=l(d),d.is(".plupload")||d.remove()}),e.prepend('<div class="plupload_wrapper plupload_scroll"><div id="'+a+'_container" class="plupload_container"><div class="plupload"><div class="plupload_header"><div class="plupload_header_content"><div class="plupload_header_title">'+d("Select files")+'</div><div class="plupload_header_text">'+d("Add files to the upload queue and click the start button.")+'</div></div></div><div class="plupload_content"><div class="plupload_filelist_header"><div class="plupload_file_name">'+d("Filename")+'</div><div class="plupload_file_action">&nbsp;</div><div class="plupload_file_status"><span>'+d("Status")+'</span></div><div class="plupload_file_size">'+d("Size")+'</div><div class="plupload_clearer">&nbsp;</div></div><ul id="'+a+'_filelist" class="plupload_filelist"></ul><div class="plupload_filelist_footer"><div class="plupload_file_name"><div class="plupload_buttons"><a href="#" class="button-primary" id="'+a+'_browse">'+d("Add Files")+'</a><a href="#" class="button-primary plupload_start" id="'+a+'_upload">'+d("Start Upload")+'</a></div><span class="plupload_upload_status"></span></div><div class="plupload_file_action"></div><div class="plupload_file_status"><span class="plupload_total_status">0%</span></div><div class="plupload_file_size"><span class="plupload_total_file_size">0 b</span></div><div class="plupload_progress"><div class="plupload_progress_container"><div class="plupload_progress_bar"></div></div></div><div class="plupload_clearer">&nbsp;</div></div></div></div></div><input type="hidden" id="'+a+'_count" name="'+a+'_count" value="0" /></div>')}var t={};l.fn.pluploadQueue=function(p){return p?(this.each(function(){function i(a){var d;a.status==ngg_plupload.DONE&&(d="plupload_done"),a.status==ngg_plupload.FAILED&&(d="plupload_failed"),a.status==ngg_plupload.QUEUED&&(d="plupload_delete"),a.status==ngg_plupload.UPLOADING&&(d="plupload_uploading");var e=l("#"+a.id).attr("class",d).find("a").css("display","block");a.hint&&e.attr("title",a.hint)}function s(){l("span.plupload_total_status",_).html(u.total.percent+"%"),l("div.plupload_progress_bar",_).css("width",u.total.percent+"%"),l("span.plupload_upload_status",_).html(a.sprintf(d("Uploaded %d/%d files"),u.total.uploaded,u.files.length))}function o(){var e,t=l("ul.plupload_filelist",_).html(""),p=0;l.each(u.files,function(a,d){e="",d.status==ngg_plupload.DONE&&(d.target_name&&(e+='<input type="hidden" name="'+r+"_"+p+'_tmpname" value="'+ngg_plupload.xmlEncode(d.target_name)+'" />'),e+='<input type="hidden" name="'+r+"_"+p+'_name" value="'+ngg_plupload.xmlEncode(d.name)+'" />',e+='<input type="hidden" name="'+r+"_"+p+'_status" value="'+(d.status==ngg_plupload.DONE?"done":"failed")+'" />',p++,l("#"+r+"_count").val(p)),t.append('<li id="'+d.id+'"><div class="plupload_file_name"><span>'+d.name+'</span></div><div class="plupload_file_action"><a href="#"></a></div><div class="plupload_file_status">'+d.percent+'%</div><div class="plupload_file_size">'+ngg_plupload.formatSize(d.size)+'</div><div class="plupload_clearer">&nbsp;</div>'+e+"</li>"),i(d),l("#"+d.id+".plupload_delete a").click(function(a){l("#"+d.id).remove(),u.removeFile(d),a.preventDefault()})}),l("span.plupload_total_file_size",_).html(ngg_plupload.formatSize(u.total.size)),0===u.total.queued?l("span.plupload_add_text",_).html(d("Add Files")):l("span.plupload_add_text",_).html(a.sprintf(d("%d files queued"),u.total.queued)),l("a.plupload_start",_).toggleClass("plupload_disabled",u.files.length==u.total.uploaded+u.total.failed),t[0].scrollTop=t[0].scrollHeight,s(),!u.files.length&&u.features.dragdrop&&u.settings.dragdrop&&l("#"+r+"_filelist").append('<li class="plupload_droptext">'+d("Drag files here.")+"</li>")}function n(){delete t[r],u.destroy(),_.html(c),u=_=c=null}var u,_,r,c;_=l(this),r=_.attr("id"),r||(r=ngg_plupload.guid(),_.attr("id",r)),c=_.html(),e(r,_),p=l.extend({dragdrop:!0,browse_button:r+"_browse",container:r},p),p.dragdrop&&(p.drop_element=r+"_filelist"),u=new ngg_plupload.Uploader(p),t[r]=u,u.bind("UploadFile",function(a,d){l("#"+d.id).addClass("plupload_current_file")}),u.bind("Init",function(a,d){!p.unique_names&&p.rename&&_.on("click","#"+r+"_filelist div.plupload_file_name span",function(d){var e,t,p,i=l(d.target),s="";e=a.getFile(i.parents("li")[0].id),p=e.name,t=/^(.+)(\.[^.]+)$/.exec(p),t&&(p=t[1],s=t[2]),i.hide().after('<input type="text" />'),i.next().val(p).focus().blur(function(){i.show().next().remove()}).keydown(function(a){var d=l(this);13==a.keyCode&&(a.preventDefault(),e.name=d.val()+s,i.html(e.name),d.blur())})}),l("#"+r+"_container").attr("title","Using runtime: "+d.runtime),l("a.plupload_start",_).click(function(a){l(this).hasClass("plupload_disabled")||u.start(),a.preventDefault()}),l("a.plupload_stop",_).click(function(l){l.preventDefault(),u.stop()}),l("a.plupload_start",_).addClass("plupload_disabled")}),u.bind("Error",function(a,e){var t,p=e.file;p&&(t=e.message,e.details&&(t+=" ("+e.details+")"),e.code==ngg_plupload.FILE_SIZE_ERROR&&alert(d("Error: File too large:")+" "+p.name),e.code==ngg_plupload.FILE_EXTENSION_ERROR&&alert(d("Error: Invalid file extension:")+" "+p.name),p.hint=t,l("#"+p.id).attr("class","plupload_failed").find("a").css("display","block").attr("title",t)),e.code===ngg_plupload.INIT_ERROR&&setTimeout(function(){n()},1)}),u.bind("PostInit",function(a){a.settings.dragdrop&&a.features.dragdrop&&l("#"+r+"_filelist").append('<li class="plupload_droptext">'+d("Drag files here.")+"</li>")}),u.init(),u.bind("StateChanged",function(){u.state===ngg_plupload.STARTED?(l("li.plupload_delete a,div.plupload_buttons",_).hide(),l("span.plupload_upload_status,div.plupload_progress,a.plupload_stop",_).css("display","block"),l("span.plupload_upload_status",_).html("Uploaded "+u.total.uploaded+"/"+u.files.length+" files"),p.multiple_queues&&l("span.plupload_total_status,span.plupload_total_file_size",_).show()):(o(),l("a.plupload_stop,div.plupload_progress",_).hide(),l("a.plupload_delete",_).css("display","block"),p.multiple_queues&&u.total.uploaded+u.total.failed==u.files.length&&(l(".plupload_buttons,.plupload_upload_status",_).css("display","inline"),l(".plupload_start",_).addClass("plupload_disabled"),l("span.plupload_total_status,span.plupload_total_file_size",_).hide()))}),u.bind("FilesAdded",o),u.bind("FilesRemoved",function(){var a=l("#"+r+"_filelist").scrollTop();o(),l("#"+r+"_filelist").scrollTop(a)}),u.bind("FileUploaded",function(l,a){i(a)}),u.bind("UploadProgress",function(a,d){l("#"+d.id+" div.plupload_file_status",_).html(d.percent+"%"),i(d),s()}),p.setup&&p.setup(u)}),this):t[l(this[0]).attr("id")]}}(jQuery,mOxie);