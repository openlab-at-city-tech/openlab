"use strict";(self.webpackChunkgravityforms=self.webpackChunkgravityforms||[]).push([[301],{5248:function(e,t,i){i.r(t),i.d(t,{default:function(){return De}});var n,o=i(5798),r=i(9662),a=i.n(r),s=i(1533),l=i.n(s),c=i(2685),d=i.n(c),u={labels:(0,o.getNodes)("choices-ui-label",!0),mainSettings:(0,o.getNodes)('[data-js="choices-ui-setting"][data-type="main"]',!0,document,!0),sections:(0,o.getNodes)("choices-ui-section",!0),settings:(0,o.getNodes)("choices-ui-setting",!0),flyoutTrigger:(0,o.getNodes)("choices-ui-trigger")[0],flyoutTriggerLabel:(0,o.getNodes)("choices-ui-trigger-label")[0]},f=(null===l()||void 0===l()||null===(n=l().form_editor)||void 0===n?void 0:n.choices_ui)||{},m=function(){var e=(0,o.getNodes)('[data-js="choices-ui-setting"][data-type="main"]',!0,a().instances.choicesUi.flyout.elements.content,!0).filter((function(e){return"none"!==window.getComputedStyle(e).getPropertyValue("display")}))[0],t=(0,o.getNodes)('[data-js="choices-ui-section"][data-type="options"]',!1,e,!0)[0],i=(0,o.getNodes)("choices-ui-option-list",!1,t)[0];t.style.display="block",t.style.display=i.clientHeight>25?"block":"none"},v=function(){var e,t,i,n,r,s=u.settings.filter((function(e){return"none"!==window.getComputedStyle(e).getPropertyValue("display")}));u.flyoutTrigger.style.display=s.length?"":"none",u.flyoutTriggerLabel.style.display=s.length?"":"none",function(){if(!(u.mainSettings.length<2)){var e=u.mainSettings.filter((function(e){return"none"!==window.getComputedStyle(e).getPropertyValue("display")}))[0];if(e){var t=(0,o.getNodes)("choices-ui-option-list",!1,e)[0];t.innerHTML="",u.options.forEach((function(e){t.appendChild(e),"list-item"===window.getComputedStyle(e).getPropertyValue("display")&&(e.style.display="inline-block")}))}}}(),i=(null===(e=window)||void 0===e||null===(e=e.field)||void 0===e?void 0:e.type)||"",n=(null===(t=window)||void 0===t||null===(t=t.field)||void 0===t?void 0:t.inputType)||"",r=a().instances.choicesUi.flyout.elements.flyout,(0,o.removeClassThatContains)(r,"gform-flyout--choices-ui--"),i&&r.classList.add("gform-flyout--choices-ui--".concat(i)),n&&r.classList.add("gform-flyout--choices-ui--input-type-".concat(n)),m()},g=function(e){var t=e.title,i=void 0===t?"":t,n=e.content,r=void 0===n?null:n,s=e.position,l=void 0===s?"beforeend":s,c=e.type,d=void 0===c?"":c;if(r){a().instances.choicesUi.flyout.elements.content.insertAdjacentHTML(l,'\n\t\t<div class="choices-ui__section" data-js="choices-ui-section" data-type="'.concat(d,'">\n\t\t\t<h6 class="choices-ui__section-label">').concat((0,o.escapeHtml)(i),"</h6>\n\t\t</div>\n\t"));var f=(0,o.getNodes)("choices-ui-section",!0);f[f.length-1].appendChild(r),u.sections.push(f[f.length-1])}else(0,o.consoleError)("Gravity Forms Admin: You must supply a valid node to appendSectionHtml.")},p=function(e){u.container=e,(0,o.trigger)({event:"gform/choices_ui/pre_init",native:!1,data:{elements:u}}),a().instances=a().instances||{},a().instances.choicesUi={},function(){var e=f.i18n,t=e.title,i=e.expandableTitle,n=e.description;a().instances.choicesUi.flyout=new(d())({closeOnOutsideClickExceptions:[".media-modal",".gform-dialog__mask"],description:(0,o.escapeHtml)(n),expandable:!0,expandableTitle:(0,o.escapeHtml)(i),expandableWidth:100,id:"choices-ui-flyout",maxWidth:540,mobileBreakpoint:1200,onOpen:function(){setTimeout((function(){m()}),50),(0,o.trigger)({event:"gforms/choices_ui/opened",native:!1,data:a().instances.choicesUi})},position:"absolute",simplebar:!0,target:'[data-js="form-editor"]',title:(0,o.escapeHtml)(t),triggers:'[data-js="choices-ui-trigger"]',wrapperClasses:"gform-flyout gform-flyout--choices-ui",zIndex:100})}(),function(){a().instances.choicesUi.flyout.elements.content.insertAdjacentHTML("afterbegin",'<ul class="choices-ui__content" data-js="choices-ui-content"></ul>');var e=(0,o.getNodes)("choices-ui-content",!1,a().instances.choicesUi.flyout.elements.content)[0];u.settings.forEach((function(t){return e.appendChild(t)}))}(),u.optionsList=(0,o.getNodes)("choices-ui-option-list",!1,a().instances.choicesUi.flyout.elements.content)[0],u.settings.forEach((function(e){"option"===e.dataset.type&&u.optionsList.appendChild(e)})),u.options=(0,o.getNodes)('[data-js="choices-ui-option-list"] > li',!0,a().instances.choicesUi.flyout.elements.content,!0),a().instances.choicesUi.flyout.elements.flyout.addEventListener("click",(function(e){e.stopPropagation()})),document.addEventListener("gform/form_editor/setting_selected",v),u.flyoutEl=(0,o.getNodes)("#choices-ui-flyout .gform-flyout__body",!1,document,!0),a().instances.choicesUi.elements=u,a().instances.choicesUi.methods={appendSectionHtml:g},(0,o.trigger)({event:"gform/choices_ui/post_render",native:!1,data:a().instances.choicesUi}),(0,o.consoleInfo)("Gravity Forms Admin: Initialized choices ui flyout.")},h=i(455),y=i(9280),_=i.n(y),w=i(7616),S=i(3801),b=i.n(S),A=w.ReactDOM.createRoot,k=function(e){var t=e.detail.id,i=window.wp.media({library:{type:"image"},multiple:!1});i.on("select",(function(){var e=i.state().get("selection").first().toJSON(),n=e.url,o=void 0===n?"":n,r=e.id,a=void 0===r?"":r,s=e.sizes,l=(void 0===s?{}:s).large,c=(void 0===l?{}:l).url;C(t,a,void 0===c?"":c,o)})),i.open()},E=function(){var e=(0,h.A)(_().mark((function e(t){var i,n,o,r,a,s,c,d,u,f,m,v;return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(s=new FormData).append("name","fileUpload"),s.append("action","upload-attachment"),s.append("_wpnonce",(null===(i=_wpPluploadSettings)||void 0===i||null===(i=i.defaults)||void 0===i||null===(i=i.multipart_params)||void 0===i?void 0:i._wpnonce)||""),s.append("async-upload",t.detail.file),e.next=8,fetch((null===l()||void 0===l()||null===(n=l().endpoints)||void 0===n?void 0:n.ajaxurl)||"",{method:"POST",credentials:"same-origin",body:s});case 8:return c=e.sent,e.next=11,c.json();case 11:d=e.sent,u=t.detail.id,f=null==d||null===(o=d.data)||void 0===o?void 0:o.id,m=null==d||null===(r=d.data)||void 0===r?void 0:r.url,v=null==d||null===(a=d.data)||void 0===a||null===(a=a.sizes)||void 0===a||null===(a=a.large)||void 0===a?void 0:a.url,C(u,f,v,m),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0);case 22:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(t){return e.apply(this,arguments)}}(),C=function(e,t,i,n){(0,o.trigger)({event:"gform/file_upload/external_manager/file_selected",native:!1,data:{fileUploadId:e,id:t,largeUrl:i,url:n}})},F=function(e){field=GetSelectedField();var t=e.type.split("/").pop(),i="file_remove"===t?"id":"fileUploadId",n=e.detail[i].split("_").pop(),o="",r="";"file_selected"===t&&(o=e.detail.largeUrl?e.detail.largeUrl:e.detail.url,r=e.detail.id),field.choices[n]&&(field.choices[n].file_url=o,field.choices[n].attachment_id=r),RefreshSelectedFieldPreview()},I=function(){a().addAction("gform_load_field_choices",(function(){(0,o.getNodes)(".field-choice-row",!0,document,!0).forEach((function(e){var t;if("checkbox"===e.dataset.input_type||"radio"===e.dataset.input_type){var i=(0,o.getNode)("gform-image-choice-upload",e);if(i&&!e.querySelector(".mounted")){var n=(null==i||null===(t=i.dataset)||void 0===t?void 0:t.jsProps)||"{}",r=JSON.parse(n);A(i).render(w.React.createElement(b(),r)),i.classList.add("mounted")}}}))})),document.addEventListener("gform/file_upload/external_manager/open",k),document.addEventListener("gform/file_upload/external_manager/save",E),document.addEventListener("gform/file_upload/external_manager/file_selected",F),document.addEventListener("gform/file_upload/external_manager/file_remove",F)},B=function(){I(),(0,o.consoleInfo)("Gravity Forms Admin: Initialized choices ui for image choices.")},x=function(e){p(e),B(),(0,o.consoleInfo)("Gravity Forms Admin: Initialized all choices ui scripts.")},j=function(e){var t=e.detail.field;document.querySelector(".gform-compact-view")&&(t.classList.add("trigger-reflow"),t.offsetHeight,t.classList.remove("trigger-reflow"))},T=function(){document.addEventListener("gform/layout_editor/field_refresh_preview",j),(0,o.consoleInfo)("Gravity Forms Admin: Initialized form editor field event listeners.")},D=function(){T(),(0,o.consoleInfo)("Gravity Forms Admin: Initialized all form editor field scripts.")},N=i(2888),L=i(1873),O=i(7113),U=i(0),R=i(1118),P=i(6739),z=i(7821),H=i(428),M=i.n(H);function q(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return V(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?V(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw r}}}}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}function G(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(G=function(){return!!e})()}var J=function(e){function t(){return(0,L.A)(this,t),e=this,i=t,n=arguments,i=(0,R.A)(i),(0,U.A)(e,G()?Reflect.construct(i,n||[],(0,R.A)(e).constructor):i.apply(e,n));var e,i,n}return(0,z.A)(t,e),(0,O.A)(t,[{key:"init",value:function(){var e=this;this.eventsManager.addListener("SaveRequested",this.save,this),this.eventsManager.addListener("SaveCompleted",this.resetFormChars,this),document.addEventListener("gform/dialog/confirm",this.maybeSave.bind(this));var t,i=q(this.config.data.domEvents);try{var n,o=function(){var i=t.value;if(i){var n=e.eventsManager.get(i.name),o=document,r={};if("document"!==i.elementSelector&&(o=document.getElementsByClassName(i.elementSelector.replace(".",""))[0]),void 0===o)return{v:void 0};o.addEventListener(i.action,(function(t){if(!e.saveInProgress){if("keydown"===i.action&&"keys"in i&&i.keys.length>0){if(-1===i.keys.indexOf(t.keyCode))return!1;if(r[t.keyCode.toString()]=t.keyCode,!i.keys.every((function(e){return e in r!=!1})))return e.pressedKeysTimeOut=setTimeout((function(){r={}}),1e3),!1}e.saveInProgress||(a().instances.adminFormSaverUIHandler.activeElement=document.activeElement,document.activeElement.blur(),t.preventDefault(),t.stopImmediatePropagation(),r={},n.fire(),e.saveInProgress=!0)}}))}};for(i.s();!(t=i.n()).done;)if(n=o())return n.v}catch(e){i.e(e)}finally{i.f()}}},{key:"maybeSave",value:function(e){if("gform/dialog/confirm"===e.type){var t;if("dialog-embed-form-unsaved-changes"!==(null==e||null===(t=e.detail)||void 0===t||null===(t=t.instance)||void 0===t||null===(t=t.options)||void 0===t?void 0:t.id))return;this.save()}}},{key:"save",value:function(){var e,i,n,r,a,s=(0,o.getNodes)("force-focus")[0];if(s&&s.focus(),this.formJSONString=this.getUpdatedFormJSON(),!window.ValidateForm())return this.eventsManager.trigger("SaveAborted"),!1;(e=t,i="save",n=this,r=3,a=(0,P.A)((0,R.A)(1&r?e.prototype:e),i,n),2&r&&"function"==typeof a?function(e){return a.apply(n,e)}:a)([])}},{key:"deepSanitizeFormValues",value:function(e){if("object"!==(0,N.A)(e))return e;for(var t in e){var i=e[t];"object"!==(0,N.A)(i)||null===i?"string"==typeof i?(e[t]=i.replace(/\\'/g,"'"),e[t]=i.replace(/\\/g,"\\\\")):e[t]=i:e[t]=this.deepSanitizeFormValues(i)}return e}},{key:"resetFormChars",value:function(){window.form=this.reverseFormSanitization(this.form)}},{key:"reverseFormSanitization",value:function(e){if("object"!==(0,N.A)(e))return e;for(var t in e){var i=e[t];"object"!==(0,N.A)(i)||null===i?e[t]="string"==typeof i?i.replace(/\\\\/g,"\\"):i:e[t]=this.reverseFormSanitization(i)}return e}},{key:"getUpdatedFormJSON",value:function(){try{this.form=window.UpdateFormObject(),window.gforms_original_json=M().toJSON(this.form)}catch(e){(0,o.consoleError)(e)}var e=this.deepSanitizeFormValues(this.form);return M().toJSON(e)}}])}(i(1281).A),W=i(6752),K=i(3244),Q=i.n(K),$=i(6900),Y=i.n($),X=i(3963),Z=i.n(X);function ee(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return te(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?te(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw r}}}}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}var ie=function(){return(0,O.A)((function e(t,i){(0,L.A)(this,e),this.events=t,this.config=i,this.timeOuts=[],this.scripts=[],this.styles=[],this.buttons=[],this.currentFormFields={},this.storeCurrentFormFields(),this.maybeHandleNormalPostRequest(),this.setInitialUrlState(),this.initButtons(),this.bindEvents(),this.init()}),[{key:"storeCurrentFormFields",value:function(){var e=this;window.form.fields.forEach((function(t){e.currentFormFields[t.id]=JSON.stringify(t)}))}},{key:"init",value:function(){var e=this;this.timeOuts.forEach((function(e){window.clearTimeout(e)})),document.getElementsByTagName("script").forEach((function(t){var i=t.getAttribute("src");null!==i&&(i=i.substring(0,i.indexOf("?ver")),e.scripts.push(i))})),document.getElementsByTagName("link").forEach((function(t){var i=t.getAttribute("href");null!==i&&(i=i.substring(0,i.indexOf("?ver")),e.styles.push(i))})),this.selectedField={}}},{key:"initButtons",value:function(){var e=this;this.config.data.selectors.saveAnimationButtons.forEach((function(t){(0,o.getNodes)(t,!0,document,!0).forEach((function(t){var i=t.id?t.id:(0,o.uniqueId)("button-");t.id=i;var n=new(Y())({activeType:"loader",id:i,interactive:!0,loaderOptions:{background:"transparent",foreground:"#fff",mask:!1,showOnRender:!1,size:1.5},rendered:!0});e.buttons.push(n)}))}))}},{key:"maybeHandleNormalPostRequest",value:function(){void 0!==window.updateFormResult&&("invalid_json"===window.updateFormResult.status?this.showSaveErrorNotification():this.showSaveSuccessNotification())}},{key:"bindEvents",value:function(){this.events.addListeners([{name:"SaveBegan",handler:[this.init,this.beginButtonAnimation]},{name:"SaveInProgress",handler:this.handleSaveProgress},{name:["SaveFailed","SaveRequestFailed","SaveResponseMalformed"],handler:[this.handleSaveFailure]},{name:"SaveSucceeded",handler:[this.handleSaveSuccess]},{name:"SaveCompleted",handler:this.reset},{name:"SaveBegan",handler:this.beginButtonAnimation},{name:["SaveCompleted","SaveAborted"],handler:[this.endButtonAnimation,this.reset]}],this)}},{key:"beginButtonAnimation",value:function(){this.buttons.filter((function(e){return e.options.interactive})).forEach((function(e){return e.activateButton()}))}},{key:"endButtonAnimation",value:function(){this.buttons.filter((function(e){return e.options.interactive})).forEach((function(e){return e.deactivateButton()}))}},{key:"reset",value:function(){var e=this;this.registerTimeOut((function(){e.buttons.forEach((function(e){e.deactivateButton()})),"id"in e.selectedField&&M()("#field_"+e.selectedField.id).click(),e.resetSettingsControlsDisabledState(),e.activeElement&&M()(e.activeElement).focus(),a().instances.adminFormSaver.saveInProgress=!1}),this.config.data.animationDelay)}},{key:"resetElementClasses",value:function(e,t){var i=t.classList.value;if(void 0!==i&&""!==i){i=i.split(" "),e.removeClass();for(var n=0;n<i.length;n++)""!==i[n]&&void 0!==i[n]&&e.addClass(i[n])}}},{key:"handleSaveProgress",value:function(){var e=this;this.selectedField=window.GetSelectedField(),this.selectedField||(this.selectedField={}),this.registerTimeOut((function(){Q().a11y.speak(e.config.i18n.saveInProgress,"polite"),e.disableSettingsControls()}),this.config.data.animationDelay/8)}},{key:"handleSaveFailure",value:function(e){var t=this;this.registerTimeOut((function(){var i,n=null==e||null===(i=e.error)||void 0===i?void 0:i.message;n&&"Failed to fetch"===n?t.showSaveErrorNotification(t.config.i18n.networkError):t.showSaveErrorDialog(),(0,o.trigger)({event:"gform/form_editor_saver/post_save_error",native:!1})}),this.config.data.animationDelay)}},{key:"fireManualSave",value:function(){(0,o.getNodes)("#gform_export",!1,document,!0)[0].value=!0,window.SaveForm()}},{key:"showSaveErrorDialog",value:function(){new(Z())({animationDelay:250,closeOnConfirmClick:!1,closeOnMaskClick:!1,confirmButtonIcon:"floppy-disk",onConfirm:this.fireManualSave.bind(this),id:"dialog-ajax-save-error",cancelButtonText:this.config.i18n.ajaxErrorDialogCancelButtonText,closeButtonTitle:this.config.i18n.ajaxErrorDialogCloseButtonTitle,confirmButtonText:this.config.i18n.ajaxErrorDialogConfirmButtonText,content:this.config.i18n.ajaxErrorDialogContent,title:this.config.i18n.ajaxErrorDialogTitle,titleIcon:"circle-delete",mode:"dialog",titleIconColor:"#DD301D",wrapperClasses:"gform-dialog ",zIndex:1e5}).showDialog()}},{key:"handleSaveSuccess",value:function(e){var t=this;this.registerTimeOut((function(){t.showSaveSuccessNotification(),t.updatePageURL(),(0,o.trigger)({event:"gform/form_editor_saver/post_save_success",native:!1})}),this.config.data.animationDelay),this.reloadEditorUI(e)}},{key:"setInitialUrlState",value:function(){window.history.replaceState(window.form,document.title,(0,o.updateQueryVar)("gf_ajax_save",null))}},{key:"updatePageURL",value:function(){window.history.replaceState({},document.title,(0,o.updateQueryVar)("gf_ajax_save",(0,o.uniqueId)(""),(0,o.updateQueryVar)("isnew",null)))}},{key:"showSaveSuccessNotification",value:function(){var e=this.config.data.urls.formPreview,t=this.config.i18n,i=t.formUpdated,n=t.viewForm;(0,o.trigger)({data:{autoHideDelay:4500,container:"#form_editor_fields_container",ctaLink:(0,o.escapeHtml)((0,o.vsprintf)(e,[window.form.id])),ctaTarget:"_blank",ctaText:(0,o.escapeHtml)(n),icon:"circle-check-alt",message:(0,o.escapeHtml)(i),type:"success"},event:"gform/snackbar/render",native:!1})}},{key:"showSaveErrorNotification",value:function(e){var t=this.config.i18n.genericError,i="string"==typeof e&&""!==e&&null!==e?e:t;(0,o.trigger)({data:{autoHideDelay:4500,container:"#form_editor_fields_container",icon:"circle-delete",message:(0,o.escapeHtml)(i),type:"error"},event:"gform/snackbar/render",native:!1})}},{key:"disableSettingsControls",value:function(){document.querySelectorAll(".field_setting input, .field_setting select, .field_setting textarea").forEach((function(e){e.setAttribute("data-js-initial-disabled-state",e.disabled),e.disabled=!0}))}},{key:"resetSettingsControlsDisabledState",value:function(){document.querySelectorAll(".field_setting input, .field_setting select, .field_setting textarea").forEach((function(e){"false"===e.getAttribute("data-js-initial-disabled-state")&&e.removeAttribute("disabled"),e.removeAttribute("data-js-initial-disabled-state")}))}},{key:"reloadEditorUI",value:function(e){try{var t=document.createElement("html");t.innerHTML=decodeURIComponent(e.data.updated_markup.toString());var i=M()(t);this.reloadSettings(i),this.reloadScripts(i),this.reloadElements(i)}catch(e){}}},{key:"reloadScripts",value:function(e){var t=this;e.find("script[data-js-reload]").toArray().forEach((function(e){var i=M()(e).attr("data-js-reload"),n=M()('script[data-js-reload="'+i+'"]');if(n.length){var o=t.events.trigger("scriptBeforeReload",e,i,n.get(0));!1!==o&&void 0!==M()(o).attr("data-js-skip-reload")&&(n.replaceWith(o),t.events.trigger("scriptAfterReload",o,i,n.get(0)))}})),M()("#gform_editor_js_action_output_wrapper script").toArray().forEach((function(e){e.remove()}));var i=e.find("#gform_editor_js_action_output_wrapper").toArray().pop();!1!==(i=this.events.trigger("gformEditorJSActionBeforeReload",i))&&M()("#gform_editor_js_action_output_wrapper").replaceWith(i)}},{key:"reloadElements",value:function(e){var t=this;(0,o.getNodes)(":not(script)[data-js-reload]",!0,e[0],!0).forEach((function(e){var i=e.getAttribute("data-js-reload");if("true"!==i){var n=(0,o.getNodes)(':not(script)[data-js-reload="'.concat(i,'"]'),!1,document,!0)[0];if(n&&t.shouldReplaceElement(n,e)){(0,o.consoleInfo)("updating element: "+i);var r=t.events.trigger("elementBeforeReload",e,i,n);!1===r||r.getAttribute("data-js-skip-reload")||(M()(n).replaceWith(r),t.events.trigger("elementAfterReload",r,i,n))}}})),"id"in this.selectedField&&M()("#field_"+this.selectedField.id).addClass("field_selected")}},{key:"shouldReplaceElement",value:function(e,t){if(!1===e.classList.contains("gfield"))return(0,o.consoleInfo)("Element with ID: "+e.getAttribute("id")+" is not a field element, its markup should be updated"),!0;var i=parseInt(t.getAttribute("id").replace("field_","")),n=this.currentFormFields[i],r=window.form.fields.reduce((function(e,t){return t.id!==i?e:JSON.stringify(t)}),!1);return r&&r!==n}},{key:"reloadSettings",value:function(e){var t,i=M()(".editor-sidebar"),n=M()(".gform-flyout"),o=e.find(".editor-sidebar"),r=[],a=[],s=[],l=o.find("li.field_setting").toArray(),c=i.find("li.field_setting").toArray(),d=n.find("li.field_setting").toArray(),u=this.getElementsAsClassLists(l),f=this.getElementsAsClassLists(d),m=this.getElementsAsClassLists(c),v=ee(m=m.concat(f));try{for(v.s();!(t=v.n()).done;){var g=t.value;u.indexOf(g)>=0||a.push(g)}}catch(e){v.e(e)}finally{v.f()}var p,h=ee(u);try{for(h.s();!(p=h.n()).done;){var y=p.value;""!==y&&(m.indexOf(y)>=0?s.push(y):r.push(y))}}catch(e){h.e(e)}finally{h.f()}this.insertNewFieldSettings(r,o),this.updateExistingFieldSettings(s,o,e),this.deleteExpiredFieldSettings(a)}},{key:"insertNewFieldSettings",value:function(e,t){var i,n=ee(e);try{for(n.s();!(i=n.n()).done;){var o=i.value,r=t.find("."+o).prevUntil().toArray();if(this.events.trigger("beforeFieldSettingAdded",[M()("."+o).get(0),t.find("."+o).get(0)]),r.length<1){var a=t.find("."+o).parent().attr("id");M()("#"+a).prepend(t.find("."+o)),this.events.trigger("afterFieldSettingAdded",[o])}else{var s,l=ee(r);try{for(l.s();!(s=l.n()).done;){var c=s.value.classList.value.split(" ")[0];if(M()("."+c).length){t.find("."+o).insertAfter(M()("."+c)),this.events.trigger("afterFieldSettingAdded",[o]);break}}}catch(e){l.e(e)}finally{l.f()}}}}catch(e){n.e(e)}finally{n.f()}}},{key:"deleteExpiredFieldSettings",value:function(e){var t,i=ee(e);try{for(i.s();!(t=i.n()).done;){var n=t.value;this.events.trigger("beforeFieldSettingDeleted",[n]),M()("."+n).remove(),this.events.trigger("AfterFieldSettingDeleted",[n])}}catch(e){i.e(e)}finally{i.f()}}},{key:"updateExistingFieldSettings",value:function(e,t,i){var n=this;e.forEach((function(e){var o="."+e;M()(o).hasClass("data-js-reload")&&(n.events.trigger("fieldSettingBeforeUpdate",M()(o).get(0),t.find(o).get(0)),M()(o).replaceWith(i.find(o)),n.events.trigger("fieldSettingAfterUpdate",M()(o).get(0)))}))}},{key:"getElementsAsClassLists",value:function(e){return e.map((function(e){return e.classList.value.split(" ")[0]}))}},{key:"registerTimeOut",value:function(e,t){var i=setTimeout(e,t);return this.timeOuts.push(i),i}}])}(),ne=(null===l()||void 0===l()?void 0:l().form_editor_save_form)||{};a().instances=(null===a()||void 0===a()?void 0:a().instances)||{};var oe,re=function(){a().instances.formSaverEventsManager=new W.A,a().instances.adminFormSaverUIHandler=new ie(a().instances.formSaverEventsManager,ne),a().instances.adminFormSaver=new J(ne,{config:ne,events:a().instances.formSaverEventsManager,endpointKey:"form_editor_save_form",form:window.form}),a().instances.adminFormSaver.init()},ae=i(8140),se=i(2595),le=i.n(se),ce=function(e,t){var i,n;return function(){var o=this,r=arguments;n?(clearTimeout(i),i=setTimeout((function(){Date.now()-n>=t&&(e.apply(o,r),n=Date.now())}),t-(Date.now()-n))):(e.apply(o,r),n=Date.now())}},de=w.ReactDOM.createRoot,ue={DeleteField:"delete",StartDuplicateField:"duplicate"},fe=((null===l()||void 0===l()||null===(oe=l().components)||void 0===oe?void 0:oe.dropdown_menu)||{}).i18n,me=fe.duplicateButtonLabel,ve=fe.deleteButtonLabel,ge=fe.dropdownButtonLabel,pe=function(e){return function(t){var i=t.target.closest("[data-js-reload]");if(i){var n=i.getAttribute("data-js-reload").split("_"),o=(0,ae.A)(n,2),r=(o[0],o[1]),a=ue[e]||e.toLowerCase(),s="gfield_".concat(a,"_").concat(r),l=document.getElementById(s);if(l&&"function"==typeof window[e]&&window[e](l),"StartDuplicateField"===e){var c=i.querySelector(".gform-button");c&&c.click()}}}},he={icon:"duplicate",label:me,customClasses:["gform-compact-view-overflow-menu__item","gform-compact-view-overflow-menu__item-duplicate"],customAttributes:{onClick:pe("StartDuplicateField")}},ye={icon:"trash",label:ve,customClasses:["gform-compact-view-overflow-menu__item","gform-compact-view-overflow-menu__item-delete"],customAttributes:{onClick:pe("DeleteField")}},_e=["total","paypal","captcha","turnstile","post_title","post_content","post_excerpt","total","shipping","mollie","creditcard","submit"],we=function(e){var t=function(e){var t="gfield--type-";return document.getElementById("field_".concat(e.split("_").pop())).className.split(" ").find((function(e){return e.startsWith(t)})).substring(13)}(e);return!_e.includes(t)},Se=function(){return document.getElementById("form_editor_fields_container").classList.contains("gform-compact-view")},be=function(e,t){if(t&&!e.getAttribute("data-dropdown-added"))!function(e){var t={align:"right",listItems:[we(e.id)&&{key:"duplicate",props:he},{key:"delete",props:ye}].filter(Boolean),type:"action",customClasses:["gform-compact-view-overflow-menu__container"],triggerAttributes:{icon:"ellipsis",size:"size-height-s",type:"simplified",ariaText:ge,ariaId:e.id},width:120,autoPosition:!0,customAttributes:{"aria-label":ge}};de(e).render(w.React.createElement(le(),t))}(e),e.setAttribute("data-dropdown-added","true");else if(!t&&e.getAttribute("data-dropdown-added")){de(e).unmount(),e.removeAttribute("data-dropdown-added")}},Ae=function(e){(0,o.getNodes)('[data-js="gform-compact-view-overflow-menu"]',!0,document,!0).forEach((function(t){return be(t,e)}))},ke=function(){Ae(Se())},Ee=function(){var e;e=ce(Ae,200),Se()&&e(!0),["gform/layout_editor/field_modified","gform/form_editor/field-duplicated-native","gform/form_editor/compact-view-active","gform/form_editor/compact-view-inactive","gform/layout_editor/field_refresh_preview","gform/layout_editor/field_start_change_type"].forEach((function(e){return document.addEventListener(e,ke)})),(0,o.consoleInfo)("Gravity Forms Admin: Initialized dropdown component on event: gform/form_editor/compact-view-active")},Ce=i(7723),Fe=function(e){var t=document.getElementById(e);if(t){var i=t.closest('[data-js="gform-dialog-mask"]');i&&i.remove(),t.remove()}};a().instances.dialogAlert=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=new(Z())({id:"alert-dialog-message",triggers:'[data-js="dialog-alert-message"]',closeButtonClasses:"gform-button--circular",closeButtonSize:"xs",closeButtonType:"simplified",wrapperClasses:"gform-dialog gform-dialog--alert",title:e,content:t,titleIcon:i?"circle-check-fine":"circle-delete",titleIconColor:i?"#22A752":"#DD301D",onClose:function(){return Fe(n.options.id)}});n.showDialog()},a().instances.dialogConfirmAsync=function(e,t){return new Promise((function(i){var n=new(Z())({id:"alert-dialog-confirmation",triggers:'[data-js="dialog-confirm-message"]',closeButtonClasses:"gform-button--circular",closeButtonSize:"xs",closeButtonType:"simplified",wrapperClasses:"gform-dialog gform-dialog--alert",content:t,title:e,closeButtonAriaLabel:(0,Ce.__)("Close","gravityforms"),animationDelay:250,closeOnMaskClick:!1,onConfirm:function(){return i(!0)},onOpen:function(){var e=document.querySelector("#".concat(n.options.id," .gform-dialog__cancel"));e&&e.addEventListener("click",(function(){i(!1)}))},onClose:function(){return setTimeout((function(){return Fe(n.options.id)}),100)},cancelButtonText:(0,Ce.__)("Cancel","gravityforms"),closeButtonTitle:(0,Ce.__)("Close","gravityforms"),confirmButtonText:(0,Ce.__)("OK","gravityforms"),titleIcon:"circle-delete",titleIconColor:"#DD301D",mode:"dialog"});n.showDialog()}))};var Ie=function(){a().instances=(null===a()||void 0===a()?void 0:a().instances)||{},a().instances.dialogAlert=a().instances.dialogAlert||"",a().instances.dialogConfirmAsync=a().instances.dialogConfirmAsync||"",a().components=(null===a()||void 0===a()?void 0:a().components)||{},a().components.Dialog=Z()},Be=function(){Ie()};a().instances.moveBulkChoicesBehind=function(){var e=document.getElementById("TB_window"),t=document.getElementById("TB_overlay");"visible"===e.style.visibility&&(e.style.zIndex=9,t.style.zIndex=9)};var xe=function(){a().instances=(null===a()||void 0===a()?void 0:a().instances)||{},a().instances.moveBulkChoicesBehind=a().instances.moveBulkChoicesBehind||""},je=function(){xe()},Te=function(){je(),Be()},De=function(e){x(e),D(),re(),Ee(),Te(),(0,o.consoleInfo)("Gravity Forms Admin: Initialized all form editor scripts.")}}}]);