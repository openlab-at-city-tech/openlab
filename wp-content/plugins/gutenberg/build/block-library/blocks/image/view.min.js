(()=>{"use strict";const t=window.wp.interactivity;let e,n,o=!1,i=0;const{state:l,actions:r,callbacks:a}=(0,t.store)("core/image",{state:{currentImage:{},get overlayOpened(){return l.currentImage.currentSrc},get roleAttribute(){return l.overlayOpened?"dialog":null},get ariaModal(){return l.overlayOpened?"true":null},get enlargedSrc(){return l.currentImage.uploadedSrc||"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},get imgStyles(){return l.overlayOpened&&`${l.currentImage.imgStyles?.replace(/;$/,"")}; object-fit:cover;`}},actions:{showLightbox(){const o=(0,t.getContext)();o.imageRef?.complete&&(l.scrollTopReset=document.documentElement.scrollTop,l.scrollLeftReset=document.documentElement.scrollLeft,o.currentSrc=o.imageRef.currentSrc,e=o.imageRef,n=o.buttonRef,l.currentImage=o,l.overlayEnabled=!0,a.setOverlayStyles())},hideLightbox(){l.overlayEnabled&&(setTimeout((function(){n.focus({preventScroll:!0}),l.currentImage={},e=null,n=null}),450),l.showClosingAnimation=!0,l.overlayEnabled=!1)},handleKeydown(e){if(l.overlayEnabled){if("Tab"===e.key){e.preventDefault();const{ref:n}=(0,t.getElement)();n.querySelector("button").focus()}"Escape"===e.key&&r.hideLightbox()}},handleTouchMove(t){l.overlayEnabled&&t.preventDefault()},handleTouchStart(){o=!0},handleTouchEnd(){i=Date.now(),o=!1},handleScroll(){l.overlayOpened&&!o&&Date.now()-i>450&&window.scrollTo(l.scrollLeftReset,l.scrollTopReset)}},callbacks:{setOverlayStyles(){if(!e)return;let{naturalWidth:t,naturalHeight:n,offsetWidth:o,offsetHeight:i}=e,{x:r,y:a}=e.getBoundingClientRect();const c=t/n;let s=o/i;if("contain"===l.currentImage.scaleAttr)if(c>s){const t=o/c;a+=(i-t)/2,i=t}else{const t=i*c;r+=(o-t)/2,o=t}s=o/i;let g=parseFloat("none"!==l.currentImage.targetWidth?l.currentImage.targetWidth:t),u=parseFloat("none"!==l.currentImage.targetHeight?l.currentImage.targetHeight:n),d=g/u,h=g,m=u,p=g,f=u;if(c.toFixed(2)!==d.toFixed(2)){if(c>d){const t=g/c;u-t>g?(u=t,g=t*c):u=g/c}else{const t=u*c;g-t>u?(g=t,u=t/c):g=u*c}p=g,f=u,d=g/u,s>d?(h=g,m=h/s):(m=u,h=m*s)}(o>p||i>f)&&(p=o,f=i);let w=0;window.innerWidth>480?w=80:window.innerWidth>1920&&(w=160);const y=Math.min(window.innerWidth-w,p),b=Math.min(window.innerHeight-80,f);s>y/b?(p=y,f=p/s):(f=b,p=f*s);const x=o/p,v=g*(p/h),A=u*(f/m);l.overlayStyles=`\n\t\t\t\t:root {\n\t\t\t\t\t--wp--lightbox-initial-top-position: ${a}px;\n\t\t\t\t\t--wp--lightbox-initial-left-position: ${r}px;\n\t\t\t\t\t--wp--lightbox-container-width: ${p+1}px;\n\t\t\t\t\t--wp--lightbox-container-height: ${f+1}px;\n\t\t\t\t\t--wp--lightbox-image-width: ${v}px;\n\t\t\t\t\t--wp--lightbox-image-height: ${A}px;\n\t\t\t\t\t--wp--lightbox-scale: ${x};\n\t\t\t\t\t--wp--lightbox-scrollbar-width: ${window.innerWidth-document.documentElement.clientWidth}px;\n\t\t\t\t}\n\t\t\t`},setButtonStyles(){const e=(0,t.getContext)(),{ref:n}=(0,t.getElement)();e.imageRef=n;const{naturalWidth:o,naturalHeight:i,offsetWidth:l,offsetHeight:r}=n;if(0===o||0===i)return;const a=n.parentElement,c=n.parentElement.clientWidth;let s=n.parentElement.clientHeight;const g=a.querySelector("figcaption");if(g){const t=window.getComputedStyle(g);["absolute","fixed"].includes(t.position)||(s=s-g.offsetHeight-parseFloat(t.marginTop)-parseFloat(t.marginBottom))}const u=s-r,d=c-l;if("contain"===e.scaleAttr){const t=o/i;if(t>=l/r){const n=l/t;e.imageButtonTop=(r-n)/2+u+16,e.imageButtonRight=d+16}else{const n=r*t;e.imageButtonTop=u+16,e.imageButtonRight=(l-n)/2+d+16}}else e.imageButtonTop=u+16,e.imageButtonRight=d+16},setOverlayFocus(){if(l.overlayEnabled){const{ref:e}=(0,t.getElement)();e.focus()}},initTriggerButton(){const e=(0,t.getContext)(),{ref:n}=(0,t.getElement)();e.buttonRef=n}}},{lock:!0})})();
//# sourceMappingURL=view.min.js.map