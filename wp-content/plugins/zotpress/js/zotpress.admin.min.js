jQuery(document).ready(function(){var e;jQuery("div#zp-Zotpress div#zp-Zotpress-Navigation a.nav-item").click(function(){jQuery(this).addClass("active")}),jQuery(".Zotpress_update_notice .notice-dismiss.text").click(function(){jQuery(".Zotpress_update_notice").slideUp("fast")}),jQuery(".zp-Entry-ID-Text span").click(function(){jQuery(this).parent().find("input").show().select(),jQuery(this).hide()}),jQuery(".zp-Entry-ID-Text input").blur(function(){jQuery(this).hide(),jQuery(this).parent().find("span").show()}),jQuery("div.zp-Browse-Accounts").delegate("select#zp-FilterByAccount","change",function(){var e=jQuery(this).val();jQuery(this).addClass("loading"),jQuery(".zp-Browse-Account-Options a").addClass("disabled").unbind("click",function(e){return e.preventDefault(),!1}),window.location="admin.php?page=Zotpress&api_user_id="+e}),jQuery("div.zp-List").delegate("div.zp-Entry-Image","mouseenter mouseleave",function(){jQuery(this).toggleClass("hover")}),jQuery("input#zp-Zotpress-Setup-Options-Complete").click(function(){return window.parent.location="admin.php?page=Zotpress&accounts=true",!1}),jQuery("#zp-Connect").click(function(){return jQuery("input[name!=update], textarea, select").attr("disabled","true"),jQuery(".zp-Errors").hide(),jQuery(".zp-Success").hide(),jQuery(".zp-Loading").show(),jQuery.ajax({url:zpAccountsAJAX.ajaxurl,data:{action:"zpAccountsViaAJAX",action_type:"add_account",account_type:jQuery("select[name=account_type] option:selected").val(),api_user_id:jQuery("input[name=api_user_id]").val(),public_key:jQuery("input[name=public_key]").val(),nickname:escape(jQuery("input[name=nickname]").val()),zpAccountsAJAX_nonce:zpAccountsAJAX.zpAccountsAJAX_nonce},xhrFields:{withCredentials:!0},success:function(e){"true"==jQuery("result",e).attr("success")?(jQuery("div.zp-Errors").hide(),jQuery(".zp-Loading").hide(),jQuery("div.zp-Success").html("<p><strong>"+zpAccountsAJAX.txt_success+"!</strong> "+zpAccountsAJAX.txt_accvalid+"</p>\n"),jQuery("div.zp-Success").show(),jQuery("div#zp-Setup").length>0?jQuery.doTimeout(1e3,function(){window.parent.location="admin.php?page=Zotpress&setup=true&setupstep=two"}):jQuery.doTimeout(1e3,function(){jQuery("div#zp-AddAccount").slideUp("fast"),jQuery("form#zp-Add")[0].reset(),jQuery("input[name!=update], textarea, select").removeAttr("disabled"),jQuery("div.zp-Success").hide(),DisplayAccounts()})):(jQuery("input, textarea, select").removeAttr("disabled"),jQuery("div.zp-Errors").html("<p><strong>"+zpAccountsAJAX.txt_oops+"</strong> "+jQuery("errors",e).text()+"</p>\n"),jQuery("div.zp-Errors").show(),jQuery(".zp-Loading").hide())},error:function(e){console.log(e)}}),!1}),jQuery("#zp-Accounts").delegate("a.delete","click",function(){return $this=jQuery(this),$thisProject=$this.parent().parent(),1==confirm(zpAccountsAJAX.txt_sureremove)&&jQuery.ajax({url:zpAccountsAJAX.ajaxurl,data:{action:"zpAccountsViaAJAX",action_type:"delete_account",api_user_id:$this.attr("href").replace("#",""),zpAccountsAJAX_nonce:zpAccountsAJAX.zpAccountsAJAX_nonce},xhrFields:{withCredentials:!0},success:function(e){"true"==jQuery("result",e).attr("success")?0==jQuery("result",e).attr("total_accounts")?window.location="admin.php?page=Zotpress":window.location="admin.php?page=Zotpress&accounts=true":alert("Sorry - couldn't delete that account.")},error:function(e){console.log(e)}}),!1}),jQuery("#zp-Accounts").delegate("a.cache","click",function(){return $this=jQuery(this),$thisProject=$this.parent().parent(),1==confirm(zpAccountsAJAX.txt_surecache)&&($this.removeClass("dashicons-image-rotate").addClass("loading"),jQuery.ajax({url:zpAccountsAJAX.ajaxurl,data:{action:"zpAccountsViaAJAX",action_type:"clear_cache",api_user_id:$this.attr("href").replace("#",""),zpAccountsAJAX_nonce:zpAccountsAJAX.zpAccountsAJAX_nonce},xhrFields:{withCredentials:!0},complete:function(){$this.removeClass("loading").addClass("dashicons-image-rotate")},success:function(e){"true"==jQuery("result",e).attr("success")?(jQuery("#zp-ManageAccounts").prepend("<div class='notice notice-success Zotpress_update_notice'><p>"+zpAccountsAJAX.txt_cachecleared+"</p></div>"),jQuery("#zp-ManageAccounts .notice").delay(2e3).animate({height:"toggle",opacity:"toggle"},"fast",function(){jQuery(this).remove()})):alert("Sorry - couldn't clear the cache for that account.")},error:function(e){console.log(e)}})),!1}),jQuery(".zp-Account-Default").length>0&&(1==jQuery(".zp-IsDefaultAccount").length?jQuery(".zp-Account-Default").click(function(e){e.preventDefault()}).addClass("inactive"):jQuery(".zp-Account-Default").click(function(){var e=jQuery(this);e.addClass("loading");var t="button",s="";return"undefined"!=e.attr("rel")&&(t="icon",s=e.attr("rel")),jQuery("select#zp-Zotpress-Options-Account").length>0&&(t="form",s=jQuery("select#zp-Zotpress-Options-Account option:selected").val()),"form"==t&&(jQuery(this).attr("disabled","true"),jQuery("#zp-Zotpress-Options-Account .zp-Loading").show()),jQuery.ajax({url:zpAccountsAJAX.ajaxurl,data:{action:"zpAccountsViaAJAX",action_type:"default_account",api_user_id:s,zpAccountsAJAX_nonce:zpAccountsAJAX.zpAccountsAJAX_nonce},xhrFields:{withCredentials:!0},success:function(s){var r=jQuery("result",s).attr("success");"form"==t?(jQuery("#zp-Zotpress-Options-Account .zp-Loading").hide(),jQuery("input#zp-Zotpress-Options-Account-Button").removeAttr("disabled"),"true"==r?(jQuery("#zp-Zotpress-Options-Account div.zp-Errors").hide(),jQuery("#zp-Zotpress-Options-Account div.zp-Success").show(),jQuery.doTimeout(1e3,function(){jQuery("#zp-Zotpress-Options-Account div.zp-Success").hide()})):(jQuery("#zp-Zotpress-Options-Account div.zp-Errors").html("<p>"+jQuery("errors",s).text()+"</p>\n"),jQuery("#zp-Zotpress-Options-Account div.zp-Errors").show())):(e.removeClass("success loading"),"true"==r?(jQuery(".zp-Account-Default").removeClass("dashicons-star-filled").addClass("dashicons-star-empty"),e.removeClass("dashicons-star-empty").addClass("dashicons-star-filled"),e.hasClass("zp-Account-Default")&&e.addClass("disabled").text(zpAccountsAJAX.txt_default)):alert(jQuery("errors",s).text()))},error:function(e){console.log(e)}}),!1})),jQuery("select#zp-Zotpress-Options-Style").length>0&&(jQuery("#zp-Zotpress-Options-Style").change(function(){"new-style"===this.value?jQuery("#zp-Zotpress-Options-Style-New-Container").show():(jQuery("#zp-Zotpress-Options-Style-New-Container").hide(),jQuery("#zp-Zotpress-Options-Style-New").val(""))}),jQuery("#zp-Zotpress-Options-Style-Button").click(function(){var e=jQuery(this),t=!1;e.addClass("loading");var s=jQuery("select#zp-Zotpress-Options-Style").val();return"new-style"==s&&(s=jQuery("#zp-Zotpress-Options-Style-New").val(),t=!0),""!=s?(jQuery(this).attr("disabled","true"),jQuery("#zp-Zotpress-Options-Style-Container .zp-Loading").show(),jQuery.ajax({url:zpAccountsAJAX.ajaxurl,data:{action:"zpAccountsViaAJAX",action_type:"default_style",style:s,zpAccountsAJAX_nonce:zpAccountsAJAX.zpAccountsAJAX_nonce},xhrFields:{withCredentials:!0},success:function(e){var r=jQuery("result",e).attr("success");jQuery("input#zp-Zotpress-Options-Style-Button").removeAttr("disabled"),jQuery("#zp-Zotpress-Options-Style-Container .zp-Loading").hide(),"true"==r?(jQuery("#zp-Zotpress-Options-Style-Container div.zp-Errors").hide(),jQuery("#zp-Zotpress-Options-Style-Container div.zp-Success").show(),jQuery.doTimeout(1e3,function(){jQuery("#zp-Zotpress-Options-Style-Container div.zp-Success").hide(),!0===t&&(jQuery("#zp-Zotpress-Options-Style").prepend(jQuery("<option/>",{value:s,text:s,selected:"selected"})),jQuery("#zp-Zotpress-Options-Style-New-Container").hide(),jQuery("#zp-Zotpress-Options-Style-New").val(""))})):(jQuery("#zp-Zotpress-Options-Style-Container div.zp-Errors").html(jQuery("errors",e).text()+"\n"),jQuery("#zp-Zotpress-Options-Style-Container div.zp-Errors").show())},error:function(e){console.log(e)}})):(jQuery("#zp-Zotpress-Options-Style-Container div.zp-Errors").html("No style was entered.\n"),jQuery("#zp-Zotpress-Options-Style-Container div.zp-Errors").show()),!1})),jQuery("#zp-Zotpress-Options-CPT-Button").click(function(){jQuery(this);var e="";return jQuery("input[name='zp-CTP']:checked").each(function(){e=e+","+jQuery(this).val()}),""!=e?(jQuery(this).attr("disabled","true"),jQuery("#zp-Zotpress-Options-CPT .zp-Loading").show(),jQuery.ajax({url:zpAccountsAJAX.ajaxurl,data:{action:"zpAccountsViaAJAX",action_type:"ref_widget_cpt",cpt:e,zpAccountsAJAX_nonce:zpAccountsAJAX.zpAccountsAJAX_nonce},xhrFields:{withCredentials:!0},success:function(e){var t=jQuery("result",e).attr("success");jQuery("#zp-Zotpress-Options-CPT .zp-Loading").hide(),jQuery("input#zp-Zotpress-Options-CPT-Button").removeAttr("disabled"),"true"==t?(jQuery("#zp-Zotpress-Options-CPT div.zp-Errors").hide(),jQuery("#zp-Zotpress-Options-CPT div.zp-Success").show(),jQuery.doTimeout(1e3,function(){jQuery("#zp-Zotpress-Options-CPT div.zp-Success").hide()})):(jQuery("#zp-Zotpress-Options-CPT div.zp-Errors").html("<p>"+jQuery("errors",e).text()+"</p>\n"),jQuery("#zp-Zotpress-Options-CPT div.zp-Errors").show())},error:function(e){console.log(e)}})):(jQuery("#zp-Zotpress-Options-CPT div.zp-Errors").html("No content type was selected.\n"),jQuery("#zp-Zotpress-Options-CPT div.zp-Errors").show()),!1}),jQuery("#zp-Zotpress-Options-Reset-Button").click(function(){jQuery(this);return 1==confirm(zpAccountsAJAX.txt_surereset)&&(jQuery(this).attr("disabled","true"),jQuery("#zp-Zotpress-Options-Reset .zp-Loading").show(),jQuery(this).attr("disabled","true"),jQuery("#zp-Zotpress-Options-Reset .zp-Loading").show(),jQuery.ajax({url:zpAccountsAJAX.ajaxurl,data:{action:"zpAccountsViaAJAX",action_type:"reset",reset:"true",zpAccountsAJAX_nonce:zpAccountsAJAX.zpAccountsAJAX_nonce},xhrFields:{withCredentials:!0},success:function(e){var t=jQuery("result",e).attr("success");jQuery("#zp-Zotpress-Options-Reset .zp-Loading").hide(),jQuery("input#zp-Zotpress-Options-Reset-Button").removeAttr("disabled"),"true"==t?(jQuery("#zp-Zotpress-Options-Reset div.zp-Errors").hide(),jQuery("#zp-Zotpress-Options-Reset div.zp-Success").show(),jQuery.doTimeout(1e3,function(){jQuery("#zp-Zotpress-Options-Reset div.zp-Success").hide(),window.parent.location="admin.php?page=Zotpress"})):(jQuery("#zp-Zotpress-Options-Reset div.zp-Errors").html("<p>"+jQuery("errors",e).text()+"</p>\n"),jQuery("#zp-Zotpress-Options-Reset div.zp-Errors").show())},error:function(e){console.log(e)}})),!1}),jQuery(".zp-List").on("click",".zp-Entry-Image a.upload",function(t){t.preventDefault(),$this=jQuery(this),e?e.open():((e=wp.media.frames.file_frame=wp.media({title:zpAccountsAJAX.txt_chooseimg,button:{text:zpAccountsAJAX.txt_chooseimg},multiple:!1})).on("select",function(){attachment=e.state().get("selection").first().toJSON(),jQuery.ajax({url:zpAccountsAJAX.ajaxurl,data:{action:"zpAccountsViaAJAX",action_type:"add_image",api_user_id:jQuery(".ZP_API_USER_ID").text(),item_key:$this.attr("rel"),image_id:attachment.id,zpAccountsAJAX_nonce:zpAccountsAJAX.zpAccountsAJAX_nonce},success:function(e){if("true"==jQuery("result",e).attr("success")){console.log("zp: Found image to set.");var t="";attachment.sizes.hasOwnProperty("thumbnail")?t=attachment.sizes.thumbnail.url:attachment.sizes.hasOwnProperty("full")&&(t=attachment.sizes.full.url),$this.parent().find(".thumb").length>0?$this.parent().find(".thumb").attr("src",t):($this.parent().addClass("hasImage"),$this.parent().prepend("<img class='thumb' src='"+t+"' alt='image'>")),$this.text(zpAccountsAJAX.txt_changeimg),$this.parent().prepend("<a title='"+zpAccountsAJAX.txt_removeimg+"' class='delete' rel='"+$this.attr("rel")+"' href='#'>&times;</a>\n")}else alert("Sorry, featured image couldn't be set.")},error:function(e){console.log(e)}})}),e.open())}),jQuery(".zp-List").on("click",".zp-Entry-Image a.delete",function(e){e.preventDefault(),$this=jQuery(this),jQuery.ajax({url:zpAccountsAJAX.ajaxurl,data:{action:"zpAccountsViaAJAX",action_type:"remove_image",api_user_id:jQuery(".ZP_API_USER_ID").text(),item_key:$this.attr("rel"),zpAccountsAJAX_nonce:zpAccountsAJAX.zpAccountsAJAX_nonce},xhrFields:{withCredentials:!0},success:function(e){"true"==jQuery("result",e).attr("success")?($this.parent().removeClass("hasImage"),$this.parent().find(".thumb").remove(),jQuery(".upload",$this.parent()).text(zpAccountsAJAX.txt_setimg)):alert("Sorry, featured image couldn't be set.")},error:function(e){console.log(e)}})})});
