jQuery(document).ready(function(){if(jQuery("#zp-ZotpressMetaBox").length>0){jQuery("#zp-ZotpressMetaBox").tabs({activate:function(event,ui){if(ui.newPanel.attr('id')=="zp-ZotpressMetaBox-InText")
jQuery("#zp-ZotpressMetaBox-List").addClass("intext");else jQuery("#zp-ZotpressMetaBox-List").removeClass("intext")}})}
window.zpBiblio={"author":!1,"year":!1,"style":!1,"sortby":!1,"sort":!1,"image":!1,"download":!1,"notes":!1,"zpabstract":!1,"cite":!1,"title":!1,"limit":!1};window.zpInText={"format":!1,"etal":!1,"and":!1,"separator":!1,"brackets":!1};window.zpInTextBib={"style":!1,"sortby":!1,"sort":!1,"image":!1,"title":!1,"download":!1,"zpabstract":!1,"notes":!1,"cite":!1};window.zpRefItems=[];jQuery("input#zp-ZotpressMetaBox-Search-Input").bind("keydown",function(event){if(event.keyCode===13)
event.preventDefault()}).bind("focus",function(event){jQuery(this).autocomplete('option','source',zpWidgetMetabox.ajaxurl+"?action=zpWidgetMetabox-submit&api_user_id="+jQuery("#zp-ZotpressMetaBox-Acccount-Select").val());jQuery("#zp-ZotpressMetaBox-Biblio-Generate-Inner").hide('fast');jQuery("#zp-ZotpressMetaBox-InText-Generate-Inner").hide('fast')}).bind("blur",function(event){}).autocomplete({source:zpWidgetMetabox.ajaxurl+"?action=zpWidgetMetabox-submit&api_user_id="+jQuery("#zp-ZotpressMetaBox-Acccount-Select").val(),minLength:3,focus:function(){return!1},create:function(){jQuery(this).data("ui-autocomplete")._renderItem=function(ul,item){return jQuery("<li data-api_user_id='"+item.api_user_id+"'>").append("<a><strong>"+item.author+"</strong> "+item.label+"</a>").appendTo(ul)}},open:function(){var widget=jQuery(this).data('ui-autocomplete'),menu=widget.menu,$ul=menu.element;menu.element.addClass("zp-autocomplete");jQuery(".zp-autocomplete .ui-menu-item:first").addClass("first");if(jQuery("#ZotpressMetaBox").parent().attr("id")=="normal-sortables")
menu.element.addClass("zp-autocomplete-wide");else menu.element.removeClass("zp-autocomplete-wide")},select:function(event,ui){var check=!1;jQuery.each(window.zpRefItems,function(index,item){if(item.itemkey==ui.item.value)
check=!0});if(check===!1){window.zpRefItems.push({"api_user_id":ui.item.api_user_id,"itemkey":ui.item.value,"pages":!1});var uilabel=(ui.item.label).split(")",1)+")";var content="<div class='item' rel='"+ui.item.value+"' data-api_user_id='"+ui.item.api_user_id+"'";if(ui.item.nickname)
content+=" data-nickname='"+ui.item.nickname+"'";content+=">";content+="<span class='label'>"+ui.item.author+ui.item.label+"</span>";content+="<div class='options'>";content+="<label for='zp-Item-"+ui.item.value+"'>"+zpWidgetMetabox.txt_pages+":</label><input id='zp-Item-"+ui.item.value+"' type='text'>";content+="</div>";content+="<div class='item_key'>&rsaquo; "+zpWidgetMetabox.txt_itemkey+": <strong>"+ui.item.value+"</strong></div>";content+="<div class='account'";if(ui.item.nickname)
content+=" data-nickname='"+ui.item.nickname+"'";content+="data-api_user_id='"+ui.item.api_user_id+"'>&rsaquo; "+zpWidgetMetabox.txt_account+": <strong>";if(ui.item.nickname)
content+=ui.item.nickname+" - ";content+=ui.item.api_user_id+"</strong></div>";content+="<div class='delete'>&times;</div>";content+="</div>\n";jQuery("#zp-ZotpressMetaBox-List-Inner").append(content);jQuery("input#zp-ZotpressMetaBox-Search-Input").val("").focus()}
return!1}});jQuery("#zp-ZotpressMetaBox-List div.item .delete").livequery('click',function(event){var $parent=jQuery(this).parent();if(jQuery(".toggle",$parent).hasClass("active")){jQuery(this).toggleClass("active");jQuery(".options",$parent).slideToggle('fast')}
jQuery.each(window.zpRefItems,function(index,item){if(item.itemkey==$parent.attr("rel"))
window.zpRefItems.splice(index,1)});$parent.remove();jQuery("#zp-ZotpressMetaBox-Biblio-Generate-Inner").hide('fast');jQuery("#zp-ZotpressMetaBox-InText-Generate-Inner").hide('fast')});jQuery("#zp-ZotpressMetaBox-List div.item").livequery('click',function(event){jQuery("#zp-ZotpressMetaBox-Biblio-Generate-Inner").hide('fast')});jQuery("#zp-ZotpressMetaBox-Biblio-Options").click(function(event){jQuery("#zp-ZotpressMetaBox-Biblio-Generate-Inner").hide('fast')});jQuery("#zp-ZotpressMetaBox-InText-Options").click(function(event){jQuery("#zp-ZotpressMetaBox-InText-Generate-Inner").hide('fast')});jQuery("#zp-ZotpressMetaBox-Biblio-Options h4 .toggle").click(function(event){jQuery(this).toggleClass("active");jQuery(".toggle-button",jQuery(this)).toggleClass("dashicons-arrow-down-alt2 dashicons-arrow-up-alt2");jQuery("#zp-ZotpressMetaBox-Biblio-Options-Inner").slideToggle('fast')});jQuery("#zp-ZotpressMetaBox-InText-Options h4 .toggle").click(function(event){jQuery(this).toggleClass("active");jQuery(".toggle-button",jQuery(this)).toggleClass("dashicons-arrow-down-alt2 dashicons-arrow-up-alt2");jQuery("#zp-ZotpressMetaBox-InText-Options-Inner").slideToggle('fast')});jQuery("#zp-ZotpressMetaBox-InTextBib-Options h4 .toggle").click(function(event){jQuery(this).toggleClass("active");jQuery(".toggle-button",jQuery(this)).toggleClass("dashicons-arrow-down-alt2 dashicons-arrow-up-alt2");jQuery("#zp-ZotpressMetaBox-InTextBib-Options-Inner").slideToggle('fast')});jQuery("#zp-ZotpressMetaBox-Biblio-Generate-Button").click(function(event){if(!jQuery(this).parent().parent().parent().parent().hasClass("zp-ShortcodeBuilder")){jQuery("#zp-ZotpressMetaBox-Biblio-Generate-Text").text(window.zpGenerateShortcodeString("bib"));jQuery("#zp-ZotpressMetaBox-Biblio-Generate-Inner").slideDown('fast')}});jQuery("#zp-ZotpressMetaBox-InText-Generate-Button").click(function(event){if(!jQuery(this).parent().parent().parent().parent().hasClass("zp-ShortcodeBuilder")){jQuery("#zp-ZotpressMetaBox-InText-Generate-Text").text(window.zpGenerateShortcodeString("intext"));jQuery("#zp-ZotpressMetaBox-InText-Generate-Inner").slideDown('fast')}});jQuery("#zp-ZotpressMetaBox-InTextBib-Generate-Button").click(function(event){if(!jQuery(this).parent().parent().parent().parent().hasClass("zp-ShortcodeBuilder")){jQuery("#zp-ZotpressMetaBox-InTextBib-Generate-Text").text(window.zpGenerateShortcodeString("intextbib"));jQuery("#zp-ZotpressMetaBox-InTextBib-Generate-Inner").slideDown('fast')}});jQuery("#zp-ZotpressMetaBox-Biblio-Clear-Button").click(function(event){window.zpBiblio.author=!1;window.zpBiblio.year=!1;window.zpBiblio.style=!1;window.zpBiblio.sortby=!1;window.zpBiblio.sort=!1;window.zpBiblio.image=!1;window.zpBiblio.title=!1;window.zpBiblio.download=!1;window.zpBiblio.notes=!1;window.zpBiblio.zpabstract=!1;window.zpBiblio.cite=!1;window.zpBiblio.limit=!1;jQuery.each(window.zpRefItems,function(index,item){window.zpRefItems.splice(index,1)});jQuery("#zp-ZotpressMetaBox-Biblio-Options-Inner").slideUp('fast');jQuery("#zp-ZotpressMetaBox-Biblio-Options h4 .toggle").removeClass("active");jQuery("#zp-ZotpressMetaBox-Biblio-Generate-Inner").slideUp('fast');jQuery("#zp-ZotpressMetaBox-Biblio-Options-Author").val("");jQuery("#zp-ZotpressMetaBox-Biblio-Options-Year").val("");jQuery("#zp-ZotpressMetaBox-Biblio-Options-Limit").val("");jQuery("#zp-ZotpressMetaBox-Biblio-Options-Style option").removeAttr('checked');jQuery("#zp-ZotpressMetaBox-Biblio-Options-Style").val(jQuery("#zp-ZotpressMetaBox-Biblio-Options-Style option[rel='default']").val());jQuery("#zp-ZotpressMetaBox-Biblio-Options .zp-ZotpressMetaBox-Field-Radio input[type='radio']").prop('checked',!1);jQuery("div#zp-ZotpressMetaBox-List div.item").remove()});jQuery("#zp-ZotpressMetaBox-InText-Clear-Button").click(function(event){window.zpInText.format=!1;window.zpInText.brackets=!1;window.zpInText.etal=!1;window.zpInText.and=!1;window.zpInText.separator=!1;jQuery.each(window.zpRefItems,function(index,item){window.zpRefItems.splice(index,1)});jQuery("#zp-ZotpressMetaBox-InText-Options-Inner").slideUp('fast');jQuery("#zp-ZotpressMetaBox-InText-Options h4 .toggle").removeClass("active");jQuery("#zp-ZotpressMetaBox-InText-Generate-Inner").slideUp('fast');jQuery("#zp-ZotpressMetaBox-InText-Options-Format").val("(%a%, %d%, %p%)");jQuery("#zp-ZotpressMetaBox-InText-Options-Brackets").val("default");jQuery("#zp-ZotpressMetaBox-InText-Options-Etal").val("default");jQuery("#zp-ZotpressMetaBox-InText-Options-And").val("default");jQuery("#zp-ZotpressMetaBox-InText-Options-Separator").val("default");jQuery("div#zp-ZotpressMetaBox-List div.item").remove()});jQuery("#zp-ZotpressMetaBox-InTextBib-Clear-Button").click(function(event){window.zpInText.style=!1;window.zpInText.sortby=!1;window.zpInText.sort=!1;window.zpInText.image=!1;window.zpInText.title=!1;window.zpInText.download=!1;window.zpInText.zpabstract=!1;window.zpInText.notes=!1;window.zpInText.cite=!1;jQuery("#zp-ZotpressMetaBox-InTextBib-Options-Inner").slideUp('fast');jQuery("#zp-ZotpressMetaBox-InTextBib-Options h4 .toggle").removeClass("active");jQuery("#zp-ZotpressMetaBox-InTextBib-Generate-Inner").slideUp('fast');jQuery("#zp-ZotpressMetaBox-InTextBib-Options-Style option").removeAttr('checked');jQuery("#zp-ZotpressMetaBox-InTextBib-Options-Style").val(jQuery("#zp-ZotpressMetaBox-InTextBib-Options-Style option[rel='default']").val());jQuery("#zp-ZotpressMetaBox-InTextBib-Options-SortBy option").removeAttr('checked');jQuery("#zp-ZotpressMetaBox-InTextBib-Options-SortBy").val(jQuery("#zp-ZotpressMetaBox-InTextBib-Options-SortBy option[rel='default']").val());jQuery("#zp-ZotpressMetaBox-InTextBib-Options .zp-ZotpressMetaBox-Field-Radio input[type='radio']").prop('checked',!1)});window.zpGenerateShortcodeString=function(scType="bib"){var zpBiblioShortcode="";if(scType=="bib"){window.zpBiblio.author=jQuery.trim(jQuery("#zp-ZotpressMetaBox-Biblio-Options-Author").val());window.zpBiblio.year=jQuery.trim(jQuery("#zp-ZotpressMetaBox-Biblio-Options-Year").val());window.zpBiblio.style=jQuery.trim(jQuery("#zp-ZotpressMetaBox-Biblio-Options-Style").val());window.zpBiblio.sortby=jQuery.trim(jQuery("#zp-ZotpressMetaBox-Biblio-Options-SortBy").val());window.zpBiblio.limit=jQuery.trim(jQuery("#zp-ZotpressMetaBox-Biblio-Options-Limit").val());if(jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Sort-ASC").is(':checked')===!0)
window.zpBiblio.sort="ASC";if(jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Sort-DESC").is(':checked')===!0)
window.zpBiblio.sort="DESC";if(jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Image-Yes").is(':checked')===!0)
window.zpBiblio.image="yes";else window.zpBiblio.image="";if(jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Title-Yes").is(':checked')===!0)
window.zpBiblio.title="yes";else window.zpBiblio.title="";if(jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Download-Yes").is(':checked')===!0)
window.zpBiblio.download="yes";else window.zpBiblio.download="";if(jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Abstract-Yes").is(':checked')===!0)
window.zpBiblio.zpabstract="yes";else window.zpBiblio.zpabstract="";if(jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Notes-Yes").is(':checked')===!0)
window.zpBiblio.notes="yes";else window.zpBiblio.notes="";if(jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Cite-Yes").is(':checked')===!0)
window.zpBiblio.cite="yes";else window.zpBiblio.cite="";zpBiblioShortcode="[zotpress";if(window.zpRefItems.length>0){var tempItems="";jQuery.each(window.zpRefItems,function(index,item){if(index!="0")tempItems=tempItems+",";tempItems=tempItems+"{"+item.api_user_id+":"+item.itemkey+"}"});zpBiblioShortcode+=" items=\""+tempItems+"\""}
if(window.zpBiblio.author!="")zpBiblioShortcode+=" author=\""+window.zpBiblio.author+"\"";if(window.zpBiblio.year!="")zpBiblioShortcode+=" year=\""+window.zpBiblio.year+"\"";if(window.zpBiblio.style!="")zpBiblioShortcode+=" style=\""+window.zpBiblio.style+"\"";if(window.zpBiblio.sortby!=""&&window.zpBiblio.sortby!="default")zpBiblioShortcode+=" sortby=\""+window.zpBiblio.sortby+"\"";if(window.zpBiblio.sort!="")zpBiblioShortcode+=" sort=\""+window.zpBiblio.sort+"\"";if(window.zpBiblio.image!="")zpBiblioShortcode+=" showimage=\""+window.zpBiblio.image+"\"";if(window.zpBiblio.download!="")zpBiblioShortcode+=" download=\""+window.zpBiblio.download+"\"";if(window.zpBiblio.zpabstract!="")zpBiblioShortcode+=" abstract=\""+window.zpBiblio.zpabstract+"\"";if(window.zpBiblio.notes!="")zpBiblioShortcode+=" notes=\""+window.zpBiblio.notes+"\"";if(window.zpBiblio.cite!="")zpBiblioShortcode+=" cite=\""+window.zpBiblio.cite+"\"";if(window.zpBiblio.title!="")zpBiblioShortcode+=" title=\""+window.zpBiblio.title+"\"";if(window.zpBiblio.limit!="")zpBiblioShortcode+=" limit=\""+window.zpBiblio.limit+"\"";zpBiblioShortcode+="]"}else if(scType=="intext"){jQuery("#zp-ZotpressMetaBox-List .item").each(function(vindex,vitem){if(jQuery.trim(jQuery("input",vitem).val()).length>0){jQuery.each(window.zpRefItems,function(index,item){if(item.itemkey==jQuery(vitem).attr("rel")){item.pages=jQuery.trim(jQuery("input",vitem).val())}})}});window.zpInText.format=jQuery.trim(jQuery("#zp-ZotpressMetaBox-InText-Options-Format").val());window.zpInText.brackets=jQuery.trim(jQuery("#zp-ZotpressMetaBox-InText-Options-Brackets").val());window.zpInText.etal=jQuery.trim(jQuery("#zp-ZotpressMetaBox-InText-Options-Etal").val());window.zpInText.and=jQuery.trim(jQuery("#zp-ZotpressMetaBox-InText-Options-And").val());window.zpInText.separator=jQuery.trim(jQuery("#zp-ZotpressMetaBox-InText-Options-Separator").val());zpBiblioShortcode="[zotpressInText";if(window.zpRefItems.length>0){zpBiblioShortcode+=" item=\"";jQuery.each(window.zpRefItems,function(index,item){zpBiblioShortcode+="{"+item.api_user_id+":"+item.itemkey;if(item.pages!==!1)zpBiblioShortcode+=","+item.pages;zpBiblioShortcode+="},"});zpBiblioShortcode=zpBiblioShortcode.substring(0,zpBiblioShortcode.length-1)+"\""}
if(window.zpInText.format!=""&&window.zpInText.format!="(%a%, %d%, %p%)")
zpBiblioShortcode+=" format=\""+window.zpInText.format+"\"";if(window.zpInText.brackets!=""&&window.zpInText.brackets!="default")
zpBiblioShortcode+=" brackets=\""+window.zpInText.brackets+"\"";if(window.zpInText.etal!=""&&window.zpInText.etal!="default")
zpBiblioShortcode+=" etal=\""+window.zpInText.etal+"\"";if(window.zpInText.and!=""&&window.zpInText.and!="default")
zpBiblioShortcode+=" and=\""+window.zpInText.and+"\"";if(window.zpInText.separator!=""&&window.zpInText.separator!="default")
zpBiblioShortcode+=" separator=\""+window.zpInText.separator+"\"";zpBiblioShortcode+="]"}else if(scType=="intextbib"){window.zpInTextBib.style=jQuery.trim(jQuery("#zp-ZotpressMetaBox-InTextBib-Options-Style").val());window.zpInTextBib.sortby=jQuery.trim(jQuery("#zp-ZotpressMetaBox-InTextBib-Options-SortBy").val());if(jQuery("input#zp-ZotpressMetaBox-InTextBib-Options-Sort-ASC").is(':checked')===!0)
window.zpInTextBib.sort="ASC";if(jQuery("input#zp-ZotpressMetaBox-InTextBib-Options-Sort-DESC").is(':checked')===!0)
window.zpInTextBib.sort="DESC";if(jQuery("input#zp-ZotpressMetaBox-InTextBib-Options-Image-Yes").is(':checked')===!0)
window.zpInTextBib.image="yes";else window.zpInTextBib.image="";if(jQuery("input#zp-ZotpressMetaBox-InTextBib-Options-Title-Yes").is(':checked')===!0)
window.zpInTextBib.title="yes";else window.zpInTextBib.title="";if(jQuery("input#zp-ZotpressMetaBox-InTextBib-Options-Download-Yes").is(':checked')===!0)
window.zpInTextBib.download="yes";else window.zpInTextBib.download="";if(jQuery("input#zp-ZotpressMetaBox-InTextBib-Options-Abstract-Yes").is(':checked')===!0)
window.zpInTextBib.zpabstract="yes";else window.zpInTextBib.zpabstract="";if(jQuery("input#zp-ZotpressMetaBox-InTextBib-Options-Notes-Yes").is(':checked')===!0)
window.zpInTextBib.notes="yes";else window.zpInTextBib.notes="";if(jQuery("input#zp-ZotpressMetaBox-InTextBib-Options-Cite-Yes").is(':checked')===!0)
window.zpInTextBib.cite="yes";else window.zpInTextBib.cite="";zpBiblioShortcode="[zotpressInTextBib";if(window.zpInTextBib.style!="")zpBiblioShortcode+=" style=\""+window.zpInTextBib.style+"\"";if(window.zpInTextBib.sortby!=""&&window.zpInTextBib.sortby!="default")zpBiblioShortcode+=" sortby=\""+window.zpInTextBib.sortby+"\"";if(window.zpInTextBib.sort!="")zpBiblioShortcode+=" sort=\""+window.zpInTextBib.sort+"\"";if(window.zpInTextBib.image!="")zpBiblioShortcode+=" showimage=\""+window.zpInTextBib.image+"\"";if(window.zpInTextBib.title!="")zpBiblioShortcode+=" title=\""+window.zpInTextBib.title+"\"";if(window.zpInTextBib.download!="")zpBiblioShortcode+=" download=\""+window.zpInTextBib.download+"\"";if(window.zpInTextBib.zpabstract!="")zpBiblioShortcode+=" abstract=\""+window.zpInTextBib.zpabstract+"\"";if(window.zpInTextBib.notes!="")zpBiblioShortcode+=" notes=\""+window.zpInTextBib.notes+"\"";if(window.zpInTextBib.cite!="")zpBiblioShortcode+=" cite=\""+window.zpInTextBib.cite+"\"";zpBiblioShortcode+="]"}
return zpBiblioShortcode}})
