(()=>{"use strict";const e=window.React,t=window.ReactDOM,a=window.wp.i18n,r=e=>"#"===e[0]?document.getElementById(e.slice(1)):document.querySelectorAll(e),s=window.wp.url,o=function(e,t){const a=`save-changes-${Date.now()}`,s=r("#spinner-save-changes");s.parentNode.insertAdjacentHTML("afterend",`<div id="${a}" class="ajax-alert notice notice-${e}"><p>${t}</p></div>`),s.remove();const o=r(`#${a}`);o.offsetWidth,o.style.opacity=0,o.addEventListener("transitionend",(()=>o.remove())),r(".button-save-changes").forEach((e=>e.disabled=!1)),document.body.classList.remove("wait")},c=(e,t,c)=>{if(t.active&&""===t.path.trim())return window.alert((0,a.__)("You must set a server path for the automatic table export.","tablepress")),void c.current.focus();if(t.active&&0===t.selectedFormats.length)return void window.alert((0,a.__)("You must select at least one export format for the automatic table export.","tablepress"));var n;n={action:"tablepress_export",_ajax_nonce:r("#_wpnonce").value,tablepress:JSON.stringify(t)},e.insertAdjacentHTML("beforeend",`<span id="spinner-save-changes" class="spinner-save-changes spinner is-active" title="${(0,a.__)("Changes are being saved â€¦","tablepress")}"></span>`),r(".button-save-changes").forEach((e=>e.disabled=!0)),document.body.classList.add("wait"),fetch(ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:(0,s.buildQueryString)(n)}).then((e=>{if(!e.ok)throw new Error(`There was a problem with the server, HTTP response code ${e.status} (${e.statusText}).`);return e.json()})).then((e=>{if(null==e||"-1"===e||void 0===e.success)throw new Error("The JSON data returned from the server is unclear or incomplete.");if(!0!==e.success){const t=e.error_details?`</p><p>These errors were encountered:</p><pre>${e.error_details}</pre><p>`:"";throw new Error(`The data could not be saved to the database properly.${t}`)}!function(e){const t={success_save:(0,a.__)("The changes were saved successfully.","tablepress"),error_save:(0,a.__)("Attention: Unfortunately, an error occurred.","tablepress")},r=e.message.includes("error")?"error":"success";o(r,t[e.message])}(e)})).catch((e=>{return t=e.message,t=(0,a.__)("Attention: Unfortunately, an error occurred.","tablepress")+" "+t,void o("error",t);var t}))},n=Object.entries(tp.automatic_table_export.csvDelimiters).map((([t,a])=>(0,e.createElement)("option",{key:t,value:t},a)));((e,a)=>{const r=document.getElementById("tablepress-automatic-table-export-screen");r&&("function"==typeof t.createRoot?(0,t.createRoot)(r).render(a):(0,t.render)(a,r))})(0,(0,e.createElement)((()=>{const[t,r]=(0,e.useState)({active:tp.automatic_table_export.active,path:tp.automatic_table_export.path,selectedFormats:tp.automatic_table_export.selectedFormats,csvDelimiter:tp.automatic_table_export.csvDelimiter}),s=(0,e.useRef)(null),o=e=>{const a={...t,...e};r(a)};return(0,e.createElement)(e.Fragment,null,(0,e.createElement)("p",null,(0,a.__)("To automatically export a table to a file on your server after it has been edited, configure the desired path and export formats below.","tablepress")),(0,e.createElement)("table",{className:"tablepress-postbox-table fixed"},(0,e.createElement)("tbody",null,(0,e.createElement)("tr",{className:"bottom-border"},(0,e.createElement)("th",{className:"column-1",scope:"row"}),(0,e.createElement)("td",{className:"column-2"},(0,e.createElement)("label",{htmlFor:"auto-export-active"},(0,e.createElement)("input",{type:"checkbox",id:"auto-export-active",checked:t.active,onChange:()=>o({active:!t.active})})," ",(0,a.__)("Activate Automatic Table Export","tablepress")))),(0,e.createElement)("tr",{className:"top-border"},(0,e.createElement)("th",{className:"column-1",scope:"row"},(0,e.createElement)("label",{htmlFor:"auto-export-path"},(0,a.__)("Server Path","tablepress"),":")),(0,e.createElement)("td",{className:"column-2"},(0,e.createElement)("input",{ref:s,type:"text",id:"auto-export-path",className:"large-text code",disabled:!t.active,value:t.path,onChange:e=>o({path:e.target.value})}))),(0,e.createElement)("tr",{className:"top-border"},(0,e.createElement)("th",{className:"column-1 top-align",scope:"row"},(0,a.__)("Export Format","tablepress"),":"),(0,e.createElement)("td",{className:"column-2"},Object.entries(tp.automatic_table_export.exportFormats).map((([a,r])=>(0,e.createElement)(e.Fragment,{key:a},(0,e.createElement)("label",{htmlFor:`auto-export-format-${a}`},(0,e.createElement)("input",{type:"checkbox",id:`auto-export-format-${a}`,value:a,disabled:!t.active,checked:t.selectedFormats.includes(a),onChange:e=>{let a=[...t.selectedFormats];e.target.checked?a.push(e.target.value):a=a.filter((t=>t!==e.target.value)),o({selectedFormats:a})}})," ",r),(0,e.createElement)("br",null)))))),(0,e.createElement)("tr",{className:"top-border bottom-border"},(0,e.createElement)("th",{className:"column-1",scope:"row"},(0,e.createElement)("label",{htmlFor:"auto-export-csv-delimiter"},(0,a.__)("CSV Delimiter","tablepress"),":")),(0,e.createElement)("td",{className:"column-2"},(0,e.createElement)("select",{id:"auto-export-csv-delimiter",disabled:!t.active||!t.selectedFormats.includes("csv"),value:t.csvDelimiter,onChange:e=>o({csvDelimiter:e.target.value})},n),!t.selectedFormats.includes("csv")&&(0,e.createElement)(e.Fragment,null," ",(0,e.createElement)("span",{className:"description"},(0,a.__)("(Only needed for CSV export.)","tablepress"))))),(0,e.createElement)("tr",{className:"top-border"},(0,e.createElement)("td",{className:"column-1"}),(0,e.createElement)("td",{className:"column-2"},(0,e.createElement)("p",{style:{margin:"0"}},(0,e.createElement)("input",{type:"button",className:"button button-secondary button-large button-save-changes",value:(0,a.__)("Save Automatic Export configuration","tablepress"),onClick:e=>c(e.target.parentNode,t,s)})))))))}),null))})();