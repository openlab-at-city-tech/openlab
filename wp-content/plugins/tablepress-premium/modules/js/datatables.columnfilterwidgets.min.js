!function(e){e.fn.dataTableExt.oApi.fnGetColumnData=function(e,t){return e.oInstance.api().column(t,{search:"applied"}).data().sort().unique()};var t=function(t){var i=this;let o=Object.keys(t.aoColumns);return i.$WidgetContainer=e('<div class="column-filter-widgets"></div>'),i.$MenuContainer=i.$WidgetContainer,i.$TermContainer=null,i.aoWidgets=[],i.sSeparator="","oColumnFilterWidgets"in t.oInit&&("columns"in t.oInit.oColumnFilterWidgets&&(o=t.oInit.oColumnFilterWidgets.columns),"aiExclude"in t.oInit.oColumnFilterWidgets&&(o=o.filter((e=>!t.oInit.oColumnFilterWidgets.aiExclude.includes(parseInt(e,10))))),"bGroupTerms"in t.oInit.oColumnFilterWidgets&&t.oInit.oColumnFilterWidgets.bGroupTerms&&(i.$MenuContainer=e('<div class="column-filter-widget-menus"></div>'),i.$TermContainer=e('<div class="column-filter-widget-selected-terms"></div>').hide())),o.forEach((function(o){const a=e('<div class="column-filter-widget"></div>');i.aoWidgets.push(new n(a,t,o,i)),i.$MenuContainer.append(a)})),i.$TermContainer&&(i.$WidgetContainer.append(i.$MenuContainer),i.$WidgetContainer.append(i.$TermContainer)),t.aoDrawCallback.push({name:"ColumnFilterWidgets",fn(){e.each(i.aoWidgets,(function(e,t){t.fnDraw()}))}}),i};t.prototype.getContainer=function(){return this.$WidgetContainer.get(0)};var n=function(t,n,i,o){var a=this;a.iColumn=i,a.oColumn=n.aoColumns[i],a.$Container=t,a.oDataTable=n.oInstance,a.asFilters=[],a.sSeparator="",a.bSort=!0,a.iMaxSelections=-1,"oColumnFilterWidgets"in n.oInit&&("sSeparator"in n.oInit.oColumnFilterWidgets&&(a.sSeparator=n.oInit.oColumnFilterWidgets.sSeparator),"iMaxSelections"in n.oInit.oColumnFilterWidgets&&(a.iMaxSelections=n.oInit.oColumnFilterWidgets.iMaxSelections),"aoColumnDefs"in n.oInit.oColumnFilterWidgets&&e.each(n.oInit.oColumnFilterWidgets.aoColumnDefs,(function(t,n){("|"+n.aiTargets.join("|")+"|").indexOf("|"+i+"|")>=0&&e.each(n,(function(e,t){a[e]=t}))}))),a.$Select=e("<select></select>").addClass("widget-"+a.iColumn).on("change",(function(){var t,n,i,r=a.$Select.val();""!==r&&(t=e("<div>"+r+"</div>").text(),n=e('<a class="filter-term" href="#"></a>').addClass("filter-term-"+t.toLowerCase().replace(/\W/g,"")).text(t).on("click",(function(){return a.asFilters=e.grep(a.asFilters,(function(e){return e!==r})),n.remove(),o.$TermContainer&&0===o.$TermContainer.find(".filter-term").length&&o.$TermContainer.hide(),a.$Select.append(e("<option></option>").val(r).text(t)),a.iMaxSelections>0&&a.iMaxSelections>a.asFilters.length&&a.$Select.prop("disabled",!1),a.bSort&&a.fnSortOptions(),a.fnFilter(),!1})),a.asFilters.push(r),o.$TermContainer?(o.$TermContainer.show(),o.$TermContainer.prepend(n)):a.$Select.after(n),i=a.$Select.children("option:selected"),a.$Select.val(""),i.remove(),a.iMaxSelections>0&&a.iMaxSelections<=a.asFilters.length&&a.$Select.prop("disabled",!0),a.fnFilter())})),a.$Container.append(a.$Select),a.fnDraw()};n.prototype.fnFilter=function(){var t=this;if(t.asFilters.length>0){var n=[];e.each(t.asFilters,(function(e,t){n.push(t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"))}));var i=t.sSeparator?"(^|"+t.sSeparator+")(":"^(",o=t.sSeparator?")("+t.sSeparator+"|$)":")$";t.oDataTable.fnFilter(i+n.join("|")+o,t.iColumn,!0,!1)}else t.oDataTable.fnFilter("",t.iColumn)},n.prototype.fnSortOptions=function(){var t=this,n=t.$Select.find("option").slice(1);let i=(t,n)=>e(t).text().localeCompare(e(n).text(),void 0,{numeric:!0,sensitivity:"base"});t.hasOwnProperty("fnSort")&&(i=(n,i)=>t.fnSort(e(n).text(),e(i).text())),n.sort(i),t.$Select.append(n)},n.prototype.fnDraw=function(){var t=this;if(0===t.asFilters.length){var n={},i=[],o=t.oDataTable.fnGetColumnData(t.iColumn);e.each(o,(function(o,a){var r=t.sSeparator?a.split(new RegExp(t.sSeparator)):[a];e.each(r,(function(e,t){""===t||n.hasOwnProperty(t)||(n[t]=!0,i.push(t))}))}));var a=e("<div>"+t.oColumn.sTitle+"</div>").text();t.$Select.empty().append(e("<option selected disabled></option>").val("").text(a)),e.each(i,(function(n,i){var o=e("<div>"+i+"</div>").text().replace(/\n/g," ");t.$Select.append(e("<option></option>").val(o).text(o))})),i.length>0?(t.bSort&&t.fnSortOptions(),t.$Select.prop("disabled",!1)):t.$Select.prop("disabled",!0)}},e.fn.dataTableExt.aoFeatures.push({fnInit:e=>new t(e).getContainer(),cFeature:"W",sFeature:"ColumnFilterWidgets"})}(jQuery);