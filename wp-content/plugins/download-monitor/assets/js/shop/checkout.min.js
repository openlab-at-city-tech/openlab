jQuery(function(m){function _(d,r){var e=m("<div>").addClass("dlm-checkout-error");e.append(m("<img>").attr("src",dlm_strings.icon_error).attr("alt","Checkout error").addClass("dlm-checkout-error-icon")),e.append(m("<p>").html(r)),d.prepend(e)}function u(d){var r=m(".dlm-checkout-overlay:first"),e=m(".dlm-checkout-overlay-bg:first");r.fadeOut(300,function(){r.remove()}),e.fadeOut(300,function(){e.remove(),m(d).find("#dlm_checkout_submit").attr("disabled",!1)})}m("#dlm-form-checkout").submit(function(d){for(var r,e=m(this),a=(m(e).find(".dlm-checkout-field-error").removeClass("dlm-checkout-field-error"),e.find(".dlm-checkout-error").remove(),m(t=e).find("#dlm_checkout_submit").attr("disabled",!0),t=m("<div>").addClass("dlm-checkout-overlay-bg"),(r=m("<div>").addClass("dlm-checkout-overlay")).append(m("<h2>").html(dlm_strings.overlay_title)),r.append(m("<span>").html(dlm_strings.overlay_body)),r.append(m("<img>").attr("src",dlm_strings.overlay_img_src)),m("body").append(t),m("body").append(r),t.fadeIn(300,function(){r.css("display","block").css("top","47%"),r.animate({top:"+=3%"},300)}),{first_name:e.find("#dlm_first_name").val(),last_name:e.find("#dlm_last_name").val(),company:e.find("#dlm_company").val(),email:e.find("#dlm_email").val(),address_1:e.find("#dlm_address_1").val(),postcode:e.find("#dlm_postcode").val(),city:e.find("#dlm_city").val(),country:e.find("#dlm_country").val()}),t={payment_gateway:m("input[name=dlm_gateway]:checked",m(this)).val(),customer:a},i=(void 0!==e.data("order_id")&&(t.order_id=e.data("order_id")),void 0!==e.data("order_hash")&&(t.order_hash=e.data("order_hash")),[]),l=!0,o=0;o<dlm_strings.required_fields.length;o++)""===a[dlm_strings.required_fields[o]]&&(l=!1,i.push(dlm_strings.required_fields[o]));if(!1!==l)return m.post(dlm_strings.ajax_url_place_order,t,function(d){if(!0===d.success&&void 0!==d.redirect)return window.location.replace(d.redirect),!1;!1===d.success&&""!==d.error&&_(e,d.error),u(e)}),!1;for(var s=e,n=i,c=0;c<n.length;c++)m(s).find("#dlm_"+n[c]).addClass("dlm-checkout-field-error");return _(e,dlm_strings.error_message_required_fields),u(e),!1})});