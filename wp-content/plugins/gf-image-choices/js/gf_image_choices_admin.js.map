{"version":3,"file":"gf_image_choices_admin.js","names":["imageChoicesAdmin","$","GF_MARKUP_VERSION","markupDetect","window","form","hasOwnProperty","markupVersion","parseInt","toString","isLegacyMode","imageChoicesVars","useNewFeatures","formHasImageChoicesFields","hasImageChoicesFields","each","fields","i","field","imageChoices_enableImages","markup","removeChoicesButton","imageChoicesFieldStrings","removeAllChoices","choicesAdminRow","index","image","id","undefined","img","uploadImage","removeImage","join","choicesPreviewRow","labelText","getChoices","GetSelectedField","getSettingsElement","find","$row","this","data","choices","length","imageChoices_image","imgID","imageChoices_imageID","$firstInput","before","val","addClass","updateFieldPreview","RemovePreview","btnEl","$choice","closest","css","removeClass","UpdateFieldChoicesObject","imageID","onProductPriceChange","setTimeout","$field","productImageField","type","inputType","$label","$imageWrap","prop","imagesEnabled","hasProductImage","console","log","field_id","detach","append","productImage_image","basePrice","prepend","remove","html","imageChoices_showLabels","toggleShowLabels","$fieldChoices","hasClass","getField","trigger","$settingsWrap","isColorPickerPluginActive","colorPickerFieldVars","isImageChoicesEnabled","fieldCanHaveImages","hasImageChoicesImage","isProductImageField","isProductImageEnabled","productImage_enabled","hasProductImageId","productImage_imageId","onProductImageToggleClick","toggle","toggleEnableImages","checked","click","enable","forProductImage","isForProductImage","toggleSelector","$settings","$toggle","is","onToggleEnableImages","$coloPickerToggle","confirm","confirmImagesToggle","colorPicker_toggleEnableColors","imageChoices_toggleEnableImages","toggleClass","SetFieldProperty","choicesContainerSelector","toLowerCase","$removeChoicesBtn","$enableOtherChoicesSetting","show","toggleShowPrices","toggleUseLightboxCaption","toggleUseLightbox","lightboxCaptionSelector","alert","useLightboxWarning","fieldChoice","hasImage","hasImageID","document","querySelector","style","setProperty","updateEntrySetting","value","selectorPrefix","OpenMediaLibrary","image_fileFrame","open","wp","media","title","button","text","frame","state","multiple","jQuery","on","selection","get","attachment","first","display","toJSON","sizes","size","unshift","imageSize","url","updateProductImage","$choicesFlyout","canHave","gform","applyFilters","fieldSettingsSelector","previewHeight","$el","height","outerHeight","updateThemeSetting","$previewImg","$previewWrap","hide","gf_image_choices_theme","globals","theme","defaults","updateFeatureColorSetting","$customColorLabel","$customColorInput","$customColorPicker","customColor","wpColorPicker","change","e","ui","updateCustomFeatureColor","color","propPrefix","updateAlignSetting","updateImageStyleSetting","validateNumericValue","numVal","trim","num","isNaN","updateColumnsSetting","updateColumnsWidthSetting","updateColumnsMediumSetting","updateColumnsMediumWidthSetting","updateColumnsSmallSetting","updateColumnsSmallWidthSetting","updateHeightSetting","updateMediumHeightSetting","updateSmallHeightSetting","initProductImageField","initImageChoicesField","formEditorInit","addAction","fieldId","forEach","f","$fieldSettings","productImageEnabled","productImageUrl","productImageId","useProductImageLightbox","productImage_useLightbox","selectedProductImageTheme","productImage_theme","productImageStyle","productImage_imageStyle","productImageUseLightboxCaption","productImage_useLightboxCaption","productImageHeightSetting","productImage_height","productImageMediumHeightSetting","productImage_heightMedium","productImageSmallHeightSetting","productImage_heightSmall","productImageEntryValue","productImage_entrySetting","useLightbox","imageChoices_useLightbox","displayLabels","showPrices","imageChoices_showPrices","entryValue","imageChoices_entrySetting","selectedTheme","imageChoices_theme","featureColor","imageChoices_featureColor","featureColorCustom","imageChoices_featureColorCustom","alignSetting","imageChoices_align","imageStyle","imageChoices_imageStyle","columnsSetting","imageChoices_columns","columnsWidthSetting","imageChoices_columnsWidth","columnsMediumSetting","imageChoices_columnsMedium","columnsMediumWidthSetting","imageChoices_columnsWidthMedium","columnsSmallSetting","imageChoices_columnsSmall","columnsSmallWidthSetting","imageChoices_columnsWidthSmall","useLightboxCaption","imageChoices_useLightboxCaption","heightSetting","imageChoices_height","mediumHeightSetting","imageChoices_heightMedium","smallHeightSetting","imageChoices_heightSmall","bind","event","imageChoices_GF_UpdateFieldChoices","UpdateFieldChoices","apply","arguments","formEditorLegacyWarning","$customCssBoxes","editorSettings","codeEditor","defaultSettings","_","clone","codemirror","extend","indentUnit","tabSize","mode","lineNumbers","autoCloseBrackets","continueComments","indentWithTabs","inputStyle","lineWrapping","lint","matchBrackets","styleActiveLine","gutters","extraKeys","initialize","$legacyCssSectionToggle","ref","attr","refresh","$legacyModeToggle","$newFeaturesElements","useLegacyMode","$settingsTabNavLinks","$numericSettingsInputs","currentTarget","$settingsThemeSelect","$settingsThemePreview","settingsCustomFeatureColor","$settingsFeatureColorPicker","$settingsFeatureColorSelect","$settingsFeatureColorCustom","$settingsFeatureColorInput","$urlReplacementTool","$urlReplacementSubmit","$urlReplacementProgress","$urlReplacementProgressBar","$urlReplacementStatus","urlReplacements","old","new","forms","replacements","processUrlReplacement","$sizeReplacementTool","ajax","ajaxurl","method","action","beforeSend","jqXHR","settings","success","response","total","error","Math","ceil","preventDefault","formId","oldUrl","newUrl","form_id","$sizeReplacementSubmit","$sizeReplacementProgress","$sizeReplacementProgressBar","$sizeReplacementStatus","sizeReplacements","processSizeReplacement","newSize"],"sources":["gf_image_choices_admin.js"],"sourcesContent":["var imageChoicesAdmin = imageChoicesAdmin || {};\n\n(function($){\n\n\tvar GF_MARKUP_VERSION = 2;\n\n\timageChoicesAdmin.markupDetect = function() {\n\t\tif ( typeof window.form !== 'undefined' && window.form.hasOwnProperty('markupVersion') ) {\n\t\t\tGF_MARKUP_VERSION = ( window.form.markupVersion !== '' ) ? parseInt( window.form.markupVersion.toString(), 10 ) : 1;\n\t\t}\n\t\treturn GF_MARKUP_VERSION;\n\t};\n\n\timageChoicesAdmin.isLegacyMode = function() {\n\t\tvar useNewFeatures = ( imageChoicesVars.hasOwnProperty('useNewFeatures') && imageChoicesVars.useNewFeatures.toString() === 'true');\n\t\treturn !useNewFeatures;\n\t};\n\n\timageChoicesAdmin.formHasImageChoicesFields = function() {\n\t\tvar hasImageChoicesFields = false;\n\t\t$.each(window.form.fields, function(i, field){\n\t\t\tif ( field.hasOwnProperty('imageChoices_enableImages') && field.imageChoices_enableImages ) {\n\t\t\t\thasImageChoicesFields = true;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\treturn hasImageChoicesFields;\n\t};\n\n\timageChoicesAdmin.markup = {\n\t\tremoveChoicesButton: function(){\n\t\t\treturn '<button class=\"button image-choices-remove-choices-btn\" type=\"button\" onclick=\"imageChoicesAdmin.removeAllChoices();\">'+imageChoicesFieldStrings.removeAllChoices+'</button>';\n\t\t},\n\t\tchoicesAdminRow: function(index, image, id){\n\t\t\tvar i = (index !== undefined) ? index : 0;\n\t\t\tvar img = (image !== undefined) ? image : '';\n\t\t\tvar id = (id !== undefined) ? id : '';\n\t\t\tvar buttonLabel = '<i class=\"ic-select-icon\"></i>';// GF 2.5+\n\t\t\treturn [\n\t\t\t\t'<button type=\"button\" id=\"image-choices-option-upload-button-'+i+'\" class=\"button image-choices-option-upload-button\" onclick=\"imageChoicesAdmin.OpenMediaLibrary(this);\" title=\"'+imageChoicesFieldStrings.uploadImage+'\">'+buttonLabel+'</button>',\n\t\t\t\t'<span id=\"image-choices-option-preview-'+i+'\" class=\"image-choices-option-preview-wrap\">',\n\t\t\t\t\t'<span class=\"image-choices-option-preview\" style=\"background-image:url('+img+');\"></span>',\n\t\t\t\t\t'<a href=\"javascript:void(0);\" class=\"image-choices-option-image-remove\" onclick=\"imageChoicesAdmin.RemovePreview(this);\" title=\"'+imageChoicesFieldStrings.removeImage+'\"><i class=\"dashicons dashicons-no\"></i></a>',\n\t\t\t\t'</span>',\n\t\t\t\t'<input type=\"hidden\" id=\"image-choices-option-image-'+i+'\" class=\"image-choices-option-image\" value=\"'+img+'\" />',\n\t\t\t\t'<input type=\"hidden\" id=\"image-choices-option-image-id-'+i+'\" class=\"image-choices-option-image-id\" value=\"'+id+'\" />'\n\t\t\t].join('');\n\t\t},\n\t\tchoicesPreviewRow: function(index, labelText, image) {\n\t\t\tvar i = (index !== undefined) ? index : 0;\n\t\t\tvar label = (labelText !== undefined) ? labelText : '';\n\t\t\tvar img = (image !== undefined) ? image : '';\n\t\t\treturn [\n\t\t\t\t'<span class=\"image-choices-choice-image-wrap\" style=\"background-image:url('+img+')\">',\n\t\t\t\t\t'<img src=\"'+img+'\" alt=\"\" class=\"image-choices-choice-image\" />',\n\t\t\t\t'</span>',\n\t\t\t\t'<span class=\"image-choices-choice-text\">'+label+'</span>'\n\t\t\t].join('');\n\t\t}\n\t};\n\n\timageChoicesAdmin.getChoices = function( field ) {\n\t\tif ( typeof field === 'undefined' ) {\n\t\t\tfield = GetSelectedField();\n\t\t}\n\n\t\tvar choicesSelector = '[class*=\"-choice-row\"]';\n\n\t\timageChoicesAdmin.getSettingsElement().find(choicesSelector).each(function(){\n\t\t\tvar $row = $(this);\n\t\t\tvar i = $row.data('index');\n\t\t\tvar img = (field.choices.length && field.choices[i].imageChoices_image !== undefined) ? field.choices[i].imageChoices_image : '';\n\t\t\tvar imgID = (field.choices.length && field.choices[i].imageChoices_imageID !== undefined) ? field.choices[i].imageChoices_imageID : '';\n\n\t\t\tif ( !$row.find('.image-choices-option-image').length ) {\n\t\t\t\tvar $firstInput = $row.find('input[id*=\"_choice_text\"]:first');\n\t\t\t\tif ( !$firstInput.length ) {\n\t\t\t\t\t$firstInput = $row.find('input[id*=\"-choice-text\"]:first');\n\t\t\t\t}\n\t\t\t\tif ( $firstInput.length ) {\n\t\t\t\t\t$firstInput.before(imageChoicesAdmin.markup.choicesAdminRow(i, img, imgID));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar $imageInput = $row.find('.image-choices-option-image');\n\t\t\tif ($imageInput.val() !== '') {\n\t\t\t\t$row.addClass('image-choices-has-image');\n\t\t\t}\n\t\t});\n\n\t\timageChoicesAdmin.updateFieldPreview(field);\n\t};\n\n\timageChoicesAdmin.RemovePreview = function( btnEl ) {\n\t\tif (typeof btnEl === 'undefined') {\n\t\t\treturn;\n\t\t}\n\n\t\tvar $choice = $(btnEl).closest('[class*=\"-choice-row\"]');\n\t\t$choice.find('.image-choices-option-image').val('');\n\t\t$choice.find('.image-choices-option-image-id').val('');\n\t\t$choice.find('.image-choices-option-preview').css('background-image', '');\n\t\t$choice.removeClass('image-choices-has-image');\n\n\t\timageChoicesAdmin.UpdateFieldChoicesObject();\n\n\t\tvar field = GetSelectedField();\n\t\timageChoicesAdmin.updateFieldPreview(field);\n\t};\n\n\timageChoicesAdmin.UpdateFieldChoicesObject = function() {\n\t\tvar field = GetSelectedField();\n\n\t\tvar $fieldSettings = imageChoicesAdmin.getSettingsElement();\n\n\t\tvar selector = '[class*=\"-choice-row\"]';\n\n\t\t$fieldSettings.find(selector).each(function(index) {\n\t\t\tvar $choice = $(this);\n\t\t\tvar image = $choice.find('.image-choices-option-image').val();\n\t\t\tvar imageID = $choice.find('.image-choices-option-image-id').val();\n\t\t\tvar i = $choice.data(\"index\");\n\t\t\tif (image !== '') {\n\t\t\t\t$choice.addClass('image-choices-has-image');\n\t\t\t\t$choice.find('.gf-image-choices-option-preview').css('background-image', 'url('+image+')');\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$choice.removeClass('image-choices-has-image');\n\t\t\t}\n\t\t\tfield.choices[i].imageChoices_image = image;\n\t\t\tfield.choices[i].imageChoices_imageID = imageID;\n\t\t});\n\t};\n\n\timageChoicesAdmin.onProductPriceChange = function() {\n\t\tsetTimeout(function(){\n\t\t\timageChoicesAdmin.updateFieldPreview( GetSelectedField() );\n\t\t}, 10);\n\t};\n\n\timageChoicesAdmin.updateFieldPreview = function( field ) {\n\n\t\tvar $field = $('#field_'+field.id);\n\t\tvar productImageField = ( field.type === 'product' && field.inputType === 'singleproduct' );\n\n\t\tvar $label = $field.find('.gfield_label.gform-field-label');\n\t\tvar $imageWrap = $field.find('.ic-product-image-wrap');\n\n\t\tvar prop = productImageField ? 'productImage_enabled' : 'imageChoices_enableImages';\n\t\tvar imagesEnabled = (field.hasOwnProperty(prop) && field[prop] === true);\n\t\tvar hasProductImage = imageChoicesAdmin.hasProductImage( field );\n\n\t\tconsole.log('imageChoicesAdmin.updateFieldPreview', { field_id: field.id, prop, imagesEnabled })\n\n\t\tif ( !imagesEnabled ) {\n\t\t\tif ( $imageWrap.length ) {\n\t\t\t\t$label.detach();\n\t\t\t\t$field.prepend($label);\n\t\t\t\t$imageWrap.remove();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif ( productImageField ) {\n\n\t\t\tif ( !$imageWrap.length && hasProductImage ) {\n\t\t\t\t$label.detach();\n\t\t\t\t$imageWrap = $(`<div class=\"ic-product-image-wrap\"></div>`);\n\t\t\t\t$imageWrap.append(`<div class=\"ic-product-image\" style=\"background-image:url(${field.productImage_image});\"><img src=\"${field.productImage_image}\" alt=\"\" class=\"ic-product-image-element\" /></div>`);\n\t\t\t\t$imageWrap.append($label);\n\t\t\t\t$imageWrap.append(`<div class=\"ic-product-image-price\">${field.basePrice}</div>`);\n\t\t\t\t$field.prepend($imageWrap);\n\t\t\t}\n\t\t\telse if ( !hasProductImage && $imageWrap.length ) {\n\t\t\t\t$label.detach();\n\t\t\t\t$field.prepend($label);\n\t\t\t\t$imageWrap.remove();\n\t\t\t}\n\n\t\t\tif ( hasProductImage ) {\n\t\t\t\t$field.find('.ic-product-image-price').html(field.basePrice);\n\t\t\t}\n\n\t\t}\n\t\telse {\n\n\t\t\tif ( $imageWrap.length ) {\n\t\t\t\t$label.detach();\n\t\t\t\t$field.prepend($label);\n\t\t\t\t$imageWrap.remove();\n\t\t\t}\n\n\t\t\tif ( imagesEnabled && field.imageChoices_showLabels === undefined ) {\n\t\t\t\timageChoicesAdmin.toggleShowLabels(true);\n\t\t\t}\n\n\t\t\t// inject the preview if not there\n\t\t\timageChoicesAdmin.$fieldChoices( $field ).each(function(i){\n\t\t\t\tvar $choice = $(this);\n\n\t\t\t\tif ( !$choice.hasClass('gchoice_total') ) {\n\n\t\t\t\t\t$choice.addClass('image-choices-choice');\n\n\t\t\t\t\tvar $label = $choice.find('label');\n\t\t\t\t\tvar labelText = ($label.find('.image-choices-choice-text').length) ? $label.find('.image-choices-choice-text').html() : $label.html();\n\n\t\t\t\t\tif (field.imageChoices_enableImages) {\n\t\t\t\t\t\tif (field.choices.length > i) {\n\t\t\t\t\t\t\tvar img = (field.choices[i].imageChoices_image !== undefined) ? field.choices[i].imageChoices_image : '';\n\t\t\t\t\t\t\t$label.html(imageChoicesAdmin.markup.choicesPreviewRow(i, labelText, img));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$label.html(labelText);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\n\t};\n\n\timageChoicesAdmin.getField = function() {\n\t\tvar field = GetSelectedField();\n\t\treturn $('#field_'+field.id);\n\t};\n\n\timageChoicesAdmin.removeAllChoices = function() {\n\t\timageChoicesAdmin.getSettingsElement().find('.image-choices-option-image-remove').each(function(){\n\t\t\t$(this).trigger('click');\n\t\t});\n\n\t\t$settingsWrap.find('.gf_delete_field_choice').each(function(){\n\t\t\t$(this).trigger('click');\n\t\t});\n\n\t\t$settingsWrap.find('.field-choice-row input[type=\"text\"], .gquiz-choice-row input[type=\"text\"]').val('');\n\t};\n\n\timageChoicesAdmin.isColorPickerPluginActive = function() {\n\t\treturn (window.hasOwnProperty('colorPickerFieldVars') && typeof window.colorPickerFieldVars !== 'undefined');\n\t};\n\n\timageChoicesAdmin.isImageChoicesEnabled = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( imageChoicesAdmin.fieldCanHaveImages(field) && field.imageChoices_enableImages === true );\n\t};\n\n\timageChoicesAdmin.hasImageChoicesImage = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( imageChoicesAdmin.isImageChoicesEnabled(field) && field.hasOwnProperty('imageChoices_image') && field.imageChoices_image !== '' );\n\t};\n\n\timageChoicesAdmin.isProductImageField = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( field.type === \"product\" && field.inputType === \"singleproduct\" );\n\t};\n\n\timageChoicesAdmin.isProductImageEnabled = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( imageChoicesAdmin.isProductImageField(field) && field.productImage_enabled === true );\n\t};\n\n\timageChoicesAdmin.hasProductImage = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( imageChoicesAdmin.isProductImageField(field) && field.hasOwnProperty('productImage_image') && field.productImage_image !== '' );\n\t};\n\n\timageChoicesAdmin.hasProductImageId = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( imageChoicesAdmin.isProductImageField(field) && field.hasOwnProperty('productImage_imageId') && field.productImage_imageId );\n\t};\n\n\timageChoicesAdmin.onProductImageToggleClick = function(toggle) {\n\t\timageChoicesAdmin.toggleEnableImages(toggle.checked, true);\n\t\tif ( toggle.checked ) {\n\t\t\tif ( !imageChoicesAdmin.hasProductImage() ) {\n\t\t\t\t$('#product_image_tab_toggle').click();\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t$('#product-image-button').click();\n\t\t\t\t}, 500);\n\t\t\t}\n\t\t}\n\t}\n\n\timageChoicesAdmin.toggleEnableImages = function( enable, forProductImage ) {\n\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar toggleSelector = isForProductImage ? 'input.field_product_image_enabled' : 'input.field_choice_images_enabled';\n\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\tvar $toggle = $settings.find(toggleSelector);\n\n\t\tif ( enable === undefined ) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\tif ( isForProductImage ) {\n\t\t\timageChoicesAdmin.onToggleEnableImages(enable, isForProductImage);\n\t\t\treturn;\n\t\t}\n\n\t\tvar $coloPickerToggle = $settings.find('input.field_color_picker_enabled');\n\n\t\t// if user is enabling image choices, and color picker is currently in use on this field, confirm the switch\n\t\tif (enable && imageChoicesAdmin.isColorPickerPluginActive() && $coloPickerToggle.length && $coloPickerToggle.is(':checked')) {\n\t\t\tif (window.confirm(imageChoicesFieldStrings.confirmImagesToggle)) {\n\t\t\t\tif (window.hasOwnProperty('colorPicker_toggleEnableColors') && typeof window.colorPicker_toggleEnableColors === 'function') {\n\t\t\t\t\twindow.colorPicker_toggleEnableColors(false);\n\t\t\t\t}\n\t\t\t\timageChoicesAdmin.onToggleEnableImages(enable, isForProductImage);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$toggle.prop('checked', false);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\timageChoicesAdmin.onToggleEnableImages(enable, isForProductImage);\n\t\t}\n\t};\n\twindow.imageChoices_toggleEnableImages = imageChoicesAdmin.toggleEnableImages;// legacy support\n\n\timageChoicesAdmin.onToggleEnableImages = function( enable, forProductImage ) {\n\n\t\tvar field = GetSelectedField();\n\t\tif ( !field ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar toggleSelector = isForProductImage ? 'input.field_product_image_enabled' : 'input.field_choice_images_enabled';\n\n\t\tvar $field = imageChoicesAdmin.getField();\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\tvar $toggle = $settings.find(toggleSelector);\n\n\t\tif (enable === undefined) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\t$field.toggleClass('image-choices-admin-field', enable);\n\t\t//$fieldSettings.toggleClass('image-choices-product-field', field.type === \"product\");\n\n\t\tif ( isForProductImage ) {\n\n\t\t\tSetFieldProperty('productImage_enabled', enable);\n\t\t\t$toggle.prop('checked', enable);\n\t\t\t$('#product_image_tab_toggle').toggle( enable );\n\n\t\t\tvar $imageWrap = $field.find('.ic-product-image-wrap');\n\n\t\t\tif ( !enable && $imageWrap.length ) {\n\t\t\t\tvar $label = $field.find('.gfield_label.gform-field-label');\n\t\t\t\t$label.detach();\n\t\t\t\t$field.prepend($label);\n\t\t\t\t$imageWrap.remove();\n\t\t\t}\n\n\t\t\t$field.toggleClass('product-image-admin-field', enable);\n\t\t\t$field.toggleClass('product-image-enabled', enable);\n\t\t\t$settings.toggleClass('product-image-enabled', enable);\n\n\t\t}\n\t\telse {\n\n\t\t\tSetFieldProperty('imageChoices_enableImages', enable);\n\t\t\t$toggle.prop('checked', enable);\n\t\t\t$('#image_choices_tab_toggle').toggle( enable );\n\n\t\t\tvar choicesContainerSelector = ( field.type.toLowerCase() === \"quiz\" ) ? '#gquiz_gfield_settings_choices_container' : '#gfield_settings_choices_container';\n\t\t\tvar $choicesContainer = $(choicesContainerSelector);\n\t\t\t$choicesContainer.toggleClass('image-choices-enabled', enable);\n\n\t\t\t$field.toggleClass('image-choices-use-images', enable);\n\t\t\t$settings.toggleClass('image-choices-use-images', enable);\n\n\t\t\tvar $removeChoicesBtn = $settings.find('.image-choices-remove-choices-btn');\n\n\t\t\tif (!enable) {\n\t\t\t\tif ($removeChoicesBtn.length) {\n\t\t\t\t\t$removeChoicesBtn.remove();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar $enableOtherChoicesSetting = $('.field_setting.other_choice_setting');\n\t\t\tvar isFieldWithOtherChoiceOption = (field.type === 'radio' || (field.type === 'poll' && field.inputType === 'radio'));\n\n\t\t\tif (isFieldWithOtherChoiceOption) {\n\t\t\t\t$enableOtherChoicesSetting.show();\n\t\t\t}\n\n\t\t}\n\n\t\timageChoicesAdmin.updateFieldPreview(field);\n\t};\n\n\timageChoicesAdmin.toggleShowLabels = function( enable ) {\n\t\tvar $field = imageChoicesAdmin.getField();\n\t\tvar $toggle = imageChoicesAdmin.getSettingsElement().find('input.image_choices_show_labels');\n\n\t\tif (enable === undefined) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\tSetFieldProperty('imageChoices_showLabels', enable);\n\n\t\t$toggle.prop('checked', enable);\n\n\t\t$field.toggleClass('image-choices-show-labels', enable);\n\t};\n\n\timageChoicesAdmin.toggleShowPrices = function( enable ) {\n\t\tvar $field = imageChoicesAdmin.getField();\n\t\tvar $toggle = imageChoicesAdmin.getSettingsElement().find('input.image_choices_show_prices');\n\n\t\tif (enable === undefined) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\tSetFieldProperty('imageChoices_showPrices', enable);\n\n\t\t$toggle.prop('checked', enable);\n\n\t\t$field.toggleClass('image-choices-show-prices', enable);\n\t};\n\n\timageChoicesAdmin.toggleUseLightboxCaption = function( enable, forProductImage ) {\n\n\t\tvar $field = imageChoicesAdmin.getField();\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar toggleSelector = isForProductImage ? 'input.product_image_use_lightbox_caption' : 'input.image_choices_use_lightbox_caption';\n\t\tvar $toggle = imageChoicesAdmin.getSettingsElement().find(toggleSelector);\n\n\t\tif (enable === undefined) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\t$toggle.prop('checked', enable);\n\n\t\tif ( isForProductImage ) {\n\t\t\tSetFieldProperty('productImage_useLightboxCaption', enable);\n\t\t}\n\t\telse {\n\t\t\tSetFieldProperty('imageChoices_useLightboxCaption', enable);\n\t\t}\n\n\t};\n\n\timageChoicesAdmin.toggleUseLightbox = function( enable, forProductImage ) {\n\n\t\tvar field = GetSelectedField();\n\t\tvar $field = imageChoicesAdmin.getField();\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar toggleSelector = isForProductImage ? 'input.product_image_use_lightbox' : 'input.image_choices_use_lightbox';\n\t\tvar $toggle = imageChoicesAdmin.getSettingsElement().find(toggleSelector);\n\t\tvar lightboxCaptionSelector = isForProductImage ? '.product-image-setting-use-lightbox-caption' : '.image-choices-setting-use-lightbox-caption';\n\n\t\tif (enable === undefined) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\t$toggle.prop('checked', enable);\n\n\t\tif ( isForProductImage ) {\n\n\t\t\tSetFieldProperty('productImage_useLightbox', enable);\n\t\t\t$field.toggleClass('product-image-use-lightbox', enable);\n\n\t\t\tif ( imageChoicesAdmin.hasProductImage(field) && !imageChoicesAdmin.hasProductImageId(field) ) {\n\t\t\t\twindow.alert(imageChoicesFieldStrings.useLightboxWarning);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t}\n\t\telse {\n\n\t\t\tSetFieldProperty('imageChoices_useLightbox', enable);\n\t\t\t$field.toggleClass('image-choices-use-lightbox', enable);\n\n\t\t\tif (enable) {\n\t\t\t\t$.each(field.choices, function(i, fieldChoice){\n\t\t\t\t\tvar hasImage = ( fieldChoice.hasOwnProperty('imageChoices_image') && fieldChoice.imageChoices_image !== '' );\n\t\t\t\t\tvar hasImageID = ( fieldChoice.hasOwnProperty('imageChoices_imageID') && fieldChoice.imageChoices_imageID !== '' );\n\n\t\t\t\t\tif ( hasImage && !hasImageID ) {\n\t\t\t\t\t\twindow.alert(imageChoicesFieldStrings.useLightboxWarning);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t}\n\n\t\tdocument.querySelector(lightboxCaptionSelector).style.setProperty('display', enable ? 'block' : 'none', 'important');\n\n\t};\n\n\timageChoicesAdmin.updateEntrySetting = function( value, forProductImage ) {\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\n\t\tSetFieldProperty(`${propPrefix}_entrySetting`, value);\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-entry-value`).val( value );\n\t};\n\n\timageChoicesAdmin.OpenMediaLibrary = function( btnEl ) {\n\t\tif (typeof btnEl === 'undefined') {\n\t\t\treturn;\n\t\t}\n\n\t\tvar field = GetSelectedField();\n\t\tvar isForProductImage = imageChoicesAdmin.isProductImageField(field);\n\n\t\tvar image_fileFrame;\n\n\t\tif ( isForProductImage ) {\n\t\t\tvar $field = imageChoicesAdmin.getField();\n\t\t\timage_fileFrame = $field.data('file-frame');\n\t\t}\n\t\telse {\n\t\t\tvar $choice = $(btnEl).closest('[class*=\"-choice-row\"]');\n\t\t\timage_fileFrame = $choice.data('file-frame');\n\t\t}\n\n\t\t// If the media frame already exists, reopen it.\n\t\tif ( image_fileFrame ) {\n\t\t\t// Open frame\n\t\t\timage_fileFrame.open();\n\t\t\treturn;\n\t\t}\n\n\t\t// Create the media frame.\n\t\timage_fileFrame = wp.media({\n\t\t\ttitle: 'Select an image to upload',\n\t\t\tbutton: {\n\t\t\t\ttext: 'Use this image'\n\t\t\t},\n\t\t\tframe: 'post',\n\t\t\tstate: 'insert',\n\t\t\tmultiple: false\t// Set to true to allow multiple files to be selected\n\t\t});\n\n\t\tsetTimeout(function(){\n\t\t\t$('input[value=\"Insert into Post\"]').val('Use this Image');\n\t\t\t$('button.media-button-insert').text('Use this Image');\n\t\t}, 100);\n\n\t\tjQuery('body').on('click', 'li.attachment', function(){\n\t\t\t$('input[value=\"Insert into Post\"]').val('Use this Image');\n\t\t\t$('button.media-button-insert').text('Use this Image');\n\t\t});\n\n\t\t// When an image is selected, run a callback.\n\t\timage_fileFrame.on( 'insert', function(selection) {\n\t\t\tvar state = image_fileFrame.state();\n\t\t\tselection = selection || state.get('selection');\n\t\t\tif (! selection) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar attachment = selection.first();\n\t\t\tvar selectedSize = \"\";\n\n\t\t\tvar display = state.display(attachment).toJSON();\n\t\t\tattachment = attachment.toJSON();\n\n\t\t\t// start with the selected size, but fallback to one of the defaults if there's no image\n\t\t\t// this can happen eg when there are existing images in the media library when a new size is created, and thumbnails haven't been generated for existing\n\t\t\t// the size will appear as an option in the media library when selecting the image, but then fails as there's no image in that size\n\t\t\tvar sizes = [\"medium\", \"thumbnail\", \"full\"];\n\t\t\tif ( display && display.hasOwnProperty('size') && display.size ) {\n\t\t\t\tsizes.unshift( display.size );\n\t\t\t}\n\n\t\t\tvar img;\n\t\t\tif ( !attachment.hasOwnProperty('sizes') ) {\n\t\t\t\timg = attachment.url;\n\t\t\t\tselectedSize = \"full\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar i = 0;\n\t\t\t\tvar imageSize = sizes[i].toString();\n\t\t\t\twhile ( !attachment.sizes.hasOwnProperty(imageSize) || !attachment.sizes[imageSize].hasOwnProperty('url') || attachment.sizes[imageSize].url === \"\" ) {\n\t\t\t\t\ti++;\n\t\t\t\t\timageSize = sizes[i].toString();\n\t\t\t\t}\n\t\t\t\timg = attachment.sizes[imageSize].url;\n\t\t\t\tselectedSize = imageSize;\n\t\t\t\t// TODO: size override? But can use the IC image size update tool\n\t\t\t\t/*\n\t\t\t\tif ( imageChoicesVars.hasOwnProperty('defaults') && imageChoicesVars.defaults.hasOwnProperty('imageSize') && sizes.indexOf(imageChoicesVars.defaults.imageSize) !== -1 ) {\n\t\t\t\t\timg = attachment.sizes[imageChoicesVars.defaults.imageSize].url;\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t}\n\n\t\t\tif ( isForProductImage ) {\n\t\t\t\timageChoicesAdmin.updateProductImage(img, attachment.id);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$choice.find('.image-choices-option-image').val(img);\n\t\t\t\t$choice.find('.image-choices-option-image-id').val(attachment.id);\n\t\t\t\t$choice.find('.image-choices-option-preview').css('background-image', 'url('+img+')');\n\t\t\t\t$choice.addClass('image-choices-has-image');\n\n\t\t\t\timageChoicesAdmin.UpdateFieldChoicesObject();\n\t\t\t\timageChoicesAdmin.updateFieldPreview(field);\n\n\t\t\t\t// GF 2.6+\n\t\t\t\tvar $choicesFlyout = $('#choices-ui-flyout');\n\t\t\t\tif ( $choicesFlyout.length ) {\n\t\t\t\t\t$choicesFlyout.addClass('gform-flyout--anim-in-ready gform-flyout--anim-in-active');\n\t\t\t\t}\n\t\t\t}\n\n\t\t});\n\n\t\t// Finally, open the modal\n\t\timage_fileFrame.open();\n\n\t\tif ( isForProductImage ) {\n\t\t\t$field.data('file-frame', image_fileFrame);\n\t\t}\n\t\telse {\n\t\t\t$choice.data('file-frame', image_fileFrame);\n\t\t}\n\t};\n\n\timageChoicesAdmin.fieldCanHaveImages = function( field ) {\n\n\t\tif ( typeof field === 'undefined' || !field.hasOwnProperty('type') ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar canHave = (\n\t\t\tfield.type === 'radio'\n\t\t\t|| field.type === 'checkbox'\n\t\t\t|| ( field.type === 'quiz' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'quiz' && field.inputType == 'checkbox' )\n\t\t\t|| ( field.type === 'poll' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'poll' && field.inputType == 'checkbox' )\n\t\t\t|| ( field.type === 'post_custom_field' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'post_custom_field' && field.inputType == 'checkbox' )\n\t\t\t|| ( field.type === 'survey' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'survey' && field.inputType == 'checkbox' )\n\t\t\t|| ( field.type === 'product' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'option' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'option' && field.inputType == 'checkbox' )\n\t\t);\n\n\t\treturn gform.applyFilters('gfic_field_can_have_images', canHave, field);\n\n\t};\n\n\timageChoicesAdmin.$fieldChoices = function( $field ) {\n\t\tif ( typeof $field === 'undefined' || $field instanceof jQuery === false) {\n\t\t\treturn [];\n\t\t}\n\t\tvar choicesSelector = '.ginput_container .gfield_radio div[class*=\"gchoice\"], .ginput_container .gfield_checkbox .gchoice:not(.gchoice_select_all)';// GF 2.5+\n\n\t\treturn $field.find(choicesSelector);\n\t};\n\n\timageChoicesAdmin.getSettingsElement = function() {\n\t\tvar fieldSettingsSelector = '#field_settings_container';// GF 2.5+\n\n\t\tvar field = GetSelectedField();\n\t\tfieldSettingsSelector += ( field.type === \"quiz\" ) ? ', #gquiz_gfield_settings_choices_container' : ', #gfield_settings_choices_container'\n\n\t\treturn $(fieldSettingsSelector);\n\t};\n\n\timageChoicesAdmin.previewHeight = function( $el ) {\n\n\t\tif ( typeof $el !== 'object' ) {\n\t\t\tvar $field = imageChoicesAdmin.getField();\n\t\t\t$el = $field.find('.ginput_container');\n\t\t}\n\n\t\tif ( !$el.length || !$el.closest('.gfield').hasClass('image-choices-admin-field') ) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetTimeout(function(){\n\t\t\t$el.height( $el.find('> ul:first').outerHeight() );\n\t\t}, 20);\n\n\t};\n\n\timageChoicesAdmin.updateProductImage = function( url, id ) {\n\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\tvar $field = imageChoicesAdmin.getField();\n\n\t\tif ( typeof url === 'undefined' ) {\n\t\t\turl = '';\n\t\t}\n\t\tif ( typeof id === 'undefined' ) {\n\t\t\tid = '';\n\t\t}\n\n\t\tSetFieldProperty('productImage_image', url);\n\t\tSetFieldProperty('productImage_imageId', id);\n\n\t\t$settings.find('.product-image-url').val(url);\n\t\t$settings.find('.product-image-id').val(id);\n\t\t$settings.find('#product-image-preview').css('background-image', 'url('+url+')');\n\n\t\t$settings.toggleClass('has-product-image', url !== '');// todo: class on settings?\n\t\t$field.toggleClass('has-product-image', url !== '');// todo: or class on field?\n\t\timageChoicesAdmin.updateFieldPreview( GetSelectedField() );\n\n\t};\n\n\timageChoicesAdmin.updateThemeSetting = function( value, forProductImage ) {\n\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\n\t\tSetFieldProperty( `${propPrefix}_theme`, value );\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-theme`).val( value );\n\n\t\tvar $previewWrap = $(`#${selectorPrefix}-theme-preview`);\n\t\tvar $previewImg;\n\t\t$previewWrap.toggle(value !== 'none');\n\t\tif (value === 'none') {\n\t\t\t$previewWrap.hide().find('img').hide();\n\t\t}\n\t\telse if (value === 'form_setting') {\n\t\t\tvalue = (window.form.hasOwnProperty('gf-image-choices') && window.form['gf-image-choices'].hasOwnProperty('gf_image_choices_theme')) ? window.form['gf-image-choices'].gf_image_choices_theme : '';\n\t\t\tif ( !value || value === \"global_setting\" ) {\n\t\t\t\tvalue = ( imageChoicesVars.hasOwnProperty('globals') && imageChoicesVars.globals.hasOwnProperty('theme') ) ? imageChoicesVars.globals.theme : ( imageChoicesVars.hasOwnProperty('defaults') && imageChoicesVars.defaults.hasOwnProperty('theme') ) ? imageChoicesVars.defaults.theme : 'simple';\n\t\t\t}\n\t\t\t$previewWrap.find('img').hide();\n\t\t\t$previewImg = $previewWrap.find(`img.${selectorPrefix}-theme-preview-${value}`);\n\t\t\tif ( $previewImg.length ) {\n\t\t\t\t$previewImg.show();\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t$previewWrap.find('img').hide();\n\t\t\t$previewImg = $previewWrap.find(`img.${selectorPrefix}-theme-preview-${value}`);\n\t\t\tif ( $previewImg.length ) {\n\t\t\t\t$previewImg.show();\n\t\t\t}\n\t\t}\n\n\t};\n\n\timageChoicesAdmin.updateFeatureColorSetting = function( value ) {\n\n\t\tSetFieldProperty( `imageChoices_featureColor`, value );\n\n\t\tvar $customColorLabel = imageChoicesAdmin.getSettingsElement().find(`[for=\"image-choices-feature-color-custom\"]`);\n\t\tvar $customColorInput = imageChoicesAdmin.getSettingsElement().find(`#image-choices-feature-color-custom`);\n\t\tvar $customColorPicker = imageChoicesAdmin.getSettingsElement().find(`.image-choices-setting-feature-color .wp-picker-container`);\n\t\tvar customColor = $customColorInput.val();\n\n\t\timageChoicesAdmin.getSettingsElement().find(`#image-choices-feature-color`).val( value );\n\n\t\tif ( value === \"custom\" ) {\n\t\t\t$customColorLabel.show();\n\t\t\t$customColorInput.show();\n\t\t\tif ( $customColorPicker.length ) {\n\t\t\t\t$customColorPicker.show();\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\tif ( customColor !== \"\" ) {\n\t\t\t\t\t\t$customColorInput.wpColorPicker('color', customColor);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$customColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t\t}\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$customColorInput.wpColorPicker({\n\t\t\t\t\tchange: function( e, ui ) {\n\t\t\t\t\t\timageChoicesAdmin.updateCustomFeatureColor( ui.color.toString() );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\tif ( customColor !== \"\" ) {\n\t\t\t\t\t\t$customColorInput.wpColorPicker('color', customColor);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$customColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t\t}\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t$customColorLabel.hide();\n\t\t\t$customColorInput.hide();\n\t\t\tif ( $customColorPicker.length ) {\n\t\t\t\t$customColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t$customColorPicker.hide();\n\t\t\t}\n\t\t}\n\n\t};\n\n\timageChoicesAdmin.updateCustomFeatureColor = function( value, forProductImage ) {\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-feature-color-custom`).val( value );\n\t\tSetFieldProperty( `${propPrefix}_featureColorCustom`, value );\n\t};\n\n\timageChoicesAdmin.updateAlignSetting = function( value ) {\n\t\tSetFieldProperty( 'imageChoices_align', value );\n\t\timageChoicesAdmin.getSettingsElement().find('#image-choices-align').val( value );\n\t};\n\n\timageChoicesAdmin.updateImageStyleSetting = function( value, forProductImage ) {\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\t\tSetFieldProperty( `${propPrefix}_imageStyle`, value );\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-image-style`).val( value );\n\t};\n\n\timageChoicesAdmin.validateNumericValue = function( val ) {\n\t\tvar numVal = '';\n\t\tval = val.toString();\n\t\tif ( val.trim() !== '' ) {\n\t\t\tvar num = parseInt(val, 10);\n\t\t\tif ( isNaN(num) || num <= 0 ) {\n\t\t\t\tnumVal = '';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnumVal = num.toString();\n\t\t\t}\n\t\t}\n\t\treturn ( numVal !== val ) ? numVal : val;\n\t};\n\n\timageChoicesAdmin.updateColumnsSetting = function( value ) {\n\t\tSetFieldProperty( 'imageChoices_columns', value );\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\t$settings.find('#image-choices-columns').val( value );\n\t\t$settings.find('.image-choices-setting-columns-width').toggle( value === 'fixed' );\n\t};\n\n\timageChoicesAdmin.updateColumnsWidthSetting = function( value ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tSetFieldProperty( 'imageChoices_columnsWidth', numVal );\n\t\timageChoicesAdmin.getSettingsElement().find('#image-choices-columns-width').val( numVal );\n\t};\n\n\timageChoicesAdmin.updateColumnsMediumSetting = function( value ) {\n\t\tSetFieldProperty( 'imageChoices_columnsMedium', value );\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\t$settings.find('#image-choices-columns-medium').val( value );\n\t\t$settings.find('.image-choices-setting-columns-width-medium').toggle( value === 'fixed' );\n\t};\n\n\timageChoicesAdmin.updateColumnsMediumWidthSetting = function( value ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tSetFieldProperty( 'imageChoices_columnsWidthMedium', numVal );\n\t\timageChoicesAdmin.getSettingsElement().find('#image-choices-columns-width-medium').val( numVal );\n\t};\n\n\timageChoicesAdmin.updateColumnsSmallSetting = function( value ) {\n\t\tSetFieldProperty( 'imageChoices_columnsSmall', value );\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\t$settings.find('#image-choices-columns-small').val( value );\n\t\t$settings.find('.image-choices-setting-columns-width-small').toggle( value === 'fixed' );\n\t};\n\n\timageChoicesAdmin.updateColumnsSmallWidthSetting = function( value ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tSetFieldProperty( 'imageChoices_columnsWidthSmall', numVal );\n\t\timageChoicesAdmin.getSettingsElement().find('#image-choices-columns-width-small').val( numVal );\n\t};\n\n\timageChoicesAdmin.updateHeightSetting = function( value, forProductImage ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\n\t\tSetFieldProperty( `${propPrefix}_height`, numVal );\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-height`).val( numVal );\n\t};\n\n\timageChoicesAdmin.updateMediumHeightSetting = function( value, forProductImage ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\n\t\tSetFieldProperty( `${propPrefix}_heightMedium`, numVal );\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-height-medium`).val( numVal );\n\t};\n\n\timageChoicesAdmin.updateSmallHeightSetting = function( value, forProductImage ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\n\t\tSetFieldProperty( `${propPrefix}_heightSmall`, numVal );\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-height-small`).val( numVal );\n\t};\n\n\timageChoicesAdmin.initProductImageField = function(field) {\n\t\tvar $field = $('#field_'+field.id);\n\t\t$field.addClass('product-image-admin-field');\n\t\t$field.addClass('product-image-enabled');\n\t\tif ( imageChoicesAdmin.hasProductImage(field) ) {\n\t\t\t$field.addClass('has-product-image');\n\t\t}\n\t\timageChoicesAdmin.updateFieldPreview(field);\n\t};\n\n\timageChoicesAdmin.initImageChoicesField = function(field) {\n\t\tvar $field = $('#field_'+field.id);\n\t\t$field.addClass('image-choices-admin-field');\n\t\t$field.addClass('image-choices-enabled');\n\t\tif ( imageChoicesAdmin.hasImageChoicesImage(field) ) {\n\t\t\t$field.addClass('image-choices-has-image');\n\t\t}\n\t\timageChoicesAdmin.updateFieldPreview(field);\n\t};\n\n\timageChoicesAdmin.formEditorInit = function() {\n\n\t\tgform.addAction( 'gform_after_refresh_field_preview', function(fieldId){\n\t\t\tvar field = GetSelectedField();\n\t\t\tif ( imageChoicesAdmin.isImageChoicesEnabled(field) ) {\n\t\t\t\timageChoicesAdmin.updateFieldPreview(field);\n\t\t\t}\n\t\t});\n\n\t\t// setup previews on load\n\t\tform.fields.forEach(function(f){\n\t\t\tif ( imageChoicesAdmin.isProductImageEnabled(f) ) {\n\t\t\t\timageChoicesAdmin.initProductImageField(f);\n\t\t\t}\n\t\t\telse if ( imageChoicesAdmin.isImageChoicesEnabled(f) ) {\n\t\t\t\timageChoicesAdmin.initImageChoicesField(f);\n\t\t\t}\n\t\t});\n\n\t\t$('.gfield.image-choices-admin-field').each(function(){\n\t\t\timageChoicesAdmin.$fieldChoices( $(this) ).each(function(){\n\t\t\t\tlet $choice = $(this);\n\t\t\t\tif ( !$choice.hasClass('gchoice_total') ) {\n\t\t\t\t\t$choice.addClass('image-choices-choice');\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t$('#gform_fields .gfield .ginput_container').each(function(){\n\t\t\timageChoicesAdmin.previewHeight( $(this) );\n\t\t});\n\n\n\t\t$(window).on('gf_update_field_choices', function() {\n\t\t\tsetTimeout(function() {\n\t\t\t\timageChoicesAdmin.getChoices();\n\t\t\t}, 10);\n\n\t\t\timageChoicesAdmin.previewHeight();\n\t\t});\n\n\t\t$(document).on('click', '.gf_insert_field_choice, .gf_delete_field_choice', function(e){\n\t\t\timageChoicesAdmin.previewHeight();\n\t\t});\n\n\t\tgform.addAction('gform_load_field_choices', function( fields ){\n\n\t\t\tsetTimeout(function(){\n\n\t\t\t\tvar field = ( typeof fields !== 'undefined' && fields.length ) ? fields[0] : GetSelectedField();\n\t\t\t\tvar $field = $('#field_'+field.id);\n\t\t\t\tvar $fieldSettings = imageChoicesAdmin.getSettingsElement();\n\n\t\t\t\tif ( imageChoicesAdmin.isProductImageField(field) ) {\n\n\t\t\t\t\t$('#field_base_price').on('change', imageChoicesAdmin.onProductPriceChange);\n\n\t\t\t\t\tvar productImageEnabled = imageChoicesAdmin.isProductImageEnabled(field);\n\n\t\t\t\t\tvar productImageUrl = (field.productImage_image !== undefined) ? field.productImage_image : '';\n\t\t\t\t\tvar productImageId = (field.productImage_imageId !== undefined) ? field.productImage_imageId : '';\n\t\t\t\t\tvar useProductImageLightbox = (field.productImage_useLightbox !== undefined) ? field.productImage_useLightbox : false;\n\t\t\t\t\tvar selectedProductImageTheme = (field.productImage_theme !== undefined) ? field.productImage_theme : 'form_setting';\n\t\t\t\t\tvar productImageStyle = (field.productImage_imageStyle !== undefined) ? field.productImage_imageStyle : 'form_setting';\n\t\t\t\t\tvar productImageUseLightboxCaption = (field.productImage_useLightboxCaption !== undefined) ? field.productImage_useLightboxCaption : true;\n\t\t\t\t\tif ( productImageUseLightboxCaption === \"form_setting\" || productImageUseLightboxCaption === \"\" ) {\n\t\t\t\t\t\tproductImageUseLightboxCaption = true;\n\t\t\t\t\t}\n\t\t\t\t\tvar productImageHeightSetting = (field.productImage_height !== undefined) ? field.productImage_height : '';\n\t\t\t\t\tvar productImageMediumHeightSetting = (field.productImage_heightMedium !== undefined) ? field.productImage_heightMedium : '';\n\t\t\t\t\tvar productImageSmallHeightSetting = (field.productImage_heightSmall !== undefined) ? field.productImage_heightSmall : '';\n\n\t\t\t\t\tvar productImageEntryValue = (field.productImage_entrySetting !== undefined) ? field.productImage_entrySetting : 'form_setting';\n\n\t\t\t\t\t$fieldSettings.addClass('product-image-field-settings');\n\n\t\t\t\t\timageChoicesAdmin.toggleEnableImages(productImageEnabled, true);\n\n\t\t\t\t\timageChoicesAdmin.updateProductImage(productImageUrl, productImageId);\n\n\t\t\t\t\timageChoicesAdmin.toggleUseLightbox(useProductImageLightbox, true);\n\t\t\t\t\timageChoicesAdmin.toggleUseLightboxCaption(productImageUseLightboxCaption, true);\n\n\t\t\t\t\timageChoicesAdmin.updateThemeSetting(selectedProductImageTheme, true);\n\t\t\t\t\timageChoicesAdmin.updateImageStyleSetting(productImageStyle, true);\n\n\t\t\t\t\timageChoicesAdmin.updateHeightSetting(productImageHeightSetting, true);\n\t\t\t\t\timageChoicesAdmin.updateMediumHeightSetting(productImageMediumHeightSetting, true);\n\t\t\t\t\timageChoicesAdmin.updateSmallHeightSetting(productImageSmallHeightSetting, true);\n\n\t\t\t\t\timageChoicesAdmin.updateEntrySetting(productImageEntryValue, true);\n\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\timageChoicesAdmin.toggleEnableImages(false, true);\n\t\t\t\t\timageChoicesAdmin.updateProductImage('');\n\t\t\t\t\timageChoicesAdmin.toggleUseLightboxCaption(true, true);\n\t\t\t\t\timageChoicesAdmin.updateThemeSetting('form_setting', true);\n\t\t\t\t\timageChoicesAdmin.updateImageStyleSetting('form_setting', true);\n\n\t\t\t\t\timageChoicesAdmin.updateHeightSetting('', true);\n\t\t\t\t\timageChoicesAdmin.updateMediumHeightSetting('', true);\n\t\t\t\t\timageChoicesAdmin.updateSmallHeightSetting('', true);\n\n\t\t\t\t\timageChoicesAdmin.updateEntrySetting('', true);\n\n\t\t\t\t\t$field.removeClass('product-image-admin-field');\n\t\t\t\t\t$fieldSettings.removeClass('product-image-field-settings');\n\t\t\t\t}\n\n\t\t\t\tif ( imageChoicesAdmin.fieldCanHaveImages(field) ) {\n\n\t\t\t\t\tvar imagesEnabled = (field.imageChoices_enableImages === true);\n\t\t\t\t\tvar useLightbox = (field.imageChoices_useLightbox !== undefined) ? field.imageChoices_useLightbox : false;\n\t\t\t\t\tvar displayLabels = (field.imageChoices_showLabels !== undefined) ? field.imageChoices_showLabels : true;\n\t\t\t\t\tvar showPrices = (field.type === 'product' && field.imageChoices_showPrices !== undefined) ? field.imageChoices_showPrices : false;\n\t\t\t\t\tvar entryValue = (field.imageChoices_entrySetting !== undefined) ? field.imageChoices_entrySetting : 'form_setting';\n\t\t\t\t\tvar selectedTheme = (field.imageChoices_theme !== undefined) ? field.imageChoices_theme : 'form_setting';\n\t\t\t\t\tvar featureColor = (field.imageChoices_featureColor !== undefined) ? field.imageChoices_featureColor : 'form_setting';\n\t\t\t\t\tvar featureColorCustom = (field.imageChoices_featureColorCustom !== undefined) ? field.imageChoices_featureColorCustom : '';\n\t\t\t\t\tvar alignSetting = (field.imageChoices_align !== undefined) ? field.imageChoices_align : 'form_setting';\n\t\t\t\t\tvar imageStyle = (field.imageChoices_imageStyle !== undefined) ? field.imageChoices_imageStyle : 'form_setting';\n\t\t\t\t\tvar columnsSetting = (field.imageChoices_columns !== undefined) ? field.imageChoices_columns : 'form_setting';\n\t\t\t\t\tvar columnsWidthSetting = (field.imageChoices_columnsWidth !== undefined) ? field.imageChoices_columnsWidth : '';\n\t\t\t\t\tvar columnsMediumSetting = (field.imageChoices_columnsMedium !== undefined) ? field.imageChoices_columnsMedium : 'form_setting';\n\t\t\t\t\tvar columnsMediumWidthSetting = (field.imageChoices_columnsWidthMedium !== undefined) ? field.imageChoices_columnsWidthMedium : '';\n\t\t\t\t\tvar columnsSmallSetting = (field.imageChoices_columnsSmall !== undefined) ? field.imageChoices_columnsSmall : 'form_setting';\n\t\t\t\t\tvar columnsSmallWidthSetting = (field.imageChoices_columnsWidthSmall !== undefined) ? field.imageChoices_columnsWidthSmall : '';\n\t\t\t\t\tvar useLightboxCaption = (field.imageChoices_useLightboxCaption !== undefined) ? field.imageChoices_useLightboxCaption : true;\n\t\t\t\t\tif ( useLightboxCaption === \"form_setting\" || useLightboxCaption === \"\" ) {\n\t\t\t\t\t\tuseLightboxCaption = true;\n\t\t\t\t\t}\n\t\t\t\t\tvar heightSetting = (field.imageChoices_height !== undefined) ? field.imageChoices_height : '';\n\t\t\t\t\tvar mediumHeightSetting = (field.imageChoices_heightMedium !== undefined) ? field.imageChoices_heightMedium : '';\n\t\t\t\t\tvar smallHeightSetting = (field.imageChoices_heightSmall !== undefined) ? field.imageChoices_heightSmall : '';\n\n\t\t\t\t\t$fieldSettings.addClass('image-choices-field-settings');\n\n\t\t\t\t\timageChoicesAdmin.toggleEnableImages(imagesEnabled);\n\t\t\t\t\timageChoicesAdmin.toggleUseLightbox(useLightbox);\n\t\t\t\t\timageChoicesAdmin.toggleShowLabels(displayLabels);\n\t\t\t\t\timageChoicesAdmin.toggleShowPrices(showPrices);\n\t\t\t\t\timageChoicesAdmin.updateEntrySetting(entryValue);\n\t\t\t\t\timageChoicesAdmin.toggleUseLightboxCaption(useLightboxCaption);\n\n\t\t\t\t\tif ( !imageChoicesAdmin.isLegacyMode() ) {\n\t\t\t\t\t\timageChoicesAdmin.updateThemeSetting(selectedTheme);\n\t\t\t\t\t\timageChoicesAdmin.updateCustomFeatureColor(featureColorCustom);\n\t\t\t\t\t\timageChoicesAdmin.updateFeatureColorSetting(featureColor);\n\t\t\t\t\t\timageChoicesAdmin.updateAlignSetting(alignSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateImageStyleSetting(imageStyle);\n\n\t\t\t\t\t\timageChoicesAdmin.updateHeightSetting(heightSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateMediumHeightSetting(mediumHeightSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateSmallHeightSetting(smallHeightSetting);\n\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsWidthSetting(columnsWidthSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsMediumWidthSetting(columnsMediumWidthSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSmallWidthSetting(columnsSmallWidthSetting);\n\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSetting(columnsSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsMediumSetting(columnsMediumSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSmallSetting(columnsSmallSetting);\n\t\t\t\t\t}\n\n\t\t\t\t\timageChoicesAdmin.getChoices( field );\n\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\timageChoicesAdmin.toggleEnableImages(false);\n\t\t\t\t\timageChoicesAdmin.toggleUseLightboxCaption(true);\n\t\t\t\t\t//imageChoicesAdmin.toggleShowLabels(false);\n\n\t\t\t\t\tif ( !imageChoicesAdmin.isLegacyMode() ) {\n\t\t\t\t\t\timageChoicesAdmin.updateThemeSetting('form_setting');\n\t\t\t\t\t\timageChoicesAdmin.updateCustomFeatureColor('');\n\t\t\t\t\t\timageChoicesAdmin.updateFeatureColorSetting('form_setting');\n\t\t\t\t\t\timageChoicesAdmin.updateAlignSetting('form_setting');\n\t\t\t\t\t\timageChoicesAdmin.updateImageStyleSetting('form_setting');\n\n\t\t\t\t\t\timageChoicesAdmin.updateHeightSetting('');\n\t\t\t\t\t\timageChoicesAdmin.updateMediumHeightSetting('');\n\t\t\t\t\t\timageChoicesAdmin.updateSmallHeightSetting('');\n\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsWidthSetting('');\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsMediumWidthSetting('');\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSmallWidthSetting('');\n\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSetting('form_setting');\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsMediumSetting('form_setting');\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSmallSetting('form_setting');\n\t\t\t\t\t}\n\n\t\t\t\t\t$field.removeClass('image-choices-show-labels');\n\t\t\t\t\t$fieldSettings.removeClass('image-choices-field-settings');\n\t\t\t\t\t$fieldSettings.remove('image-choices-product-field');\n\t\t\t\t}\n\n\t\t\t}, 100);\n\n\t\t});\n\n\t\t$(document).bind('gform_load_field_settings', function (event, field, form) {\n\n\t\t\t// There's currently no action or event fired by GF when the 'show values' or 'show prices' option is toggled, but the preview updates\n\t\t\t// So we override the global UpdateFieldChoices that is called at this point (GF form_editor.js) in order to fire our own gf_update_field_choices event so we can update preview\n\t\t\tif (typeof window.imageChoices_GF_UpdateFieldChoices !== 'function' && typeof UpdateFieldChoices === 'function') {\n\t\t\t\twindow.imageChoices_GF_UpdateFieldChoices = UpdateFieldChoices;\n\t\t\t\twindow.UpdateFieldChoices = function() {\n\t\t\t\t\twindow.imageChoices_GF_UpdateFieldChoices.apply(this, arguments);\n\t\t\t\t\t$(window).trigger('gf_update_field_choices');\n\t\t\t\t};\n\t\t\t}\n\n\t\t\timageChoicesAdmin.previewHeight();\n\t\t});\n\n\t};\n\n\timageChoicesAdmin.formEditorLegacyWarning = function() {\n\n\t\treturn;\n\n\t\tvar alertMessage = [\n\t\t\t'<div class=\"gform-alert\" data-js=\"gform-alert\" role=\"status\" data-gform-alert-instance=\"gfic-legacy-alert-' + window.form.id.toString() + '\">',\n\t\t\t\t'<span class=\"gform-alert__icon gform-icon gform-icon--warning\" aria-hidden=\"true\"></span>',\n\t\t\t\t'<div class=\"gform-alert__message-wrap\">',\n\t\t\t\t\t'<p class=\"gform-alert__message\">JetSloth will stop supporting legacy markup at the end of 2023. We encourage you to test out your form with legacy markup turned off, to ensure continued compatibility with Image Choices.</p>',\n\t\t\t\t\t'<a class=\"gform-alert__cta gform-button gform-button--white gform-button--size-xs\" href=\"' + window.imageChoicesVars.form_settings + window.form.id.toString() + '#gform_setting_markupVersion\" aria-label=\"\">Form settings</a>',\n\t\t\t\t'</div>',\n\t\t\t'</div>',\n\t\t].join('');\n\n\t\tvar $gfLegacyAlert = $('.simplebar-content > .gform-alert[data-gform-alert-instance^=\"gform-alert-\"]:first');\n\t\tif ( $gfLegacyAlert.length ) {\n\t\t\t$gfLegacyAlert.after(alertMessage);\n\t\t}\n\t\telse {\n\t\t\t$('.simplebar-content').prepend(alertMessage);\n\t\t}\n\t\tgform.tools.trigger( 'gform_init_alerts' );\n\n\t};\n\n\n\t$(document).bind( 'gform_main_scripts_loaded', function() {\n\n\t\tif ( typeof window.form !== 'undefined' ) {\n\t\t\tvar markupVersion = imageChoicesAdmin.markupDetect();\n\t\t\tif ( markupVersion === 1 && imageChoicesAdmin.formHasImageChoicesFields() ) {\n\t\t\t\timageChoicesAdmin.formEditorLegacyWarning();\n\t\t\t}\n\t\t\timageChoicesAdmin.formEditorInit();\n\t\t}\n\n\t\t// Custom CSS editors\n\t\tvar $customCssBoxes = $('#gf_image_choices_custom_css_global, #gf_image_choices_custom_css, #gf_image_choices_user_css_global, #gf_image_choices_user_css_form');\n\t\tif ( $customCssBoxes.length ) {\n\t\t\tvar editorSettings = wp.codeEditor.defaultSettings ? _.clone( wp.codeEditor.defaultSettings ) : {};\n\t\t\teditorSettings.codemirror = _.extend(\n\t\t\t\t{},\n\t\t\t\teditorSettings.codemirror,\n\t\t\t\t{\n\t\t\t\t\tindentUnit: 4,\n\t\t\t\t\ttabSize: 4,\n\t\t\t\t\tmode: 'css',\n\t\t\t\t\tlineNumbers: true,\n\t\t\t\t\tautoCloseBrackets: true,\n\t\t\t\t\tcontinueComments: true,\n\t\t\t\t\tindentWithTabs: true,\n\t\t\t\t\tinputStyle: \"contenteditable\",\n\t\t\t\t\tlineWrapping: true,\n\t\t\t\t\tlint: false,\n\t\t\t\t\tmatchBrackets: true,\n\t\t\t\t\tstyleActiveLine: true,\n\t\t\t\t\tgutters: [],\n\t\t\t\t\textraKeys: {\n\t\t\t\t\t\t\"Alt-F\": \"findPersistent\",\n\t\t\t\t\t\t\"Cmd-F\": \"findPersistent\",\n\t\t\t\t\t\t\"Ctrl-F\": \"findPersistent\",\n\t\t\t\t\t\t\"Cmd-/\": \"toggleComment\",\n\t\t\t\t\t\t\"Ctrl-/\": \"toggleComment\",\n\t\t\t\t\t\t\"Ctrl-Space\": \"autocomplete\",\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t\t$customCssBoxes.each(function(){\n\t\t\t\twindow[this.id + '_editor'] = wp.codeEditor.initialize( $(this), editorSettings );\n\t\t\t});\n\t\t}\n\n\t\tvar $legacyCssSectionToggle = $('#gform_settings_section_collapsed_gf_image_choices_legacy_custom_css_section, #gform_settings_section_collapsed_gf_image_choices_legacy_custom_form_css_section');\n\t\tif ( $legacyCssSectionToggle.length ) {\n\t\t\t$legacyCssSectionToggle.on('click', function(){\n\t\t\t\t$(this).closest('.gform-settings-panel').find('textarea').each(function(){\n\t\t\t\t\tvar ref = $(this).attr('id') + '_editor';\n\t\t\t\t\ttry {\n\t\t\t\t\t\twindow[ref].codemirror.refresh();\n\t\t\t\t\t}\n\t\t\t\t\tcatch(e) {\n\t\t\t\t\t\t// do nothing\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\n\t\t// show/hide new settings based on toggle\n\t\tvar $legacyModeToggle = $('#_gform_setting_gf_image_choices_use_legacy_styles');\n\t\tvar $newFeaturesElements = $('#gform-settings-section-theme, #gform-settings-section-feature-color, #gform-settings-section-choices-layout, #gform-settings-section-image-options, #gform-settings-section-custom-css, #gform-settings-section-gf_image_choices_legacy_custom_css_section .gform-settings-label');\n\n\t\tif ( $legacyModeToggle.length ) {\n\t\t\t$legacyModeToggle.on('change', function(e){\n\t\t\t\tvar useLegacyMode = $legacyModeToggle.is(':checked');\n\t\t\t\tif ( $newFeaturesElements.length ) {\n\t\t\t\t\t$newFeaturesElements.toggle( !useLegacyMode );\n\t\t\t\t}\n\t\t\t\tif ( $legacyCssSectionToggle.length ) {\n\t\t\t\t\tif ( ( useLegacyMode && $legacyCssSectionToggle.is(\":checked\") ) || ( !useLegacyMode && !$legacyCssSectionToggle.is(\":checked\") ) ) {\n\t\t\t\t\t\t$legacyCssSectionToggle.click();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t$legacyModeToggle.trigger('change');\n\t\t}\n\n\n\n\t\t// settings page tab switch (hide submit if not settings tab)\n\t\tvar $settingsTabNavLinks = $('#tab_gf-image-choices .gform-settings-tabs__navigation a');\n\t\tif ( $settingsTabNavLinks.length ) {\n\t\t\t$settingsTabNavLinks.each(function(){\n\t\t\t\t$(this).on('click', function(e){\n\t\t\t\t\t$('#tab_gf-image-choices #gform-settings-save').toggle( $(this).data('tab') === \"gf_image_choices_settings_tab\" );\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\n\t\t// numeric settings live validation to number (plugin and form settings)\n\t\tvar $numericSettingsInputs = $('input[id^=\"gf_image_choices\"][id*=\"columns_width\"], input[id^=\"image-choices\"][id*=\"columns-width\"], input[id^=\"gf_image_choices\"][id*=\"height\"], input[id^=\"image-choices\"][id*=\"height\"], input[id^=\"product-image\"][id*=\"height\"]');\n\t\tif ( $numericSettingsInputs.length ) {\n\t\t\t$numericSettingsInputs.each(function(){\n\t\t\t\tvar $input = $(this);\n\t\t\t\t$input.on('keyup', function(e){\n\t\t\t\t\tvar val = e.currentTarget.value.toString();\n\t\t\t\t\tvar numVal = imageChoicesAdmin.validateNumericValue( val );\n\t\t\t\t\tif ( numVal !== val ) {\n\t\t\t\t\t\te.currentTarget.value = numVal;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\n\t\t// form settings theme preview\n\t\tvar $settingsThemeSelect = $('#gf_image_choices_theme, #gf_image_choices_global_theme').first();\n\t\tvar $settingsThemePreview = $('#gform_setting_gf_image_choices_theme_preview .image-choices-theme-preview, #gform_setting_gf_image_choices_global_theme_preview .image-choices-theme-preview').first();\n\t\tif ( $settingsThemeSelect.length && $settingsThemePreview.length ) {\n\t\t\t$settingsThemeSelect.on('change', function(e){\n\t\t\t\tvar value = $(this).val();\n\t\t\t\tif ( value === \"\" || value == \"global_setting\" ) {\n\t\t\t\t\tvalue = ( imageChoicesVars.hasOwnProperty('globals') && imageChoicesVars.globals.hasOwnProperty('theme') ) ? imageChoicesVars.globals.theme : ( imageChoicesVars.hasOwnProperty('defaults') && imageChoicesVars.defaults.hasOwnProperty('theme') ) ? imageChoicesVars.defaults.theme : 'simple';\n\t\t\t\t}\n\n\t\t\t\t$settingsThemePreview.toggle(value !== 'none');\n\t\t\t\tif (value === 'none') {\n\t\t\t\t\t$settingsThemePreview.hide().find('img').hide();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t$settingsThemePreview.find('img').hide();\n\t\t\t\t\t$settingsThemePreview.find('img.image-choices-theme-preview-'+value).show();\n\t\t\t\t}\n\t\t\t});\n\t\t\t$settingsThemeSelect.trigger('change');\n\t\t}\n\n\t\t// form settings feature color\n\t\tvar $settingsFeatureColorSelect = $('#gf_image_choices_feature_color, #gf_image_choices_global_feature_color').first();\n\t\tvar $settingsFeatureColorCustom = $('#gform_setting_gf_image_choices_feature_color_custom, #gform_setting_gf_image_choices_global_feature_color_custom').first();\n\t\tvar $settingsFeatureColorInput = $('#gf_image_choices_feature_color_custom, #gf_image_choices_global_feature_color_custom').first();\n\t\tvar settingsCustomFeatureColor;\n\t\tvar $settingsFeatureColorPicker;\n\n\t\tif ( $settingsFeatureColorSelect.length && $settingsFeatureColorCustom.length ) {\n\n\t\t\t$settingsFeatureColorPicker = $settingsFeatureColorCustom.find('.wp-picker-container');\n\t\t\tsettingsCustomFeatureColor = $settingsFeatureColorInput.val();\n\n\t\t\t$settingsFeatureColorSelect.on('change', function(e){\n\t\t\t\tvar value = $(this).val();\n\n\t\t\t\tif ( value === \"custom\" ) {\n\t\t\t\t\t$settingsFeatureColorCustom.show();\n\t\t\t\t\tif ( $settingsFeatureColorPicker.length ) {\n\t\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\t\tif ( customColor !== \"\" ) {\n\t\t\t\t\t\t\t\t$settingsFeatureColorInput.wpColorPicker('color', settingsCustomFeatureColor);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t$settingsFeatureColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 100);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$settingsFeatureColorInput.wpColorPicker();\n\t\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\t\tif ( settingsCustomFeatureColor !== \"\" ) {\n\t\t\t\t\t\t\t\t$settingsFeatureColorInput.wpColorPicker('color', settingsCustomFeatureColor);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t$settingsFeatureColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 100);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t$settingsFeatureColorCustom.hide();\n\t\t\t\t\tif ( $settingsFeatureColorPicker.length ) {\n\t\t\t\t\t\t$settingsFeatureColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t\t$settingsFeatureColorSelect.trigger('change');\n\t\t}\n\n\n\n\t\tvar $urlReplacementTool = $('#image_choices_url_replacement');\n\t\tvar $urlReplacementSubmit = ($urlReplacementTool.length) ? $('#image_choices_url_replacement_submit') : null;\n\t\tvar $urlReplacementProgress = ($urlReplacementTool.length) ? $urlReplacementTool.find('.jetbase-tool__progress') : null;\n\t\tvar $urlReplacementProgressBar = ($urlReplacementTool.length) ? $urlReplacementTool.find('.jetbase-tool__progress-percent') : null;\n\t\tvar $urlReplacementStatus = ($urlReplacementTool.length) ? $urlReplacementTool.find('.jetbase-tool__progress-status') : null;\n\n\t\tvar urlReplacements = {\n\t\t\told: \"\",\n\t\t\tnew: \"\",\n\t\t\tforms: [],\n\t\t\tindex: 0,\n\t\t\treplacements: []\n\t\t}\n\n\t\timageChoicesAdmin.processUrlReplacement = function() {\n\t\t\tif ( !urlReplacements.forms.length || urlReplacements.replacements.length === urlReplacements.forms.length || urlReplacements.index >= urlReplacements.forms.length ) {\n\t\t\t\t// done\n\t\t\t\t$urlReplacementProgressBar.css('width', `100%`);\n\t\t\t\t$urlReplacementStatus.html(`Done! ${urlReplacements.forms.length} form(s) processed`);\n\t\t\t\t$urlReplacementTool.removeClass('busy');\n\t\t\t\tif ( $sizeReplacementTool.length ) {\n\t\t\t\t\t$sizeReplacementTool.removeClass('disabled');\n\t\t\t\t}\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t$.ajax({\n\t\t\t\turl: window.ajaxurl,\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'gf_image_choices_url_replacement',\n\t\t\t\t\tid: urlReplacements.forms[urlReplacements.index],\n\t\t\t\t\told: urlReplacements.old,\n\t\t\t\t\tnew: urlReplacements.new\n\t\t\t\t},\n\t\t\t\tbeforeSend: function(jqXHR, settings){\n\t\t\t\t\t$urlReplacementStatus.html(`Processing form ${urlReplacements.index + 1}/${urlReplacements.forms.length}`);\n\t\t\t\t},\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif ( response && response.success ) {\n\t\t\t\t\t\turlReplacements.replacements[urlReplacements.index] = response.total;\n\t\t\t\t\t}\n\t\t\t\t\telse if ( response && response.error ) {\n\t\t\t\t\t\turlReplacements.replacements[urlReplacements.index] = false;\n\t\t\t\t\t\t$urlReplacementStatus.html('Error: ' + response.error );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\turlReplacements.replacements[urlReplacements.index] = false;\n\t\t\t\t\t\t$urlReplacementStatus.html('Error');\n\t\t\t\t\t}\n\t\t\t\t\turlReplacements.index++;\n\t\t\t\t\t$urlReplacementProgressBar.css('width', `${ Math.ceil( (urlReplacements.index / urlReplacements.forms.length) * 100 ) }%`);\n\t\t\t\t\timageChoicesAdmin.processUrlReplacement();\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\n\t\tif ( $urlReplacementSubmit && $urlReplacementSubmit.length ) {\n\n\t\t\t$urlReplacementSubmit.on('click', function(e){\n\t\t\t\te.preventDefault();\n\n\t\t\t\tvar formId = $urlReplacementTool.find('#image_choices_url_replacement_form_select').val().trim();\n\t\t\t\tvar oldUrl = $urlReplacementTool.find('#image_choices_url_replacement_from_input').val().trim();\n\t\t\t\tvar newUrl = $urlReplacementTool.find('#image_choices_url_replacement_to_input').val().trim();\n\t\t\t\tif ( !oldUrl || !newUrl || oldUrl === newUrl ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\turlReplacements.old = oldUrl;\n\t\t\t\turlReplacements.new = newUrl;\n\t\t\t\turlReplacements.forms = [];\n\t\t\t\turlReplacements.index = 0;\n\t\t\t\turlReplacements.replacements = [];\n\n\t\t\t\tif ( formId === \"all\" ) {\n\n\t\t\t\t\t$urlReplacementStatus.html('Scanning for forms with old URL in image choices...');\n\t\t\t\t\t$urlReplacementProgressBar.css('width', '0%');\n\t\t\t\t\t$urlReplacementTool.addClass('busy');\n\t\t\t\t\t$urlReplacementProgress.addClass('active');\n\t\t\t\t\tif ( $sizeReplacementTool.length ) {\n\t\t\t\t\t\t$sizeReplacementTool.addClass('disabled');\n\t\t\t\t\t}\n\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\turl: window.ajaxurl,\n\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'gf_image_choices_get_url_replacement_form_ids',\n\t\t\t\t\t\t\tform_id: urlReplacements.formId,\n\t\t\t\t\t\t\told: urlReplacements.old,\n\t\t\t\t\t\t\tnew: urlReplacements.new\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\t\tif ( response && response.success ) {\n\t\t\t\t\t\t\t\tif ( response.forms && response.forms.length ) {\n\t\t\t\t\t\t\t\t\turlReplacements.forms = response.forms\n\t\t\t\t\t\t\t\t\timageChoicesAdmin.processUrlReplacement();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t$urlReplacementProgressBar.css('width', `100%`);\n\t\t\t\t\t\t\t\t\t$urlReplacementStatus.html(`Done! No image choices found containing that old URL`);\n\t\t\t\t\t\t\t\t\t$urlReplacementTool.removeClass('busy');\n\t\t\t\t\t\t\t\t\tif ( $sizeReplacementTool.length ) {\n\t\t\t\t\t\t\t\t\t\t$sizeReplacementTool.removeClass('disabled');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if ( response && response.error ) {\n\t\t\t\t\t\t\t\t$urlReplacementStatus.html('Error: ' + response.error );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t$urlReplacementStatus.html('Error');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\t$urlReplacementStatus.html('...');\n\t\t\t\t\t$urlReplacementProgressBar.css('width', '0%');\n\t\t\t\t\t$urlReplacementTool.addClass('busy');\n\t\t\t\t\t$urlReplacementProgress.addClass('active');\n\t\t\t\t\tif ( $sizeReplacementTool.length ) {\n\t\t\t\t\t\t$sizeReplacementTool.addClass('disabled');\n\t\t\t\t\t}\n\n\t\t\t\t\turlReplacements.forms = [ formId ]\n\t\t\t\t\timageChoicesAdmin.processUrlReplacement();\n\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t}\n\n\n\t\tvar $sizeReplacementTool = $('#image_choices_image_replacement');\n\t\tvar $sizeReplacementSubmit = ($sizeReplacementTool.length) ? $('#image_choices_image_replacement_submit') : null;\n\t\tvar $sizeReplacementProgress = ($sizeReplacementTool.length) ? $sizeReplacementTool.find('.jetbase-tool__progress') : null;\n\t\tvar $sizeReplacementProgressBar = ($sizeReplacementTool.length) ? $sizeReplacementTool.find('.jetbase-tool__progress-percent') : null;\n\t\tvar $sizeReplacementStatus = ($sizeReplacementTool.length) ? $sizeReplacementTool.find('.jetbase-tool__progress-status') : null;\n\n\t\tvar sizeReplacements = {\n\t\t\tnew: \"\",\n\t\t\tforms: [],\n\t\t\tindex: 0,\n\t\t\treplacements: []\n\t\t}\n\n\t\timageChoicesAdmin.processSizeReplacement = function() {\n\t\t\tif ( !sizeReplacements.forms.length || sizeReplacements.replacements.length === sizeReplacements.forms.length || sizeReplacements.index >= sizeReplacements.forms.length ) {\n\t\t\t\t// done\n\t\t\t\t$sizeReplacementProgressBar.css('width', `100%`);\n\t\t\t\t$sizeReplacementStatus.html(`Done! ${sizeReplacements.forms.length} form(s) processed`);\n\t\t\t\t$sizeReplacementTool.removeClass('busy');\n\t\t\t\tif ( $urlReplacementTool.length ) {\n\t\t\t\t\t$urlReplacementTool.removeClass('disabled');\n\t\t\t\t}\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t$.ajax({\n\t\t\t\turl: window.ajaxurl,\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'gf_image_choices_image_size_replacement',\n\t\t\t\t\tid: sizeReplacements.forms[sizeReplacements.index],\n\t\t\t\t\tnew: sizeReplacements.new\n\t\t\t\t},\n\t\t\t\tbeforeSend: function(jqXHR, settings) {\n\t\t\t\t\t$sizeReplacementStatus.html(`Processing form ${sizeReplacements.index + 1}/${sizeReplacements.forms.length}`);\n\t\t\t\t},\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif ( response && response.success ) {\n\t\t\t\t\t\tsizeReplacements.replacements[sizeReplacements.index] = response.total;\n\t\t\t\t\t}\n\t\t\t\t\telse if ( response && response.error ) {\n\t\t\t\t\t\tsizeReplacements.replacements[sizeReplacements.index] = false;\n\t\t\t\t\t\t$sizeReplacementStatus.html('Error: ' + response.error );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tsizeReplacements.replacements[sizeReplacements.index] = false;\n\t\t\t\t\t\t$sizeReplacementStatus.html('Error');\n\t\t\t\t\t}\n\t\t\t\t\tsizeReplacements.index++;\n\t\t\t\t\t$sizeReplacementProgressBar.css('width', `${ Math.ceil( (sizeReplacements.index / sizeReplacements.forms.length) * 100 ) }%`);\n\t\t\t\t\timageChoicesAdmin.processSizeReplacement();\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\n\t\tif ( $sizeReplacementSubmit && $sizeReplacementSubmit.length ) {\n\n\t\t\t$sizeReplacementSubmit.on('click', function(e){\n\t\t\t\te.preventDefault();\n\n\t\t\t\tvar newSize = $sizeReplacementTool.find('#image_choices_image_replacement_size_select').val().trim();\n\t\t\t\tvar formId = $sizeReplacementTool.find('#image_choices_image_replacement_form_select').val().trim();\n\t\t\t\tif ( !newSize ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tsizeReplacements.new = newSize;\n\t\t\t\tsizeReplacements.forms = [];\n\t\t\t\tsizeReplacements.index = 0;\n\t\t\t\tsizeReplacements.replacements = [];\n\n\n\t\t\t\tif ( formId === \"all\" ) {\n\n\t\t\t\t\t$sizeReplacementStatus.html('Scanning for forms with image choices enabled...');\n\t\t\t\t\t$sizeReplacementProgressBar.css('width', '0%');\n\t\t\t\t\t$sizeReplacementTool.addClass('busy');\n\t\t\t\t\t$sizeReplacementProgress.addClass('active');\n\n\t\t\t\t\tif ( $urlReplacementTool.length ) {\n\t\t\t\t\t\t$urlReplacementTool.addClass('disabled');\n\t\t\t\t\t}\n\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\turl: window.ajaxurl,\n\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'gf_image_choices_get_image_size_replacement_form_ids',\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\t\tif ( response && response.success ) {\n\t\t\t\t\t\t\t\tif ( response.forms && response.forms.length ) {\n\t\t\t\t\t\t\t\t\tsizeReplacements.forms = response.forms\n\t\t\t\t\t\t\t\t\timageChoicesAdmin.processSizeReplacement();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t$sizeReplacementProgressBar.css('width', `100%`);\n\t\t\t\t\t\t\t\t\t$sizeReplacementStatus.html(`Done! No forms found with image choices enabled`);\n\t\t\t\t\t\t\t\t\t$sizeReplacementTool.removeClass('busy');\n\t\t\t\t\t\t\t\t\tif ( $urlReplacementTool.length ) {\n\t\t\t\t\t\t\t\t\t\t$urlReplacementTool.removeClass('disabled');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if ( response && response.error ) {\n\t\t\t\t\t\t\t\t$sizeReplacementStatus.html('Error: ' + response.error );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t$sizeReplacementStatus.html('Error');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\t$sizeReplacementStatus.html('...');\n\t\t\t\t\t$sizeReplacementProgressBar.css('width', '0%');\n\t\t\t\t\t$sizeReplacementTool.addClass('busy');\n\t\t\t\t\t$sizeReplacementProgress.addClass('active');\n\n\t\t\t\t\tif ( $urlReplacementTool.length ) {\n\t\t\t\t\t\t$urlReplacementTool.addClass('disabled');\n\t\t\t\t\t}\n\n\t\t\t\t\tsizeReplacements.forms = [ formId ];\n\t\t\t\t\timageChoicesAdmin.processSizeReplacement();\n\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t}\n\n\n\t});\n\n})(jQuery);\n"],"mappings":"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"}