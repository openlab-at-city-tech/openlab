{"version":3,"file":"gf_image_choices_admin.min.js","names":["imageChoicesAdmin","$","ttUpdateDelay","GF_MARKUP_VERSION","extend","arguments","extended","deep","i","merge","obj","prop","hasOwnProperty","Object","prototype","toString","call","length","__dialogDefaults","dialogType","cancelText","confirmText","allowCancel","promptLabel","promptPlaceholder","promptValue","title","content","image","onConfirm","onCancel","closeDialog","dialogId","dialog","document","getElementById","classList","remove","setTimeout","dialogBg","querySelector","options","_options","allOptions","dialogCount","querySelectorAll","baseZindex","createElement","add","dataset","for","style","zIndex","cancelButton","promptInput","id","innerHTML","body","append","addEventListener","e","preventDefault","thisId","currentTarget","closest","val","value","undefined","prompt","confirm","alert","markupDetect","window","form","markupVersion","parseInt","isLegacyMode","imageChoicesVars","useNewFeatures","formHasImageChoicesFields","hasImageChoicesFields","each","fields","field","imageChoices_enableImages","markup","removeChoicesButton","imageChoicesFieldStrings","removeAllChoices","choicesAdminRow","index","img","uploadImage","removeImage","join","choicesPreviewRow","labelText","getChoices","GetSelectedField","getSettingsElement","find","$row","this","data","choices","imageChoices_image","imgID","imageChoices_imageID","$firstInput","before","addClass","updateFieldPreview","RemovePreview","btnEl","$choice","css","removeClass","UpdateFieldChoicesObject","imageID","onProductPriceChange","$field","productImageField","type","inputType","$fieldLabel","$productImageWrap","imagesEnabled","hasProductImage","detach","prepend","productImage_image","basePrice","html","imageChoices_showLabels","toggleShowLabels","$fieldChoices","hasClass","toggleClass","$choiceLabel","gfttAdmin","clearTimeout","updateChoicesPreview","getField","trigger","$settingsWrap","isColorPickerPluginActive","colorPickerFieldVars","isImageChoicesEnabled","fieldCanHaveImages","hasImageChoicesImage","isProductImageField","isProductImageEnabled","productImage_enabled","hasProductImageId","productImage_imageId","onProductImageToggleClick","toggle","toggleEnableImages","checked","click","enable","forProductImage","isForProductImage","toggleSelector","$settings","$toggle","is","onToggleEnableImages","$coloPickerToggle","confirmImagesToggle","colorPicker_toggleEnableColors","imageChoices_toggleEnableImages","SetFieldProperty","$imageWrap","$label","choicesContainerSelector","toLowerCase","$removeChoicesBtn","$enableOtherChoicesSetting","show","toggleShowPrices","toggleUseLightboxCaption","toggleUseLightbox","lightboxCaptionSelector","useLightboxWarning","fieldChoice","hasImage","hasImageID","setProperty","updateEntrySetting","selectorPrefix","OpenMediaLibrary","image_fileFrame","open","wp","media","button","text","frame","state","multiple","jQuery","on","selection","get","attachment","first","display","toJSON","sizes","size","unshift","imageSize","url","updateProductImage","$choicesFlyout","canHave","gform","applyFilters","fieldSettingsSelector","previewHeight","$el","height","outerHeight","updateThemeSetting","$previewImg","$previewWrap","hide","gf_image_choices_theme","globals","theme","defaults","updateFeatureColorSetting","$customColorLabel","$customColorInput","$customColorPicker","customColor","wpColorPicker","change","ui","updateCustomFeatureColor","color","propPrefix","updateAlignSetting","updateImageStyleSetting","$select","optionText","substring","indexOf","validateNumericValue","numVal","trim","num","isNaN","updateColumnsSetting","updateColumnsWidthSetting","updateColumnsMediumSetting","updateColumnsMediumWidthSetting","updateColumnsSmallSetting","updateColumnsSmallWidthSetting","updateHeightSetting","updateMediumHeightSetting","updateSmallHeightSetting","initProductImageField","initImageChoicesField","formEditorInit","addAction","fieldId","forEach","f","$fieldSettings","productImageEnabled","productImageUrl","productImageId","useProductImageLightbox","productImage_useLightbox","selectedProductImageTheme","productImage_theme","productImageStyle","productImage_imageStyle","productImageUseLightboxCaption","productImage_useLightboxCaption","productImageHeightSetting","productImage_height","productImageMediumHeightSetting","productImage_heightMedium","productImageSmallHeightSetting","productImage_heightSmall","productImageEntryValue","productImage_entrySetting","useLightbox","imageChoices_useLightbox","displayLabels","showPrices","imageChoices_showPrices","entryValue","imageChoices_entrySetting","selectedTheme","imageChoices_theme","featureColor","imageChoices_featureColor","featureColorCustom","imageChoices_featureColorCustom","alignSetting","imageChoices_align","imageStyle","imageChoices_imageStyle","columnsSetting","imageChoices_columns","columnsWidthSetting","imageChoices_columnsWidth","columnsMediumSetting","imageChoices_columnsMedium","columnsMediumWidthSetting","imageChoices_columnsWidthMedium","columnsSmallSetting","imageChoices_columnsSmall","columnsSmallWidthSetting","imageChoices_columnsWidthSmall","useLightboxCaption","imageChoices_useLightboxCaption","heightSetting","imageChoices_height","mediumHeightSetting","imageChoices_heightMedium","smallHeightSetting","imageChoices_heightSmall","bind","event","imageChoices_GF_UpdateFieldChoices","UpdateFieldChoices","apply","formEditorLegacyWarning","adminInit","$customCssBoxes","editorSettings","codeEditor","defaultSettings","_","clone","codemirror","indentUnit","tabSize","mode","lineNumbers","autoCloseBrackets","continueComments","indentWithTabs","inputStyle","lineWrapping","lint","matchBrackets","styleActiveLine","gutters","extraKeys","initialize","$legacyCssSectionToggle","ref","attr","refresh","$globalStyleSelect","$formStyleSelect","$legacyModeToggle","$newFeaturesElements","useLegacyMode","$settingsTabNavLinks","location","hash","replace","hashTab","dispatchEvent","Event","$numericSettingsInputs","$settingsThemeSelect","$settingsThemePreview","settingsCustomFeatureColor","$settingsFeatureColorPicker","$settingsFeatureColorSelect","$settingsFeatureColorCustom","$settingsFeatureColorInput","$urlReplacementTool","$urlReplacementSubmit","$urlReplacementProgress","$urlReplacementProgressBar","$urlReplacementStatus","urlReplacements","old","new","forms","replacements","processUrlReplacement","$sizeReplacementTool","ajax","ajaxurl","method","action","beforeSend","jqXHR","settings","success","response","total","error","Math","ceil","formId","oldUrl","newUrl","form_id","$sizeReplacementSubmit","$sizeReplacementProgress","$sizeReplacementProgressBar","$sizeReplacementStatus","sizeReplacements","processSizeReplacement","newSize","gformAdminReadyCheck","gformAdminReady","ready","setInterval","clearInterval"],"sources":["gf_image_choices_admin.js"],"sourcesContent":["/*! © JetSloth — SPDX-License-Identifier: GPL-2.0-or-later */\n\nvar imageChoicesAdmin = imageChoicesAdmin || {};\n\n(function($){\n\n\tvar GF_MARKUP_VERSION = 2;\n\n\timageChoicesAdmin.extend = (...arguments) => {\n\n\t\t// Variables\n\t\tlet extended = {};\n\t\tlet deep = false;\n\t\tlet i = 0;\n\n\t\t// Check if a deep merge\n\t\tif (typeof (arguments[0]) === 'boolean') {\n\t\t\tdeep = arguments[0];\n\t\t\ti++;\n\t\t}\n\n\t\t// Merge the object into the extended object\n\t\tlet merge = function (obj) {\n\t\t\tfor (let prop in obj) {\n\t\t\t\tif (obj.hasOwnProperty(prop)) {\n\t\t\t\t\tif (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\t\t\t\t\t\t// If we're doing a deep merge and the property is an object\n\t\t\t\t\t\textended[prop] = imageChoicesAdmin.extend(true, extended[prop], obj[prop]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Otherwise, do a regular merge\n\t\t\t\t\t\textended[prop] = obj[prop];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t// Loop through each object and conduct a merge\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tmerge(arguments[i]);\n\t\t}\n\n\t\treturn extended;\n\n\t};\n\n\timageChoicesAdmin.__dialogDefaults = {\n\t\tdialogType: 'alert',\n\t\tcancelText: 'Cancel',\n\t\tconfirmText: 'Ok',\n\t\tallowCancel: true,\n\t\tpromptLabel: '',\n\t\tpromptPlaceholder: '',\n\t\tpromptValue: '',\n\t\ttitle: '',\n\t\tcontent: '',\n\t\timage: false,\n\t\tonConfirm: null,\n\t\tonCancel: null,\n\t};\n\n\timageChoicesAdmin.closeDialog = (dialogId) => {\n\t\tlet dialog = document.getElementById(dialogId);\n\t\tif ( dialog ) {\n\t\t\tdialog.classList.remove('ic-active');\n\t\t\tsetTimeout(() => {\n\t\t\t\tdialog.remove();\n\t\t\t}, 300);\n\t\t}\n\t\tlet dialogBg = document.querySelector(`.ic-dialog-bg[data-for=\"${dialogId}\"]`);\n\t\tif ( dialogBg ) {\n\t\t\tdialogBg.classList.remove('ic-active');\n\t\t\tsetTimeout(() => {\n\t\t\t\tdialogBg.remove();\n\t\t\t}, 300);\n\t\t}\n\t};\n\n\timageChoicesAdmin.dialog = (options) => {\n\t\tlet _options = imageChoicesAdmin.__dialogDefaults;\n\t\tlet allOptions = (typeof options === \"object\") ? imageChoicesAdmin.extend(true, _options, options) : _options;\n\t\tif ( allOptions.dialogType !== 'alert' && allOptions.dialogType !== 'confirm' && allOptions.dialogType !== 'prompt' ) {\n\t\t\tallOptions.dialogType = imageChoicesAdmin.__dialogDefaults.dialogType;\n\t\t}\n\t\tif ( allOptions.dialogType === 'alert' ) {\n\t\t\tallOptions.allowCancel = false;\n\t\t}\n\n\t\tlet dialogCount = document.querySelectorAll('.ic-dialog').length;\n\t\tlet dialogId = `ic_dialog_${dialogCount}`;\n\n\t\tlet baseZindex = 999900;\n\n\t\tlet dialogBg = document.createElement('div');\n\t\tdialogBg.classList.add('ic-dialog-bg');\n\t\tdialogBg.dataset.for = dialogId;\n\t\tdialogBg.style.zIndex = `${baseZindex + dialogCount}`;\n\n\t\tlet cancelButton = ( allOptions.allowCancel ) ? `<button type=\"button\" class=\"ic-btn ic-btn-secondary ic-dialog-cancel\">${allOptions.cancelText}</button>` : ``;\n\n\t\tlet promptLabel = ( allOptions.promptLabel ) ? `<label for=\"${dialogId}_input\" class=\"ic-prompt-input-label\">${allOptions.promptLabel}</label>` : ``;\n\t\tlet promptInput = ( allOptions.dialogType === 'prompt' ) ? `<div class=\"ic-prompt-input-wrap\">${promptLabel}<input type=\"text\" id=\"${dialogId}_input\" class=ic-prompt-input\" value=\"${allOptions.promptValue}\" placeholder=\"${allOptions.promptPlaceholder}\"></div>` : ``;\n\n\t\tlet dialog = document.createElement('div');\n\t\tdialog.id = dialogId;\n\t\tdialog.classList.add('ic-dialog', `ic-dialog-${allOptions.dialogType}`);\n\t\tdialog.innerHTML = `<div class=\"ic-dialog-header\">${allOptions.title}</div><div class=\"ic-dialog-body\">${allOptions.content}${promptInput}</div><div class=\"ic-dialog-footer\">${cancelButton}<button type=\"button\" class=\"ic-btn ic-dialog-confirm\">${allOptions.confirmText}</button></div>`;\n\t\tdialog.style.zIndex = `${baseZindex + dialogCount + 1}`;\n\n\t\tdocument.body.append(dialogBg);\n\t\tdocument.body.append(dialog);\n\t\tsetTimeout(() => {\n\t\t\tdialogBg.classList.add('ic-active');\n\t\t\tdialog.classList.add('ic-active');\n\t\t}, 10);\n\n\t\tdialog.querySelector('.ic-dialog-confirm').addEventListener('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\tlet thisId =  e.currentTarget.closest('.ic-dialog').id;\n\t\t\tif ( typeof allOptions.onConfirm === 'function' ) {\n\t\t\t\tlet val = ( allOptions.dialogType === 'prompt' ) ? document.getElementById(`${thisId}_input`).value : undefined;\n\t\t\t\tallOptions.onConfirm(val);\n\t\t\t}\n\t\t\timageChoicesAdmin.closeDialog( thisId );\n\t\t});\n\n\t\tif ( allOptions.allowCancel ) {\n\t\t\tdialog.querySelector('.ic-dialog-cancel').addEventListener('click', (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tif ( typeof allOptions.onCancel === 'function' ) {\n\t\t\t\t\tallOptions.onCancel();\n\t\t\t\t}\n\t\t\t\timageChoicesAdmin.closeDialog( e.currentTarget.closest('.ic-dialog').id );\n\t\t\t});\n\t\t}\n\t};\n\n\timageChoicesAdmin.prompt = (options) => {\n\t\tlet _options = imageChoicesAdmin.__dialogDefaults;\n\t\tif (typeof options !== \"object\") {\n\t\t\toptions = {};\n\t\t}\n\t\toptions.dialogType = 'prompt';\n\t\tlet allOptions = (typeof options === \"object\") ? imageChoicesAdmin.extend(true, _options, options) : _options;\n\t\timageChoicesAdmin.dialog(allOptions);\n\t};\n\n\timageChoicesAdmin.confirm = (options) => {\n\t\tlet _options = imageChoicesAdmin.__dialogDefaults;\n\t\tif (typeof options !== \"object\") {\n\t\t\toptions = {};\n\t\t}\n\t\toptions.dialogType = 'confirm';\n\t\tlet allOptions = (typeof options === \"object\") ? imageChoicesAdmin.extend(true, _options, options) : _options;\n\t\timageChoicesAdmin.dialog(allOptions);\n\t};\n\n\timageChoicesAdmin.alert = (options) => {\n\t\tlet _options = imageChoicesAdmin.__dialogDefaults;\n\t\tif (typeof options !== \"object\") {\n\t\t\toptions = {};\n\t\t}\n\t\toptions.dialogType = 'alert';\n\t\tlet allOptions = (typeof options === \"object\") ? imageChoicesAdmin.extend(true, _options, options) : _options;\n\t\timageChoicesAdmin.dialog(allOptions);\n\t};\n\n\n\timageChoicesAdmin.markupDetect = function() {\n\t\tif ( typeof window.form !== 'undefined' && window.form.hasOwnProperty('markupVersion') ) {\n\t\t\tGF_MARKUP_VERSION = ( window.form.markupVersion !== '' ) ? parseInt( window.form.markupVersion.toString(), 10 ) : 1;\n\t\t}\n\t\treturn GF_MARKUP_VERSION;\n\t};\n\n\timageChoicesAdmin.isLegacyMode = function() {\n\t\tvar useNewFeatures = ( imageChoicesVars.hasOwnProperty('useNewFeatures') && imageChoicesVars.useNewFeatures.toString() === 'true');\n\t\treturn !useNewFeatures;\n\t};\n\n\timageChoicesAdmin.formHasImageChoicesFields = function() {\n\t\tvar hasImageChoicesFields = false;\n\t\t$.each(window.form.fields, function(i, field){\n\t\t\tif ( field.hasOwnProperty('imageChoices_enableImages') && field.imageChoices_enableImages ) {\n\t\t\t\thasImageChoicesFields = true;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\treturn hasImageChoicesFields;\n\t};\n\n\timageChoicesAdmin.markup = {\n\t\tremoveChoicesButton: function(){\n\t\t\treturn '<button class=\"button image-choices-remove-choices-btn\" type=\"button\" onclick=\"imageChoicesAdmin.removeAllChoices();\">'+imageChoicesFieldStrings.removeAllChoices+'</button>';\n\t\t},\n\t\tchoicesAdminRow: function(index, image, id){\n\t\t\tvar i = (index !== undefined) ? index : 0;\n\t\t\tvar img = (image !== undefined) ? image : '';\n\t\t\tvar id = (id !== undefined) ? id : '';\n\t\t\tvar buttonLabel = '<i class=\"ic-select-icon\"></i>';// GF 2.5+\n\t\t\treturn [\n\t\t\t\t'<button type=\"button\" id=\"image-choices-option-upload-button-'+i+'\" class=\"button image-choices-option-upload-button\" onclick=\"imageChoicesAdmin.OpenMediaLibrary(this);\" title=\"'+imageChoicesFieldStrings.uploadImage+'\">'+buttonLabel+'</button>',\n\t\t\t\t'<span id=\"image-choices-option-preview-'+i+'\" class=\"image-choices-option-preview-wrap\">',\n\t\t\t\t\t'<span class=\"image-choices-option-preview\" style=\"background-image:url('+img+');\"></span>',\n\t\t\t\t\t'<a href=\"javascript:void(0);\" class=\"image-choices-option-image-remove\" onclick=\"imageChoicesAdmin.RemovePreview(this);\" title=\"'+imageChoicesFieldStrings.removeImage+'\"><i class=\"dashicons dashicons-no\"></i></a>',\n\t\t\t\t'</span>',\n\t\t\t\t'<input type=\"hidden\" id=\"image-choices-option-image-'+i+'\" class=\"image-choices-option-image\" value=\"'+img+'\" />',\n\t\t\t\t'<input type=\"hidden\" id=\"image-choices-option-image-id-'+i+'\" class=\"image-choices-option-image-id\" value=\"'+id+'\" />'\n\t\t\t].join('');\n\t\t},\n\t\tchoicesPreviewRow: function(index, labelText, image) {\n\t\t\tvar i = (index !== undefined) ? index : 0;\n\t\t\tvar label = (labelText !== undefined) ? labelText : '';\n\t\t\tvar img = (image !== undefined) ? image : '';\n\t\t\treturn [\n\t\t\t\t'<span class=\"image-choices-choice-image-wrap\" style=\"background-image:url('+img+')\">',\n\t\t\t\t\t'<img src=\"'+img+'\" alt=\"\" class=\"image-choices-choice-image\" />',\n\t\t\t\t'</span>',\n\t\t\t\t'<span class=\"image-choices-choice-text\">'+label+'</span>'\n\t\t\t].join('');\n\t\t}\n\t};\n\n\timageChoicesAdmin.getChoices = function( field ) {\n\t\tif ( typeof field === 'undefined' ) {\n\t\t\tfield = GetSelectedField();\n\t\t}\n\n\t\tvar choicesSelector = '[class*=\"-choice-row\"]';\n\n\t\timageChoicesAdmin.getSettingsElement().find(choicesSelector).each(function(){\n\t\t\tvar $row = $(this);\n\t\t\tvar i = $row.data('index');\n\t\t\tvar img = (field.choices.length && field.choices[i].imageChoices_image !== undefined) ? field.choices[i].imageChoices_image : '';\n\t\t\tvar imgID = (field.choices.length && field.choices[i].imageChoices_imageID !== undefined) ? field.choices[i].imageChoices_imageID : '';\n\n\t\t\tif ( !$row.find('.image-choices-option-image').length ) {\n\t\t\t\tvar $firstInput = $row.find('input[id*=\"_choice_text\"]:first');\n\t\t\t\tif ( !$firstInput.length ) {\n\t\t\t\t\t$firstInput = $row.find('input[id*=\"-choice-text\"]:first');\n\t\t\t\t}\n\t\t\t\tif ( $firstInput.length ) {\n\t\t\t\t\t$firstInput.before(imageChoicesAdmin.markup.choicesAdminRow(i, img, imgID));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar $imageInput = $row.find('.image-choices-option-image');\n\t\t\tif ($imageInput.val() !== '') {\n\t\t\t\t$row.addClass('image-choices-has-image');\n\t\t\t}\n\t\t});\n\n\t\timageChoicesAdmin.updateFieldPreview(field);\n\t};\n\n\timageChoicesAdmin.RemovePreview = function( btnEl ) {\n\t\tif (typeof btnEl === 'undefined') {\n\t\t\treturn;\n\t\t}\n\n\t\tvar $choice = $(btnEl).closest('[class*=\"-choice-row\"]');\n\t\t$choice.find('.image-choices-option-image').val('');\n\t\t$choice.find('.image-choices-option-image-id').val('');\n\t\t$choice.find('.image-choices-option-preview').css('background-image', '');\n\t\t$choice.removeClass('image-choices-has-image');\n\n\t\timageChoicesAdmin.UpdateFieldChoicesObject();\n\n\t\tvar field = GetSelectedField();\n\t\timageChoicesAdmin.updateFieldPreview(field);\n\t};\n\n\timageChoicesAdmin.UpdateFieldChoicesObject = function() {\n\t\tvar field = GetSelectedField();\n\n\t\tvar $fieldSettings = imageChoicesAdmin.getSettingsElement();\n\n\t\tvar selector = '[class*=\"-choice-row\"]';\n\n\t\t$fieldSettings.find(selector).each(function(index) {\n\t\t\tvar $choice = $(this);\n\t\t\tvar image = $choice.find('.image-choices-option-image').val();\n\t\t\tvar imageID = $choice.find('.image-choices-option-image-id').val();\n\t\t\tvar i = $choice.data(\"index\");\n\t\t\tif (image !== '') {\n\t\t\t\t$choice.addClass('image-choices-has-image');\n\t\t\t\t$choice.find('.gf-image-choices-option-preview').css('background-image', 'url('+image+')');\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$choice.removeClass('image-choices-has-image');\n\t\t\t}\n\t\t\tfield.choices[i].imageChoices_image = image;\n\t\t\tfield.choices[i].imageChoices_imageID = imageID;\n\t\t});\n\t};\n\n\timageChoicesAdmin.onProductPriceChange = function() {\n\t\tsetTimeout(function(){\n\t\t\timageChoicesAdmin.updateFieldPreview( GetSelectedField() );\n\t\t}, 10);\n\t};\n\n\tvar ttUpdateDelay;\n\n\timageChoicesAdmin.updateFieldPreview = function( field ) {\n\n\t\tvar $field = $('#field_'+field.id);\n\t\tvar productImageField = ( field.type === 'product' && field.inputType === 'singleproduct' );\n\n\t\tvar $fieldLabel = $field.find('.gfield_label.gform-field-label');\n\t\tvar $productImageWrap = $field.find('.ic-product-image-wrap');\n\n\t\tvar prop = productImageField ? 'productImage_enabled' : 'imageChoices_enableImages';\n\t\tvar imagesEnabled = (field.hasOwnProperty(prop) && field[prop] === true);\n\t\tvar hasProductImage = imageChoicesAdmin.hasProductImage( field );\n\n\n\t\tif ( !imagesEnabled || !productImageField ) {\n\t\t\tif ( $productImageWrap.length ) {\n\t\t\t\t$fieldLabel.detach();\n\t\t\t\t$field.prepend($fieldLabel);\n\t\t\t\t$productImageWrap.remove();\n\t\t\t}\n\t\t}\n\n\t\tif ( productImageField ) {\n\n\t\t\tif ( !$productImageWrap.length && hasProductImage ) {\n\t\t\t\t$fieldLabel.detach();\n\t\t\t\t$productImageWrap = $(`<div class=\"ic-product-image-wrap\"></div>`);\n\t\t\t\t$productImageWrap.append(`<div class=\"ic-product-image\" style=\"background-image:url(${field.productImage_image});\"><img src=\"${field.productImage_image}\" alt=\"\" class=\"ic-product-image-element\" /></div>`);\n\t\t\t\t$productImageWrap.append($fieldLabel);\n\t\t\t\t$productImageWrap.append(`<div class=\"ic-product-image-price\">${field.basePrice}</div>`);\n\t\t\t\t$field.prepend($productImageWrap);\n\t\t\t}\n\t\t\telse if ( !hasProductImage && $productImageWrap.length ) {\n\t\t\t\t$fieldLabel.detach();\n\t\t\t\t$field.prepend($fieldLabel);\n\t\t\t\t$productImageWrap.remove();\n\t\t\t}\n\n\t\t\tif ( hasProductImage ) {\n\t\t\t\t$field.find('.ic-product-image-price').html(field.basePrice);\n\t\t\t}\n\n\t\t}\n\t\telse {\n\n\t\t\tif ( imagesEnabled && field.imageChoices_showLabels === undefined ) {\n\t\t\t\timageChoicesAdmin.toggleShowLabels(true);\n\t\t\t}\n\n\t\t\timageChoicesAdmin.$fieldChoices( $field ).each(function(i){\n\t\t\t\tvar $choice = $(this);\n\n\t\t\t\tif ( !$choice.hasClass('gchoice_total') ) {\n\n\t\t\t\t\t$choice.toggleClass('image-choices-choice', imagesEnabled);\n\n\t\t\t\t\tvar $choiceLabel = $choice.find('label');\n\t\t\t\t\tvar labelText = ($choiceLabel.find('.image-choices-choice-text').length) ? $choiceLabel.find('.image-choices-choice-text').html() : $choiceLabel.html();\n\n\t\t\t\t\tif ( imagesEnabled && field.choices.length > i) {\n\t\t\t\t\t\tvar img = (field.choices[i].imageChoices_image !== undefined) ? field.choices[i].imageChoices_image : '';\n\t\t\t\t\t\t$choiceLabel.html(imageChoicesAdmin.markup.choicesPreviewRow(i, labelText, img));\n\t\t\t\t\t}\n\t\t\t\t\telse if ( !imagesEnabled ) {\n\t\t\t\t\t\t$choiceLabel.html(labelText);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif ( typeof gfttAdmin !== 'undefined' ) {\n\t\t\t\tclearTimeout(ttUpdateDelay);\n\t\t\t\tttUpdateDelay = setTimeout(function(){\n\t\t\t\t\tgfttAdmin.updateChoicesPreview();\n\t\t\t\t}, 100);\n\t\t\t}\n\n\t\t}\n\n\n\t};\n\n\timageChoicesAdmin.getField = function() {\n\t\tvar field = GetSelectedField();\n\t\treturn $('#field_'+field.id);\n\t};\n\n\timageChoicesAdmin.removeAllChoices = function() {\n\t\timageChoicesAdmin.getSettingsElement().find('.image-choices-option-image-remove').each(function(){\n\t\t\t$(this).trigger('click');\n\t\t});\n\n\t\t$settingsWrap.find('.gf_delete_field_choice').each(function(){\n\t\t\t$(this).trigger('click');\n\t\t});\n\n\t\t$settingsWrap.find('.field-choice-row input[type=\"text\"], .gquiz-choice-row input[type=\"text\"]').val('');\n\t};\n\n\timageChoicesAdmin.isColorPickerPluginActive = function() {\n\t\treturn (window.hasOwnProperty('colorPickerFieldVars') && typeof window.colorPickerFieldVars !== 'undefined');\n\t};\n\n\timageChoicesAdmin.isImageChoicesEnabled = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( imageChoicesAdmin.fieldCanHaveImages(field) && field.imageChoices_enableImages === true );\n\t};\n\n\timageChoicesAdmin.hasImageChoicesImage = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( imageChoicesAdmin.isImageChoicesEnabled(field) && field.hasOwnProperty('imageChoices_image') && field.imageChoices_image !== '' );\n\t};\n\n\timageChoicesAdmin.isProductImageField = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( field.type === \"product\" && field.inputType === \"singleproduct\" );\n\t};\n\n\timageChoicesAdmin.isProductImageEnabled = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( imageChoicesAdmin.isProductImageField(field) && field.productImage_enabled === true );\n\t};\n\n\timageChoicesAdmin.hasProductImage = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( imageChoicesAdmin.isProductImageField(field) && field.hasOwnProperty('productImage_image') && field.productImage_image !== '' );\n\t};\n\n\timageChoicesAdmin.hasProductImageId = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( imageChoicesAdmin.isProductImageField(field) && field.hasOwnProperty('productImage_imageId') && field.productImage_imageId );\n\t};\n\n\timageChoicesAdmin.onProductImageToggleClick = function(toggle) {\n\t\timageChoicesAdmin.toggleEnableImages(toggle.checked, true);\n\t\tif ( toggle.checked ) {\n\t\t\tif ( !imageChoicesAdmin.hasProductImage() ) {\n\t\t\t\t$('#product_image_tab_toggle').click();\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t$('#product-image-button').click();\n\t\t\t\t}, 500);\n\t\t\t}\n\t\t}\n\t}\n\n\timageChoicesAdmin.toggleEnableImages = function( enable, forProductImage ) {\n\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar toggleSelector = isForProductImage ? 'input.field_product_image_enabled' : 'input.field_choice_images_enabled';\n\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\tvar $toggle = $settings.find(toggleSelector);\n\n\t\tif ( enable === undefined ) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\tif ( isForProductImage ) {\n\t\t\timageChoicesAdmin.onToggleEnableImages(enable, isForProductImage);\n\t\t\treturn;\n\t\t}\n\n\t\tvar $coloPickerToggle = $settings.find('input.field_color_picker_enabled');\n\n\t\t// if user is enabling image choices, and color picker is currently in use on this field, confirm the switch\n\t\tif (enable && imageChoicesAdmin.isColorPickerPluginActive() && $coloPickerToggle.length && $coloPickerToggle.is(':checked')) {\n\t\t\tif (window.confirm(imageChoicesFieldStrings.confirmImagesToggle)) {\n\t\t\t\tif (window.hasOwnProperty('colorPicker_toggleEnableColors') && typeof window.colorPicker_toggleEnableColors === 'function') {\n\t\t\t\t\twindow.colorPicker_toggleEnableColors(false);\n\t\t\t\t}\n\t\t\t\timageChoicesAdmin.onToggleEnableImages(enable, isForProductImage);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$toggle.prop('checked', false);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\timageChoicesAdmin.onToggleEnableImages(enable, isForProductImage);\n\t\t}\n\t};\n\twindow.imageChoices_toggleEnableImages = imageChoicesAdmin.toggleEnableImages;// legacy support\n\n\timageChoicesAdmin.onToggleEnableImages = function( enable, forProductImage ) {\n\n\t\tvar field = GetSelectedField();\n\t\tif ( !field ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar toggleSelector = isForProductImage ? 'input.field_product_image_enabled' : 'input.field_choice_images_enabled';\n\n\t\tvar $field = imageChoicesAdmin.getField();\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\tvar $toggle = $settings.find(toggleSelector);\n\n\t\tif (enable === undefined) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\t$field.toggleClass('image-choices-admin-field', enable);\n\t\t//$fieldSettings.toggleClass('image-choices-product-field', field.type === \"product\");\n\n\t\tif ( isForProductImage ) {\n\n\t\t\tSetFieldProperty('productImage_enabled', enable);\n\t\t\t$toggle.prop('checked', enable);\n\t\t\t$('#product_image_tab_toggle').toggle( enable );\n\n\t\t\tvar $imageWrap = $field.find('.ic-product-image-wrap');\n\n\t\t\tif ( !enable && $imageWrap.length ) {\n\t\t\t\tvar $label = $field.find('.gfield_label.gform-field-label');\n\t\t\t\t$label.detach();\n\t\t\t\t$field.prepend($label);\n\t\t\t\t$imageWrap.remove();\n\t\t\t}\n\n\t\t\t$field.toggleClass('product-image-admin-field', enable);\n\t\t\t$field.toggleClass('product-image-enabled', enable);\n\t\t\t$settings.toggleClass('product-image-enabled', enable);\n\n\t\t}\n\t\telse {\n\n\t\t\tSetFieldProperty('imageChoices_enableImages', enable);\n\t\t\t$toggle.prop('checked', enable);\n\t\t\t$('#image_choices_tab_toggle').toggle( enable );\n\n\t\t\tvar choicesContainerSelector = ( field.type.toLowerCase() === \"quiz\" ) ? '#gquiz_gfield_settings_choices_container' : '#gfield_settings_choices_container';\n\t\t\tvar $choicesContainer = $(choicesContainerSelector);\n\t\t\t$choicesContainer.toggleClass('image-choices-enabled', enable);\n\n\t\t\t$field.toggleClass('image-choices-use-images', enable);\n\t\t\t$settings.toggleClass('image-choices-use-images', enable);\n\n\t\t\tvar $removeChoicesBtn = $settings.find('.image-choices-remove-choices-btn');\n\n\t\t\tif (!enable) {\n\t\t\t\tif ($removeChoicesBtn.length) {\n\t\t\t\t\t$removeChoicesBtn.remove();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar $enableOtherChoicesSetting = $('.field_setting.other_choice_setting');\n\t\t\tvar isFieldWithOtherChoiceOption = (field.type === 'radio' || (field.type === 'poll' && field.inputType === 'radio'));\n\n\t\t\tif (isFieldWithOtherChoiceOption) {\n\t\t\t\t$enableOtherChoicesSetting.show();\n\t\t\t}\n\n\t\t}\n\n\t\timageChoicesAdmin.updateFieldPreview(field);\n\t};\n\n\timageChoicesAdmin.toggleShowLabels = function( enable ) {\n\t\tvar $field = imageChoicesAdmin.getField();\n\t\tvar $toggle = imageChoicesAdmin.getSettingsElement().find('input.image_choices_show_labels');\n\n\t\tif (enable === undefined) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\tSetFieldProperty('imageChoices_showLabels', enable);\n\n\t\t$toggle.prop('checked', enable);\n\n\t\t$field.toggleClass('image-choices-show-labels', enable);\n\t};\n\n\timageChoicesAdmin.toggleShowPrices = function( enable ) {\n\t\tvar $field = imageChoicesAdmin.getField();\n\t\tvar $toggle = imageChoicesAdmin.getSettingsElement().find('input.image_choices_show_prices');\n\n\t\tif (enable === undefined) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\tSetFieldProperty('imageChoices_showPrices', enable);\n\n\t\t$toggle.prop('checked', enable);\n\n\t\t$field.toggleClass('image-choices-show-prices', enable);\n\t};\n\n\timageChoicesAdmin.toggleUseLightboxCaption = function( enable, forProductImage ) {\n\n\t\tvar $field = imageChoicesAdmin.getField();\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar toggleSelector = isForProductImage ? 'input.product_image_use_lightbox_caption' : 'input.image_choices_use_lightbox_caption';\n\t\tvar $toggle = imageChoicesAdmin.getSettingsElement().find(toggleSelector);\n\n\t\tif (enable === undefined) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\t$toggle.prop('checked', enable);\n\n\t\tif ( isForProductImage ) {\n\t\t\tSetFieldProperty('productImage_useLightboxCaption', enable);\n\t\t}\n\t\telse {\n\t\t\tSetFieldProperty('imageChoices_useLightboxCaption', enable);\n\t\t}\n\n\t};\n\n\timageChoicesAdmin.toggleUseLightbox = function( enable, forProductImage ) {\n\n\t\tvar field = GetSelectedField();\n\t\tvar $field = imageChoicesAdmin.getField();\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar toggleSelector = isForProductImage ? 'input.product_image_use_lightbox' : 'input.image_choices_use_lightbox';\n\t\tvar $toggle = imageChoicesAdmin.getSettingsElement().find(toggleSelector);\n\t\tvar lightboxCaptionSelector = isForProductImage ? '.product-image-setting-use-lightbox-caption' : '.image-choices-setting-use-lightbox-caption';\n\n\t\tif (enable === undefined) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\t$toggle.prop('checked', enable);\n\n\t\tif ( isForProductImage ) {\n\n\t\t\tSetFieldProperty('productImage_useLightbox', enable);\n\t\t\t$field.toggleClass('product-image-use-lightbox', enable);\n\n\t\t\tif ( imageChoicesAdmin.hasProductImage(field) && !imageChoicesAdmin.hasProductImageId(field) ) {\n\t\t\t\twindow.alert(imageChoicesFieldStrings.useLightboxWarning);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t}\n\t\telse {\n\n\t\t\tSetFieldProperty('imageChoices_useLightbox', enable);\n\t\t\t$field.toggleClass('image-choices-use-lightbox', enable);\n\n\t\t\tif (enable) {\n\t\t\t\t$.each(field.choices, function(i, fieldChoice){\n\t\t\t\t\tvar hasImage = ( fieldChoice.hasOwnProperty('imageChoices_image') && fieldChoice.imageChoices_image !== '' );\n\t\t\t\t\tvar hasImageID = ( fieldChoice.hasOwnProperty('imageChoices_imageID') && fieldChoice.imageChoices_imageID !== '' );\n\n\t\t\t\t\tif ( hasImage && !hasImageID ) {\n\t\t\t\t\t\twindow.alert(imageChoicesFieldStrings.useLightboxWarning);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t}\n\n\t\tdocument.querySelector(lightboxCaptionSelector).style.setProperty('display', enable ? 'block' : 'none', 'important');\n\n\t};\n\n\timageChoicesAdmin.updateEntrySetting = function( value, forProductImage ) {\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\n\t\tSetFieldProperty(`${propPrefix}_entrySetting`, value);\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-entry-value`).val( value );\n\t};\n\n\timageChoicesAdmin.OpenMediaLibrary = function( btnEl ) {\n\t\tif (typeof btnEl === 'undefined') {\n\t\t\treturn;\n\t\t}\n\n\t\tvar field = GetSelectedField();\n\t\tvar isForProductImage = imageChoicesAdmin.isProductImageField(field);\n\n\t\tvar image_fileFrame;\n\n\t\tif ( isForProductImage ) {\n\t\t\tvar $field = imageChoicesAdmin.getField();\n\t\t\timage_fileFrame = $field.data('file-frame');\n\t\t}\n\t\telse {\n\t\t\tvar $choice = $(btnEl).closest('[class*=\"-choice-row\"]');\n\t\t\timage_fileFrame = $choice.data('file-frame');\n\t\t}\n\n\t\t// If the media frame already exists, reopen it.\n\t\tif ( image_fileFrame ) {\n\t\t\t// Open frame\n\t\t\timage_fileFrame.open();\n\t\t\treturn;\n\t\t}\n\n\t\t// Create the media frame.\n\t\timage_fileFrame = wp.media({\n\t\t\ttitle: 'Select an image to upload',\n\t\t\tbutton: {\n\t\t\t\ttext: 'Use this image'\n\t\t\t},\n\t\t\tframe: 'post',\n\t\t\tstate: 'insert',\n\t\t\tmultiple: false\t// Set to true to allow multiple files to be selected\n\t\t});\n\n\t\tsetTimeout(function(){\n\t\t\t$('input[value=\"Insert into Post\"]').val('Use this Image');\n\t\t\t$('button.media-button-insert').text('Use this Image');\n\t\t}, 100);\n\n\t\tjQuery('body').on('click', 'li.attachment', function(){\n\t\t\t$('input[value=\"Insert into Post\"]').val('Use this Image');\n\t\t\t$('button.media-button-insert').text('Use this Image');\n\t\t});\n\n\t\t// When an image is selected, run a callback.\n\t\timage_fileFrame.on( 'insert', function(selection) {\n\t\t\tvar state = image_fileFrame.state();\n\t\t\tselection = selection || state.get('selection');\n\t\t\tif (! selection) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar attachment = selection.first();\n\t\t\tvar selectedSize = \"\";\n\n\t\t\tvar display = state.display(attachment).toJSON();\n\t\t\tattachment = attachment.toJSON();\n\n\t\t\t// start with the selected size, but fallback to one of the defaults if there's no image\n\t\t\t// this can happen eg when there are existing images in the media library when a new size is created, and thumbnails haven't been generated for existing\n\t\t\t// the size will appear as an option in the media library when selecting the image, but then fails as there's no image in that size\n\t\t\tvar sizes = [\"medium\", \"thumbnail\", \"full\"];\n\t\t\tif ( display && display.hasOwnProperty('size') && display.size ) {\n\t\t\t\tsizes.unshift( display.size );\n\t\t\t}\n\n\t\t\tvar img;\n\t\t\tif ( !attachment.hasOwnProperty('sizes') ) {\n\t\t\t\timg = attachment.url;\n\t\t\t\tselectedSize = \"full\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar i = 0;\n\t\t\t\tvar imageSize = sizes[i].toString();\n\t\t\t\twhile ( !attachment.sizes.hasOwnProperty(imageSize) || !attachment.sizes[imageSize].hasOwnProperty('url') || attachment.sizes[imageSize].url === \"\" ) {\n\t\t\t\t\ti++;\n\t\t\t\t\timageSize = sizes[i].toString();\n\t\t\t\t}\n\t\t\t\timg = attachment.sizes[imageSize].url;\n\t\t\t\tselectedSize = imageSize;\n\t\t\t\t// TODO: size override? But can use the IC image size update tool\n\t\t\t\t/*\n\t\t\t\tif ( imageChoicesVars.hasOwnProperty('defaults') && imageChoicesVars.defaults.hasOwnProperty('imageSize') && sizes.indexOf(imageChoicesVars.defaults.imageSize) !== -1 ) {\n\t\t\t\t\timg = attachment.sizes[imageChoicesVars.defaults.imageSize].url;\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t}\n\n\t\t\tif ( isForProductImage ) {\n\t\t\t\timageChoicesAdmin.updateProductImage(img, attachment.id);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$choice.find('.image-choices-option-image').val(img);\n\t\t\t\t$choice.find('.image-choices-option-image-id').val(attachment.id);\n\t\t\t\t$choice.find('.image-choices-option-preview').css('background-image', 'url('+img+')');\n\t\t\t\t$choice.addClass('image-choices-has-image');\n\n\t\t\t\timageChoicesAdmin.UpdateFieldChoicesObject();\n\t\t\t\timageChoicesAdmin.updateFieldPreview(field);\n\n\t\t\t\t// GF 2.6+\n\t\t\t\tvar $choicesFlyout = $('#choices-ui-flyout');\n\t\t\t\tif ( $choicesFlyout.length ) {\n\t\t\t\t\t$choicesFlyout.addClass('gform-flyout--anim-in-ready gform-flyout--anim-in-active');\n\t\t\t\t}\n\t\t\t}\n\n\t\t});\n\n\t\t// Finally, open the modal\n\t\timage_fileFrame.open();\n\n\t\tif ( isForProductImage ) {\n\t\t\t$field.data('file-frame', image_fileFrame);\n\t\t}\n\t\telse {\n\t\t\t$choice.data('file-frame', image_fileFrame);\n\t\t}\n\t};\n\n\timageChoicesAdmin.fieldCanHaveImages = function( field ) {\n\n\t\tif ( typeof field === 'undefined' || !field.hasOwnProperty('type') ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar canHave = (\n\t\t\tfield.type === 'radio'\n\t\t\t|| field.type === 'checkbox'\n\t\t\t|| ( field.type === 'quiz' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'quiz' && field.inputType == 'checkbox' )\n\t\t\t|| ( field.type === 'poll' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'poll' && field.inputType == 'checkbox' )\n\t\t\t|| ( field.type === 'post_custom_field' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'post_custom_field' && field.inputType == 'checkbox' )\n\t\t\t|| ( field.type === 'survey' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'survey' && field.inputType == 'checkbox' )\n\t\t\t|| ( field.type === 'product' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'shipping' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'option' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'option' && field.inputType == 'checkbox' )\n\t\t\t|| ( field.type === 'multi_choice' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'multi_choice' && field.inputType == 'checkbox' )\n\t\t);\n\n\t\treturn gform.applyFilters('gfic_field_can_have_images', canHave, field);\n\n\t};\n\n\timageChoicesAdmin.$fieldChoices = function( $field ) {\n\t\tif ( typeof $field === 'undefined' || $field instanceof jQuery === false) {\n\t\t\treturn [];\n\t\t}\n\t\tvar choicesSelector = '.ginput_container .gfield_radio div[class*=\"gchoice\"], .ginput_container .gfield_checkbox .gchoice:not(.gchoice_select_all)';// GF 2.5+\n\n\t\treturn $field.find(choicesSelector);\n\t};\n\n\timageChoicesAdmin.getSettingsElement = function() {\n\t\tvar fieldSettingsSelector = '#field_settings_container';// GF 2.5+\n\n\t\tvar field = GetSelectedField();\n\t\tfieldSettingsSelector += ( field.type === \"quiz\" ) ? ', #gquiz_gfield_settings_choices_container' : ', #gfield_settings_choices_container'\n\n\t\treturn $(fieldSettingsSelector);\n\t};\n\n\timageChoicesAdmin.previewHeight = function( $el ) {\n\n\t\tif ( typeof $el !== 'object' ) {\n\t\t\tvar $field = imageChoicesAdmin.getField();\n\t\t\t$el = $field.find('.ginput_container');\n\t\t}\n\n\t\tif ( !$el.length || !$el.closest('.gfield').hasClass('image-choices-admin-field') ) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetTimeout(function(){\n\t\t\t$el.height( $el.find('> ul:first').outerHeight() );\n\t\t}, 20);\n\n\t};\n\n\timageChoicesAdmin.updateProductImage = function( url, id ) {\n\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\tvar $field = imageChoicesAdmin.getField();\n\n\t\tif ( typeof url === 'undefined' ) {\n\t\t\turl = '';\n\t\t}\n\t\tif ( typeof id === 'undefined' ) {\n\t\t\tid = '';\n\t\t}\n\n\t\tSetFieldProperty('productImage_image', url);\n\t\tSetFieldProperty('productImage_imageId', id);\n\n\t\t$settings.find('.product-image-url').val(url);\n\t\t$settings.find('.product-image-id').val(id);\n\t\t$settings.find('#product-image-preview').css('background-image', 'url('+url+')');\n\n\t\t$settings.toggleClass('has-product-image', url !== '');// todo: class on settings?\n\t\t$field.toggleClass('has-product-image', url !== '');// todo: or class on field?\n\t\timageChoicesAdmin.updateFieldPreview( GetSelectedField() );\n\n\t};\n\n\timageChoicesAdmin.updateThemeSetting = function( value, forProductImage ) {\n\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\n\t\tSetFieldProperty( `${propPrefix}_theme`, value );\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-theme`).val( value );\n\n\t\tvar $previewWrap = $(`#${selectorPrefix}-theme-preview`);\n\t\tvar $previewImg;\n\t\t$previewWrap.toggle(value !== 'none');\n\t\tif (value === 'none') {\n\t\t\t$previewWrap.hide().find('img').hide();\n\t\t}\n\t\telse if (value === 'form_setting') {\n\t\t\tvalue = (window.form.hasOwnProperty('gf-image-choices') && window.form['gf-image-choices'].hasOwnProperty('gf_image_choices_theme')) ? window.form['gf-image-choices'].gf_image_choices_theme : '';\n\t\t\tif ( !value || value === \"global_setting\" ) {\n\t\t\t\tvalue = ( imageChoicesVars.hasOwnProperty('globals') && imageChoicesVars.globals.hasOwnProperty('theme') ) ? imageChoicesVars.globals.theme : ( imageChoicesVars.hasOwnProperty('defaults') && imageChoicesVars.defaults.hasOwnProperty('theme') ) ? imageChoicesVars.defaults.theme : 'simple';\n\t\t\t}\n\t\t\t$previewWrap.find('img').hide();\n\t\t\t$previewImg = $previewWrap.find(`img.${selectorPrefix}-theme-preview-${value}`);\n\t\t\tif ( $previewImg.length ) {\n\t\t\t\t$previewImg.show();\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t$previewWrap.find('img').hide();\n\t\t\t$previewImg = $previewWrap.find(`img.${selectorPrefix}-theme-preview-${value}`);\n\t\t\tif ( $previewImg.length ) {\n\t\t\t\t$previewImg.show();\n\t\t\t}\n\t\t}\n\n\t};\n\n\timageChoicesAdmin.updateFeatureColorSetting = function( value ) {\n\n\t\tSetFieldProperty( `imageChoices_featureColor`, value );\n\n\t\tvar $customColorLabel = imageChoicesAdmin.getSettingsElement().find(`[for=\"image-choices-feature-color-custom\"]`);\n\t\tvar $customColorInput = imageChoicesAdmin.getSettingsElement().find(`#image-choices-feature-color-custom`);\n\t\tvar $customColorPicker = imageChoicesAdmin.getSettingsElement().find(`.image-choices-setting-feature-color .wp-picker-container`);\n\t\tvar customColor = $customColorInput.val();\n\n\t\timageChoicesAdmin.getSettingsElement().find(`#image-choices-feature-color`).val( value );\n\n\t\tif ( value === \"custom\" ) {\n\t\t\t$customColorLabel.show();\n\t\t\t$customColorInput.show();\n\t\t\tif ( $customColorPicker.length ) {\n\t\t\t\t$customColorPicker.show();\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\tif ( customColor !== \"\" ) {\n\t\t\t\t\t\t$customColorInput.wpColorPicker('color', customColor);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$customColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t\t}\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$customColorInput.wpColorPicker({\n\t\t\t\t\tchange: function( e, ui ) {\n\t\t\t\t\t\timageChoicesAdmin.updateCustomFeatureColor( ui.color.toString() );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\tif ( customColor !== \"\" ) {\n\t\t\t\t\t\t$customColorInput.wpColorPicker('color', customColor);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$customColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t\t}\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t$customColorLabel.hide();\n\t\t\t$customColorInput.hide();\n\t\t\tif ( $customColorPicker.length ) {\n\t\t\t\t$customColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t$customColorPicker.hide();\n\t\t\t}\n\t\t}\n\n\t};\n\n\timageChoicesAdmin.updateCustomFeatureColor = function( value, forProductImage ) {\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-feature-color-custom`).val( value );\n\t\tSetFieldProperty( `${propPrefix}_featureColorCustom`, value );\n\t};\n\n\timageChoicesAdmin.updateAlignSetting = function( value ) {\n\t\tSetFieldProperty( 'imageChoices_align', value );\n\t\timageChoicesAdmin.getSettingsElement().find('#image-choices-align').val( value );\n\t};\n\n\timageChoicesAdmin.updateImageStyleSetting = function( value, forProductImage ) {\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\t\tSetFieldProperty( `${propPrefix}_imageStyle`, value );\n\n\t\tvar $select = imageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-image-style`);\n\t\tif ( !$select.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\t$select.val( value );\n\t\tif ( value === 'form_setting' ) {\n\t\t\tvar optionText = $select.find('option[value=\"form_setting\"]').html();\n\t\t\tvalue = optionText.substring( optionText.indexOf('(') + 1, optionText.indexOf(')') ).toLowerCase();\n\t\t\tif ( value.indexOf('global:') !== -1 ) {\n\t\t\t\tvalue = value.substring( value.indexOf('global:') + 8 );\n\t\t\t}\n\t\t}\n\n\t\timageChoicesAdmin.getSettingsElement().find('.image-choices-setting-height, .image-choices-setting-height-medium, .image-choices-setting-height-small').toggleClass('hide-setting', value === 'square' || value === 'natural' );\n\t};\n\n\timageChoicesAdmin.validateNumericValue = function( val ) {\n\t\tvar numVal = '';\n\t\tval = val.toString();\n\t\tif ( val.trim() !== '' ) {\n\t\t\tvar num = parseInt(val, 10);\n\t\t\tif ( isNaN(num) || num <= 0 ) {\n\t\t\t\tnumVal = '';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnumVal = num.toString();\n\t\t\t}\n\t\t}\n\t\treturn ( numVal !== val ) ? numVal : val;\n\t};\n\n\timageChoicesAdmin.updateColumnsSetting = function( value ) {\n\t\tSetFieldProperty( 'imageChoices_columns', value );\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\t$settings.find('#image-choices-columns').val( value );\n\t\t$settings.find('.image-choices-setting-columns-width').toggle( value === 'fixed' );\n\t};\n\n\timageChoicesAdmin.updateColumnsWidthSetting = function( value ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tSetFieldProperty( 'imageChoices_columnsWidth', numVal );\n\t\timageChoicesAdmin.getSettingsElement().find('#image-choices-columns-width').val( numVal );\n\t};\n\n\timageChoicesAdmin.updateColumnsMediumSetting = function( value ) {\n\t\tSetFieldProperty( 'imageChoices_columnsMedium', value );\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\t$settings.find('#image-choices-columns-medium').val( value );\n\t\t$settings.find('.image-choices-setting-columns-width-medium').toggle( value === 'fixed' );\n\t};\n\n\timageChoicesAdmin.updateColumnsMediumWidthSetting = function( value ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tSetFieldProperty( 'imageChoices_columnsWidthMedium', numVal );\n\t\timageChoicesAdmin.getSettingsElement().find('#image-choices-columns-width-medium').val( numVal );\n\t};\n\n\timageChoicesAdmin.updateColumnsSmallSetting = function( value ) {\n\t\tSetFieldProperty( 'imageChoices_columnsSmall', value );\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\t$settings.find('#image-choices-columns-small').val( value );\n\t\t$settings.find('.image-choices-setting-columns-width-small').toggle( value === 'fixed' );\n\t};\n\n\timageChoicesAdmin.updateColumnsSmallWidthSetting = function( value ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tSetFieldProperty( 'imageChoices_columnsWidthSmall', numVal );\n\t\timageChoicesAdmin.getSettingsElement().find('#image-choices-columns-width-small').val( numVal );\n\t};\n\n\timageChoicesAdmin.updateHeightSetting = function( value, forProductImage ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\n\t\tSetFieldProperty( `${propPrefix}_height`, numVal );\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-height`).val( numVal );\n\t};\n\n\timageChoicesAdmin.updateMediumHeightSetting = function( value, forProductImage ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\n\t\tSetFieldProperty( `${propPrefix}_heightMedium`, numVal );\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-height-medium`).val( numVal );\n\t};\n\n\timageChoicesAdmin.updateSmallHeightSetting = function( value, forProductImage ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\n\t\tSetFieldProperty( `${propPrefix}_heightSmall`, numVal );\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-height-small`).val( numVal );\n\t};\n\n\timageChoicesAdmin.initProductImageField = function(field) {\n\t\tvar $field = $('#field_'+field.id);\n\t\t$field.addClass('product-image-admin-field');\n\t\t$field.addClass('product-image-enabled');\n\t\tif ( imageChoicesAdmin.hasProductImage(field) ) {\n\t\t\t$field.addClass('has-product-image');\n\t\t}\n\t\timageChoicesAdmin.updateFieldPreview(field);\n\t};\n\n\timageChoicesAdmin.initImageChoicesField = function(field) {\n\t\tvar $field = $('#field_'+field.id);\n\t\t$field.addClass('image-choices-admin-field');\n\t\t$field.addClass('image-choices-enabled');\n\t\tif ( imageChoicesAdmin.hasImageChoicesImage(field) ) {\n\t\t\t$field.addClass('image-choices-has-image');\n\t\t}\n\t\timageChoicesAdmin.updateFieldPreview(field);\n\t};\n\n\timageChoicesAdmin.formEditorInit = function() {\n\n\t\tgform.addAction( 'gform_after_refresh_field_preview', function(fieldId){\n\t\t\tvar field = GetSelectedField();\n\t\t\tif ( imageChoicesAdmin.isImageChoicesEnabled(field) ) {\n\t\t\t\timageChoicesAdmin.updateFieldPreview(field);\n\t\t\t}\n\t\t});\n\n\t\t// setup previews on load\n\t\tform.fields.forEach(function(f){\n\t\t\tif ( imageChoicesAdmin.isProductImageEnabled(f) ) {\n\t\t\t\timageChoicesAdmin.initProductImageField(f);\n\t\t\t}\n\t\t\telse if ( imageChoicesAdmin.isImageChoicesEnabled(f) ) {\n\t\t\t\timageChoicesAdmin.initImageChoicesField(f);\n\t\t\t}\n\t\t});\n\n\t\t$('.gfield.image-choices-admin-field').each(function(){\n\t\t\timageChoicesAdmin.$fieldChoices( $(this) ).each(function(){\n\t\t\t\tlet $choice = $(this);\n\t\t\t\tif ( !$choice.hasClass('gchoice_total') ) {\n\t\t\t\t\t$choice.addClass('image-choices-choice');\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t$('#gform_fields .gfield .ginput_container').each(function(){\n\t\t\timageChoicesAdmin.previewHeight( $(this) );\n\t\t});\n\n\n\t\t$(window).on('gf_update_field_choices', function() {\n\t\t\tsetTimeout(function() {\n\t\t\t\timageChoicesAdmin.getChoices();\n\t\t\t}, 10);\n\n\t\t\timageChoicesAdmin.previewHeight();\n\t\t});\n\n\t\t$(document).on('click', '.gf_insert_field_choice, .gf_delete_field_choice', function(e){\n\t\t\timageChoicesAdmin.previewHeight();\n\t\t});\n\n\t\tgform.addAction('gform_load_field_choices', function( fields ){\n\n\t\t\tsetTimeout(function(){\n\n\t\t\t\tvar field = ( typeof fields !== 'undefined' && fields.length ) ? fields[0] : GetSelectedField();\n\t\t\t\tvar $field = $('#field_'+field.id);\n\t\t\t\tvar $fieldSettings = imageChoicesAdmin.getSettingsElement();\n\n\t\t\t\tif ( imageChoicesAdmin.isProductImageField(field) ) {\n\n\t\t\t\t\t$('#field_base_price').on('change', imageChoicesAdmin.onProductPriceChange);\n\n\t\t\t\t\tvar productImageEnabled = imageChoicesAdmin.isProductImageEnabled(field);\n\n\t\t\t\t\tvar productImageUrl = (field.productImage_image !== undefined) ? field.productImage_image : '';\n\t\t\t\t\tvar productImageId = (field.productImage_imageId !== undefined) ? field.productImage_imageId : '';\n\t\t\t\t\tvar useProductImageLightbox = (field.productImage_useLightbox !== undefined) ? field.productImage_useLightbox : false;\n\t\t\t\t\tvar selectedProductImageTheme = (field.productImage_theme !== undefined) ? field.productImage_theme : 'form_setting';\n\t\t\t\t\tvar productImageStyle = (field.productImage_imageStyle !== undefined) ? field.productImage_imageStyle : 'form_setting';\n\t\t\t\t\tvar productImageUseLightboxCaption = (field.productImage_useLightboxCaption !== undefined) ? field.productImage_useLightboxCaption : true;\n\t\t\t\t\tif ( productImageUseLightboxCaption === \"form_setting\" || productImageUseLightboxCaption === \"\" ) {\n\t\t\t\t\t\tproductImageUseLightboxCaption = true;\n\t\t\t\t\t}\n\t\t\t\t\tvar productImageHeightSetting = (field.productImage_height !== undefined) ? field.productImage_height : '';\n\t\t\t\t\tvar productImageMediumHeightSetting = (field.productImage_heightMedium !== undefined) ? field.productImage_heightMedium : '';\n\t\t\t\t\tvar productImageSmallHeightSetting = (field.productImage_heightSmall !== undefined) ? field.productImage_heightSmall : '';\n\n\t\t\t\t\tvar productImageEntryValue = (field.productImage_entrySetting !== undefined) ? field.productImage_entrySetting : 'form_setting';\n\n\t\t\t\t\t$fieldSettings.addClass('product-image-field-settings');\n\n\t\t\t\t\timageChoicesAdmin.toggleEnableImages(productImageEnabled, true);\n\n\t\t\t\t\timageChoicesAdmin.updateProductImage(productImageUrl, productImageId);\n\n\t\t\t\t\timageChoicesAdmin.toggleUseLightbox(useProductImageLightbox, true);\n\t\t\t\t\timageChoicesAdmin.toggleUseLightboxCaption(productImageUseLightboxCaption, true);\n\n\t\t\t\t\timageChoicesAdmin.updateThemeSetting(selectedProductImageTheme, true);\n\t\t\t\t\timageChoicesAdmin.updateImageStyleSetting(productImageStyle, true);\n\n\t\t\t\t\timageChoicesAdmin.updateHeightSetting(productImageHeightSetting, true);\n\t\t\t\t\timageChoicesAdmin.updateMediumHeightSetting(productImageMediumHeightSetting, true);\n\t\t\t\t\timageChoicesAdmin.updateSmallHeightSetting(productImageSmallHeightSetting, true);\n\n\t\t\t\t\timageChoicesAdmin.updateEntrySetting(productImageEntryValue, true);\n\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\timageChoicesAdmin.toggleEnableImages(false, true);\n\t\t\t\t\timageChoicesAdmin.updateProductImage('');\n\t\t\t\t\timageChoicesAdmin.toggleUseLightboxCaption(true, true);\n\t\t\t\t\timageChoicesAdmin.updateThemeSetting('form_setting', true);\n\t\t\t\t\timageChoicesAdmin.updateImageStyleSetting('form_setting', true);\n\n\t\t\t\t\timageChoicesAdmin.updateHeightSetting('', true);\n\t\t\t\t\timageChoicesAdmin.updateMediumHeightSetting('', true);\n\t\t\t\t\timageChoicesAdmin.updateSmallHeightSetting('', true);\n\n\t\t\t\t\timageChoicesAdmin.updateEntrySetting('', true);\n\n\t\t\t\t\t$field.removeClass('product-image-admin-field');\n\t\t\t\t\t$fieldSettings.removeClass('product-image-field-settings');\n\t\t\t\t}\n\n\t\t\t\tif ( imageChoicesAdmin.fieldCanHaveImages(field) ) {\n\n\t\t\t\t\tvar imagesEnabled = (field.imageChoices_enableImages === true);\n\t\t\t\t\tvar useLightbox = (field.imageChoices_useLightbox !== undefined) ? field.imageChoices_useLightbox : false;\n\t\t\t\t\tvar displayLabels = (field.imageChoices_showLabels !== undefined) ? field.imageChoices_showLabels : true;\n\t\t\t\t\tvar showPrices = (field.type === 'product' && field.imageChoices_showPrices !== undefined) ? field.imageChoices_showPrices : false;\n\t\t\t\t\tvar entryValue = (field.imageChoices_entrySetting !== undefined) ? field.imageChoices_entrySetting : 'form_setting';\n\t\t\t\t\tvar selectedTheme = (field.imageChoices_theme !== undefined) ? field.imageChoices_theme : 'form_setting';\n\t\t\t\t\tvar featureColor = (field.imageChoices_featureColor !== undefined) ? field.imageChoices_featureColor : 'form_setting';\n\t\t\t\t\tvar featureColorCustom = (field.imageChoices_featureColorCustom !== undefined) ? field.imageChoices_featureColorCustom : '';\n\t\t\t\t\tvar alignSetting = (field.imageChoices_align !== undefined) ? field.imageChoices_align : 'form_setting';\n\t\t\t\t\tvar imageStyle = (field.imageChoices_imageStyle !== undefined) ? field.imageChoices_imageStyle : 'form_setting';\n\t\t\t\t\tvar columnsSetting = (field.imageChoices_columns !== undefined) ? field.imageChoices_columns : 'form_setting';\n\t\t\t\t\tvar columnsWidthSetting = (field.imageChoices_columnsWidth !== undefined) ? field.imageChoices_columnsWidth : '';\n\t\t\t\t\tvar columnsMediumSetting = (field.imageChoices_columnsMedium !== undefined) ? field.imageChoices_columnsMedium : 'form_setting';\n\t\t\t\t\tvar columnsMediumWidthSetting = (field.imageChoices_columnsWidthMedium !== undefined) ? field.imageChoices_columnsWidthMedium : '';\n\t\t\t\t\tvar columnsSmallSetting = (field.imageChoices_columnsSmall !== undefined) ? field.imageChoices_columnsSmall : 'form_setting';\n\t\t\t\t\tvar columnsSmallWidthSetting = (field.imageChoices_columnsWidthSmall !== undefined) ? field.imageChoices_columnsWidthSmall : '';\n\t\t\t\t\tvar useLightboxCaption = (field.imageChoices_useLightboxCaption !== undefined) ? field.imageChoices_useLightboxCaption : true;\n\t\t\t\t\tif ( useLightboxCaption === \"form_setting\" || useLightboxCaption === \"\" ) {\n\t\t\t\t\t\tuseLightboxCaption = true;\n\t\t\t\t\t}\n\t\t\t\t\tvar heightSetting = (field.imageChoices_height !== undefined) ? field.imageChoices_height : '';\n\t\t\t\t\tvar mediumHeightSetting = (field.imageChoices_heightMedium !== undefined) ? field.imageChoices_heightMedium : '';\n\t\t\t\t\tvar smallHeightSetting = (field.imageChoices_heightSmall !== undefined) ? field.imageChoices_heightSmall : '';\n\n\t\t\t\t\t$fieldSettings.addClass('image-choices-field-settings');\n\n\t\t\t\t\tif ( field.type === 'product' ) {\n\t\t\t\t\t\t$fieldSettings.addClass('image-choices-product-field');\n\t\t\t\t\t}\n\n\t\t\t\t\timageChoicesAdmin.toggleEnableImages(imagesEnabled);\n\t\t\t\t\timageChoicesAdmin.toggleUseLightbox(useLightbox);\n\t\t\t\t\timageChoicesAdmin.toggleShowLabels(displayLabels);\n\t\t\t\t\timageChoicesAdmin.toggleShowPrices(showPrices);\n\t\t\t\t\timageChoicesAdmin.updateEntrySetting(entryValue);\n\t\t\t\t\timageChoicesAdmin.toggleUseLightboxCaption(useLightboxCaption);\n\n\t\t\t\t\tif ( !imageChoicesAdmin.isLegacyMode() ) {\n\t\t\t\t\t\timageChoicesAdmin.updateThemeSetting(selectedTheme);\n\t\t\t\t\t\timageChoicesAdmin.updateCustomFeatureColor(featureColorCustom);\n\t\t\t\t\t\timageChoicesAdmin.updateFeatureColorSetting(featureColor);\n\t\t\t\t\t\timageChoicesAdmin.updateAlignSetting(alignSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateImageStyleSetting(imageStyle);\n\n\t\t\t\t\t\timageChoicesAdmin.updateHeightSetting(heightSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateMediumHeightSetting(mediumHeightSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateSmallHeightSetting(smallHeightSetting);\n\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsWidthSetting(columnsWidthSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsMediumWidthSetting(columnsMediumWidthSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSmallWidthSetting(columnsSmallWidthSetting);\n\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSetting(columnsSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsMediumSetting(columnsMediumSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSmallSetting(columnsSmallSetting);\n\t\t\t\t\t}\n\n\t\t\t\t\timageChoicesAdmin.getChoices( field );\n\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\timageChoicesAdmin.toggleEnableImages(false);\n\t\t\t\t\timageChoicesAdmin.toggleUseLightboxCaption(true);\n\t\t\t\t\t//imageChoicesAdmin.toggleShowLabels(false);\n\n\t\t\t\t\tif ( !imageChoicesAdmin.isLegacyMode() ) {\n\t\t\t\t\t\timageChoicesAdmin.updateThemeSetting('form_setting');\n\t\t\t\t\t\timageChoicesAdmin.updateCustomFeatureColor('');\n\t\t\t\t\t\timageChoicesAdmin.updateFeatureColorSetting('form_setting');\n\t\t\t\t\t\timageChoicesAdmin.updateAlignSetting('form_setting');\n\t\t\t\t\t\timageChoicesAdmin.updateImageStyleSetting('form_setting');\n\n\t\t\t\t\t\timageChoicesAdmin.updateHeightSetting('');\n\t\t\t\t\t\timageChoicesAdmin.updateMediumHeightSetting('');\n\t\t\t\t\t\timageChoicesAdmin.updateSmallHeightSetting('');\n\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsWidthSetting('');\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsMediumWidthSetting('');\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSmallWidthSetting('');\n\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSetting('form_setting');\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsMediumSetting('form_setting');\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSmallSetting('form_setting');\n\t\t\t\t\t}\n\n\t\t\t\t\t$field.removeClass('image-choices-show-labels');\n\t\t\t\t\t$fieldSettings.removeClass('image-choices-field-settings');\n\t\t\t\t\t$fieldSettings.remove('image-choices-product-field');\n\t\t\t\t}\n\n\t\t\t}, 100);\n\n\t\t});\n\n\t\t$(document).bind('gform_load_field_settings', function (event, field, form) {\n\n\t\t\t// There's currently no action or event fired by GF when the 'show values' or 'show prices' option is toggled, but the preview updates\n\t\t\t// So we override the global UpdateFieldChoices that is called at this point (GF form_editor.js) in order to fire our own gf_update_field_choices event so we can update preview\n\t\t\tif (typeof window.imageChoices_GF_UpdateFieldChoices !== 'function' && typeof UpdateFieldChoices === 'function') {\n\t\t\t\twindow.imageChoices_GF_UpdateFieldChoices = UpdateFieldChoices;\n\t\t\t\twindow.UpdateFieldChoices = function() {\n\t\t\t\t\twindow.imageChoices_GF_UpdateFieldChoices.apply(this, arguments);\n\t\t\t\t\t$(window).trigger('gf_update_field_choices');\n\t\t\t\t};\n\t\t\t}\n\n\t\t\timageChoicesAdmin.previewHeight();\n\t\t});\n\n\t};\n\n\timageChoicesAdmin.formEditorLegacyWarning = function() {\n\n\t\treturn;\n\n\t\tvar alertMessage = [\n\t\t\t'<div class=\"gform-alert\" data-js=\"gform-alert\" role=\"status\" data-gform-alert-instance=\"gfic-legacy-alert-' + window.form.id.toString() + '\">',\n\t\t\t\t'<span class=\"gform-alert__icon gform-icon gform-icon--warning\" aria-hidden=\"true\"></span>',\n\t\t\t\t'<div class=\"gform-alert__message-wrap\">',\n\t\t\t\t\t'<p class=\"gform-alert__message\">JetSloth will stop supporting legacy markup at the end of 2023. We encourage you to test out your form with legacy markup turned off, to ensure continued compatibility with Image Choices.</p>',\n\t\t\t\t\t'<a class=\"gform-alert__cta gform-button gform-button--white gform-button--size-xs\" href=\"' + window.imageChoicesVars.form_settings + window.form.id.toString() + '#gform_setting_markupVersion\" aria-label=\"\">Form settings</a>',\n\t\t\t\t'</div>',\n\t\t\t'</div>',\n\t\t].join('');\n\n\t\tvar $gfLegacyAlert = $('.simplebar-content > .gform-alert[data-gform-alert-instance^=\"gform-alert-\"]:first');\n\t\tif ( $gfLegacyAlert.length ) {\n\t\t\t$gfLegacyAlert.after(alertMessage);\n\t\t}\n\t\telse {\n\t\t\t$('.simplebar-content').prepend(alertMessage);\n\t\t}\n\t\tgform.tools.trigger( 'gform_init_alerts' );\n\n\t};\n\n\timageChoicesAdmin.adminInit = () => {\n\n\t\t// Custom CSS editors\n\t\tvar $customCssBoxes = $('#gf_image_choices_custom_css_global, #gf_image_choices_custom_css, #gf_image_choices_user_css_global, #gf_image_choices_user_css_form');\n\t\tif ( $customCssBoxes.length ) {\n\t\t\tvar editorSettings = wp.codeEditor.defaultSettings ? _.clone( wp.codeEditor.defaultSettings ) : {};\n\t\t\teditorSettings.codemirror = _.extend(\n\t\t\t\t{},\n\t\t\t\teditorSettings.codemirror,\n\t\t\t\t{\n\t\t\t\t\tindentUnit: 4,\n\t\t\t\t\ttabSize: 4,\n\t\t\t\t\tmode: 'css',\n\t\t\t\t\tlineNumbers: true,\n\t\t\t\t\tautoCloseBrackets: true,\n\t\t\t\t\tcontinueComments: true,\n\t\t\t\t\tindentWithTabs: true,\n\t\t\t\t\tinputStyle: \"contenteditable\",\n\t\t\t\t\tlineWrapping: true,\n\t\t\t\t\tlint: false,\n\t\t\t\t\tmatchBrackets: true,\n\t\t\t\t\tstyleActiveLine: true,\n\t\t\t\t\tgutters: [],\n\t\t\t\t\textraKeys: {\n\t\t\t\t\t\t\"Alt-F\": \"findPersistent\",\n\t\t\t\t\t\t\"Cmd-F\": \"findPersistent\",\n\t\t\t\t\t\t\"Ctrl-F\": \"findPersistent\",\n\t\t\t\t\t\t\"Cmd-/\": \"toggleComment\",\n\t\t\t\t\t\t\"Ctrl-/\": \"toggleComment\",\n\t\t\t\t\t\t\"Ctrl-Space\": \"autocomplete\",\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t\t$customCssBoxes.each(function(){\n\t\t\t\twindow[this.id + '_editor'] = wp.codeEditor.initialize( $(this), editorSettings );\n\t\t\t});\n\t\t}\n\n\t\tvar $legacyCssSectionToggle = $('#gform_settings_section_collapsed_gf_image_choices_legacy_custom_css_section, #gform_settings_section_collapsed_gf_image_choices_legacy_custom_form_css_section');\n\t\tif ( $legacyCssSectionToggle.length ) {\n\t\t\t$legacyCssSectionToggle.on('click', function(){\n\t\t\t\t$(this).closest('.gform-settings-panel').find('textarea').each(function(){\n\t\t\t\t\tvar ref = $(this).attr('id') + '_editor';\n\t\t\t\t\ttry {\n\t\t\t\t\t\twindow[ref].codemirror.refresh();\n\t\t\t\t\t}\n\t\t\t\t\tcatch(e) {\n\t\t\t\t\t\t// do nothing\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tvar $globalStyleSelect = $('#gf_image_choices_global_image_style');\n\t\tif ( $globalStyleSelect.length ) {\n\t\t\t$globalStyleSelect.on('change', function(e){\n\t\t\t\tvar style = e.currentTarget.value;\n\t\t\t\t$('#gform_setting_gf_image_choices_global_height, #gform_setting_gf_image_choices_global_height_medium, #gform_setting_gf_image_choices_global_height_small').toggle( style !== 'natural' && style !== 'square' );\n\t\t\t});\n\t\t\t$globalStyleSelect.trigger('change');\n\t\t}\n\n\t\tvar $formStyleSelect = $('#gf_image_choices_image_style');\n\t\tif ( $formStyleSelect.length ) {\n\t\t\t$formStyleSelect.on('change', function(e){\n\t\t\t\tvar style = e.currentTarget.value;\n\t\t\t\tif ( style === 'global_setting' ) {\n\t\t\t\t\tvar optionText = $(e.currentTarget).find(`option[value=\"${style}\"]`).html();\n\t\t\t\t\tstyle = optionText.substring( optionText.indexOf('(') + 1, optionText.indexOf(')') ).toLowerCase();\n\t\t\t\t}\n\t\t\t\t$('#gform_setting_gf_image_choices_height, #gform_setting_gf_image_choices_height_medium, #gform_setting_gf_image_choices_height_small').toggle( style !== 'natural' && style !== 'square' );\n\t\t\t});\n\t\t\t$formStyleSelect.trigger('change');\n\t\t}\n\n\t\t// show/hide new settings based on toggle\n\t\tvar $legacyModeToggle = $('#_gform_setting_gf_image_choices_use_legacy_styles');\n\t\tvar $newFeaturesElements = $('#gform-settings-section-theme, #gform-settings-section-feature-color, #gform-settings-section-choices-layout, #gform-settings-section-image-options, #gform-settings-section-custom-css, #gform-settings-section-gf_image_choices_legacy_custom_css_section .gform-settings-label');\n\n\t\tif ( $legacyModeToggle.length ) {\n\t\t\t$legacyModeToggle.on('change', function(e){\n\t\t\t\tvar useLegacyMode = $legacyModeToggle.is(':checked');\n\t\t\t\tif ( $newFeaturesElements.length ) {\n\t\t\t\t\t$newFeaturesElements.toggle( !useLegacyMode );\n\t\t\t\t}\n\t\t\t\tif ( $legacyCssSectionToggle.length ) {\n\t\t\t\t\tif ( ( useLegacyMode && $legacyCssSectionToggle.is(\":checked\") ) || ( !useLegacyMode && !$legacyCssSectionToggle.is(\":checked\") ) ) {\n\t\t\t\t\t\t$legacyCssSectionToggle.click();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t$legacyModeToggle.trigger('change');\n\t\t}\n\n\n\n\t\t// settings page tab switch (hide submit if not settings tab)\n\t\tvar $settingsTabNavLinks = $('#tab_gf-image-choices .gform-settings-tabs__navigation a');\n\t\tif ( $settingsTabNavLinks.length ) {\n\t\t\t$settingsTabNavLinks.each(function(){\n\t\t\t\t$(this).on('click', function(e){\n\t\t\t\t\twindow.location.hash = e.currentTarget.id.replace('gform-settings-tab-gf_image_choices_', '');\n\t\t\t\t\t$('#tab_gf-image-choices #gform-settings-save').toggle( $(this).data('tab') === \"gf_image_choices_settings_tab\" );\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst hash = window.location.hash.substring(1);\n\t\t\t\tconst hashTab = ( hash !== \"\" ) ? document.querySelector(`#tab_gf-image-choices #gform-settings-tab-gf_image_choices_${hash}`) : null;\n\t\t\t\tconst tabLink = hashTab ? hashTab : $settingsTabNavLinks[0];\n\t\t\t\ttabLink.dispatchEvent( new Event('click') );\n\t\t\t}, 100);\n\t\t}\n\n\n\t\t// numeric settings live validation to number (plugin and form settings)\n\t\tvar $numericSettingsInputs = $('input[id^=\"gf_image_choices\"][id*=\"columns_width\"], input[id^=\"image-choices\"][id*=\"columns-width\"], input[id^=\"gf_image_choices\"][id*=\"height\"], input[id^=\"image-choices\"][id*=\"height\"], input[id^=\"product-image\"][id*=\"height\"]');\n\t\tif ( $numericSettingsInputs.length ) {\n\t\t\t$numericSettingsInputs.each(function(){\n\t\t\t\tvar $input = $(this);\n\t\t\t\t$input.on('keyup', function(e){\n\t\t\t\t\tvar val = e.currentTarget.value.toString();\n\t\t\t\t\tvar numVal = imageChoicesAdmin.validateNumericValue( val );\n\t\t\t\t\tif ( numVal !== val ) {\n\t\t\t\t\t\te.currentTarget.value = numVal;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\n\t\t// form settings theme preview\n\t\tvar $settingsThemeSelect = $('#gf_image_choices_theme, #gf_image_choices_global_theme').first();\n\t\tvar $settingsThemePreview = $('#gform_setting_gf_image_choices_theme_preview .image-choices-theme-preview, #gform_setting_gf_image_choices_global_theme_preview .image-choices-theme-preview').first();\n\t\tif ( $settingsThemeSelect.length && $settingsThemePreview.length ) {\n\t\t\t$settingsThemeSelect.on('change', function(e){\n\t\t\t\tvar value = $(this).val();\n\t\t\t\tif ( value === \"\" || value == \"global_setting\" ) {\n\t\t\t\t\tvalue = ( imageChoicesVars.hasOwnProperty('globals') && imageChoicesVars.globals.hasOwnProperty('theme') ) ? imageChoicesVars.globals.theme : ( imageChoicesVars.hasOwnProperty('defaults') && imageChoicesVars.defaults.hasOwnProperty('theme') ) ? imageChoicesVars.defaults.theme : 'simple';\n\t\t\t\t}\n\n\t\t\t\t$settingsThemePreview.toggle(value !== 'none');\n\t\t\t\tif (value === 'none') {\n\t\t\t\t\t$settingsThemePreview.hide().find('img').hide();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t$settingsThemePreview.find('img').hide();\n\t\t\t\t\t$settingsThemePreview.find('img.image-choices-theme-preview-'+value).show();\n\t\t\t\t}\n\t\t\t});\n\t\t\t$settingsThemeSelect.trigger('change');\n\t\t}\n\n\t\t// form settings feature color\n\t\tvar $settingsFeatureColorSelect = $('#gf_image_choices_feature_color, #gf_image_choices_global_feature_color').first();\n\t\tvar $settingsFeatureColorCustom = $('#gform_setting_gf_image_choices_feature_color_custom, #gform_setting_gf_image_choices_global_feature_color_custom').first();\n\t\tvar $settingsFeatureColorInput = $('#gf_image_choices_feature_color_custom, #gf_image_choices_global_feature_color_custom').first();\n\t\tvar settingsCustomFeatureColor;\n\t\tvar $settingsFeatureColorPicker;\n\n\t\tif ( $settingsFeatureColorSelect.length && $settingsFeatureColorCustom.length ) {\n\n\t\t\t$settingsFeatureColorPicker = $settingsFeatureColorCustom.find('.wp-picker-container');\n\t\t\tsettingsCustomFeatureColor = $settingsFeatureColorInput.val();\n\n\t\t\t$settingsFeatureColorSelect.on('change', function(e){\n\t\t\t\tvar value = $(this).val();\n\n\t\t\t\tif ( value === \"custom\" ) {\n\t\t\t\t\t$settingsFeatureColorCustom.show();\n\t\t\t\t\tif ( $settingsFeatureColorPicker.length ) {\n\t\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\t\tif ( customColor !== \"\" ) {\n\t\t\t\t\t\t\t\t$settingsFeatureColorInput.wpColorPicker('color', settingsCustomFeatureColor);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t$settingsFeatureColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 100);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$settingsFeatureColorInput.wpColorPicker();\n\t\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\t\tif ( settingsCustomFeatureColor !== \"\" ) {\n\t\t\t\t\t\t\t\t$settingsFeatureColorInput.wpColorPicker('color', settingsCustomFeatureColor);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t$settingsFeatureColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 100);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t$settingsFeatureColorCustom.hide();\n\t\t\t\t\tif ( $settingsFeatureColorPicker.length ) {\n\t\t\t\t\t\t$settingsFeatureColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t\t$settingsFeatureColorSelect.trigger('change');\n\t\t}\n\n\n\n\t\tvar $urlReplacementTool = $('#image_choices_url_replacement');\n\t\tvar $urlReplacementSubmit = ($urlReplacementTool.length) ? $('#image_choices_url_replacement_submit') : null;\n\t\tvar $urlReplacementProgress = ($urlReplacementTool.length) ? $urlReplacementTool.find('.jetbase-tool__progress') : null;\n\t\tvar $urlReplacementProgressBar = ($urlReplacementTool.length) ? $urlReplacementTool.find('.jetbase-tool__progress-percent') : null;\n\t\tvar $urlReplacementStatus = ($urlReplacementTool.length) ? $urlReplacementTool.find('.jetbase-tool__progress-status') : null;\n\n\t\tvar urlReplacements = {\n\t\t\told: \"\",\n\t\t\tnew: \"\",\n\t\t\tforms: [],\n\t\t\tindex: 0,\n\t\t\treplacements: []\n\t\t}\n\n\t\timageChoicesAdmin.processUrlReplacement = function() {\n\t\t\tif ( !urlReplacements.forms.length || urlReplacements.replacements.length === urlReplacements.forms.length || urlReplacements.index >= urlReplacements.forms.length ) {\n\t\t\t\t// done\n\t\t\t\t$urlReplacementProgressBar.css('width', `100%`);\n\t\t\t\t$urlReplacementStatus.html(`Done! ${urlReplacements.forms.length} form(s) processed`);\n\t\t\t\t$urlReplacementTool.removeClass('busy');\n\t\t\t\tif ( $sizeReplacementTool.length ) {\n\t\t\t\t\t$sizeReplacementTool.removeClass('disabled');\n\t\t\t\t}\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t$.ajax({\n\t\t\t\turl: window.ajaxurl,\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'gf_image_choices_url_replacement',\n\t\t\t\t\tid: urlReplacements.forms[urlReplacements.index],\n\t\t\t\t\told: urlReplacements.old,\n\t\t\t\t\tnew: urlReplacements.new\n\t\t\t\t},\n\t\t\t\tbeforeSend: function(jqXHR, settings){\n\t\t\t\t\t$urlReplacementStatus.html(`Processing form ${urlReplacements.index + 1}/${urlReplacements.forms.length}`);\n\t\t\t\t},\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif ( response && response.success ) {\n\t\t\t\t\t\turlReplacements.replacements[urlReplacements.index] = response.total;\n\t\t\t\t\t}\n\t\t\t\t\telse if ( response && response.error ) {\n\t\t\t\t\t\turlReplacements.replacements[urlReplacements.index] = false;\n\t\t\t\t\t\t$urlReplacementStatus.html('Error: ' + response.error );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\turlReplacements.replacements[urlReplacements.index] = false;\n\t\t\t\t\t\t$urlReplacementStatus.html('Error');\n\t\t\t\t\t}\n\t\t\t\t\turlReplacements.index++;\n\t\t\t\t\t$urlReplacementProgressBar.css('width', `${ Math.ceil( (urlReplacements.index / urlReplacements.forms.length) * 100 ) }%`);\n\t\t\t\t\timageChoicesAdmin.processUrlReplacement();\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\n\t\tif ( $urlReplacementSubmit && $urlReplacementSubmit.length ) {\n\n\t\t\t$urlReplacementSubmit.on('click', function(e){\n\t\t\t\te.preventDefault();\n\n\t\t\t\tvar formId = $urlReplacementTool.find('#image_choices_url_replacement_form_select').val().trim();\n\t\t\t\tvar oldUrl = $urlReplacementTool.find('#image_choices_url_replacement_from_input').val().trim();\n\t\t\t\tvar newUrl = $urlReplacementTool.find('#image_choices_url_replacement_to_input').val().trim();\n\t\t\t\tif ( !oldUrl || !newUrl || oldUrl === newUrl ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\turlReplacements.old = oldUrl;\n\t\t\t\turlReplacements.new = newUrl;\n\t\t\t\turlReplacements.forms = [];\n\t\t\t\turlReplacements.index = 0;\n\t\t\t\turlReplacements.replacements = [];\n\n\t\t\t\tif ( formId === \"all\" ) {\n\n\t\t\t\t\t$urlReplacementStatus.html('Scanning for forms with old URL in image choices...');\n\t\t\t\t\t$urlReplacementProgressBar.css('width', '0%');\n\t\t\t\t\t$urlReplacementTool.addClass('busy');\n\t\t\t\t\t$urlReplacementProgress.addClass('active');\n\t\t\t\t\tif ( $sizeReplacementTool.length ) {\n\t\t\t\t\t\t$sizeReplacementTool.addClass('disabled');\n\t\t\t\t\t}\n\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\turl: window.ajaxurl,\n\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'gf_image_choices_get_url_replacement_form_ids',\n\t\t\t\t\t\t\tform_id: urlReplacements.formId,\n\t\t\t\t\t\t\told: urlReplacements.old,\n\t\t\t\t\t\t\tnew: urlReplacements.new\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\t\tif ( response && response.success ) {\n\t\t\t\t\t\t\t\tif ( response.forms && response.forms.length ) {\n\t\t\t\t\t\t\t\t\turlReplacements.forms = response.forms\n\t\t\t\t\t\t\t\t\timageChoicesAdmin.processUrlReplacement();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t$urlReplacementProgressBar.css('width', `100%`);\n\t\t\t\t\t\t\t\t\t$urlReplacementStatus.html(`Done! No image choices found containing that old URL`);\n\t\t\t\t\t\t\t\t\t$urlReplacementTool.removeClass('busy');\n\t\t\t\t\t\t\t\t\tif ( $sizeReplacementTool.length ) {\n\t\t\t\t\t\t\t\t\t\t$sizeReplacementTool.removeClass('disabled');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if ( response && response.error ) {\n\t\t\t\t\t\t\t\t$urlReplacementStatus.html('Error: ' + response.error );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t$urlReplacementStatus.html('Error');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\t$urlReplacementStatus.html('...');\n\t\t\t\t\t$urlReplacementProgressBar.css('width', '0%');\n\t\t\t\t\t$urlReplacementTool.addClass('busy');\n\t\t\t\t\t$urlReplacementProgress.addClass('active');\n\t\t\t\t\tif ( $sizeReplacementTool.length ) {\n\t\t\t\t\t\t$sizeReplacementTool.addClass('disabled');\n\t\t\t\t\t}\n\n\t\t\t\t\turlReplacements.forms = [ formId ]\n\t\t\t\t\timageChoicesAdmin.processUrlReplacement();\n\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t}\n\n\n\t\tvar $sizeReplacementTool = $('#image_choices_image_replacement');\n\t\tvar $sizeReplacementSubmit = ($sizeReplacementTool.length) ? $('#image_choices_image_replacement_submit') : null;\n\t\tvar $sizeReplacementProgress = ($sizeReplacementTool.length) ? $sizeReplacementTool.find('.jetbase-tool__progress') : null;\n\t\tvar $sizeReplacementProgressBar = ($sizeReplacementTool.length) ? $sizeReplacementTool.find('.jetbase-tool__progress-percent') : null;\n\t\tvar $sizeReplacementStatus = ($sizeReplacementTool.length) ? $sizeReplacementTool.find('.jetbase-tool__progress-status') : null;\n\n\t\tvar sizeReplacements = {\n\t\t\tnew: \"\",\n\t\t\tforms: [],\n\t\t\tindex: 0,\n\t\t\treplacements: []\n\t\t}\n\n\t\timageChoicesAdmin.processSizeReplacement = function() {\n\t\t\tif ( !sizeReplacements.forms.length || sizeReplacements.replacements.length === sizeReplacements.forms.length || sizeReplacements.index >= sizeReplacements.forms.length ) {\n\t\t\t\t// done\n\t\t\t\t$sizeReplacementProgressBar.css('width', `100%`);\n\t\t\t\t$sizeReplacementStatus.html(`Done! ${sizeReplacements.forms.length} form(s) processed`);\n\t\t\t\t$sizeReplacementTool.removeClass('busy');\n\t\t\t\tif ( $urlReplacementTool.length ) {\n\t\t\t\t\t$urlReplacementTool.removeClass('disabled');\n\t\t\t\t}\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t$.ajax({\n\t\t\t\turl: window.ajaxurl,\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'gf_image_choices_image_size_replacement',\n\t\t\t\t\tid: sizeReplacements.forms[sizeReplacements.index],\n\t\t\t\t\tnew: sizeReplacements.new\n\t\t\t\t},\n\t\t\t\tbeforeSend: function(jqXHR, settings) {\n\t\t\t\t\t$sizeReplacementStatus.html(`Processing form ${sizeReplacements.index + 1}/${sizeReplacements.forms.length}`);\n\t\t\t\t},\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif ( response && response.success ) {\n\t\t\t\t\t\tsizeReplacements.replacements[sizeReplacements.index] = response.total;\n\t\t\t\t\t}\n\t\t\t\t\telse if ( response && response.error ) {\n\t\t\t\t\t\tsizeReplacements.replacements[sizeReplacements.index] = false;\n\t\t\t\t\t\t$sizeReplacementStatus.html('Error: ' + response.error );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tsizeReplacements.replacements[sizeReplacements.index] = false;\n\t\t\t\t\t\t$sizeReplacementStatus.html('Error');\n\t\t\t\t\t}\n\t\t\t\t\tsizeReplacements.index++;\n\t\t\t\t\t$sizeReplacementProgressBar.css('width', `${ Math.ceil( (sizeReplacements.index / sizeReplacements.forms.length) * 100 ) }%`);\n\t\t\t\t\timageChoicesAdmin.processSizeReplacement();\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\n\t\tif ( $sizeReplacementSubmit && $sizeReplacementSubmit.length ) {\n\n\t\t\t$sizeReplacementSubmit.on('click', function(e){\n\t\t\t\te.preventDefault();\n\n\t\t\t\tvar newSize = $sizeReplacementTool.find('#image_choices_image_replacement_size_select').val().trim();\n\t\t\t\tvar formId = $sizeReplacementTool.find('#image_choices_image_replacement_form_select').val().trim();\n\t\t\t\tif ( !newSize ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tsizeReplacements.new = newSize;\n\t\t\t\tsizeReplacements.forms = [];\n\t\t\t\tsizeReplacements.index = 0;\n\t\t\t\tsizeReplacements.replacements = [];\n\n\n\t\t\t\tif ( formId === \"all\" ) {\n\n\t\t\t\t\t$sizeReplacementStatus.html('Scanning for forms with image choices enabled...');\n\t\t\t\t\t$sizeReplacementProgressBar.css('width', '0%');\n\t\t\t\t\t$sizeReplacementTool.addClass('busy');\n\t\t\t\t\t$sizeReplacementProgress.addClass('active');\n\n\t\t\t\t\tif ( $urlReplacementTool.length ) {\n\t\t\t\t\t\t$urlReplacementTool.addClass('disabled');\n\t\t\t\t\t}\n\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\turl: window.ajaxurl,\n\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'gf_image_choices_get_image_size_replacement_form_ids',\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\t\tif ( response && response.success ) {\n\t\t\t\t\t\t\t\tif ( response.forms && response.forms.length ) {\n\t\t\t\t\t\t\t\t\tsizeReplacements.forms = response.forms\n\t\t\t\t\t\t\t\t\timageChoicesAdmin.processSizeReplacement();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t$sizeReplacementProgressBar.css('width', `100%`);\n\t\t\t\t\t\t\t\t\t$sizeReplacementStatus.html(`Done! No forms found with image choices enabled`);\n\t\t\t\t\t\t\t\t\t$sizeReplacementTool.removeClass('busy');\n\t\t\t\t\t\t\t\t\tif ( $urlReplacementTool.length ) {\n\t\t\t\t\t\t\t\t\t\t$urlReplacementTool.removeClass('disabled');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if ( response && response.error ) {\n\t\t\t\t\t\t\t\t$sizeReplacementStatus.html('Error: ' + response.error );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t$sizeReplacementStatus.html('Error');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\t$sizeReplacementStatus.html('...');\n\t\t\t\t\t$sizeReplacementProgressBar.css('width', '0%');\n\t\t\t\t\t$sizeReplacementTool.addClass('busy');\n\t\t\t\t\t$sizeReplacementProgress.addClass('active');\n\n\t\t\t\t\tif ( $urlReplacementTool.length ) {\n\t\t\t\t\t\t$urlReplacementTool.addClass('disabled');\n\t\t\t\t\t}\n\n\t\t\t\t\tsizeReplacements.forms = [ formId ];\n\t\t\t\t\timageChoicesAdmin.processSizeReplacement();\n\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t}\n\n\t};\n\n\tvar gformAdminReady = false;\n\tvar gformAdminReadyCheck;\n\n\t$(document).ready(function() {\n\t\tif ( !gformAdminReady ) {\n\t\t\tgformAdminReadyCheck = setInterval(function(){\n\t\t\t\tif ( typeof gform !== 'undefined' ) {\n\t\t\t\t\tgformAdminReady = true;\n\t\t\t\t\tclearInterval(gformAdminReadyCheck);\n\t\t\t\t\timageChoicesAdmin.adminInit();\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t}\n\t});\n\n\t$(document).bind( 'gform_main_scripts_loaded', function() {\n\n\t\tif ( typeof window.form !== 'undefined' ) {\n\t\t\tvar markupVersion = imageChoicesAdmin.markupDetect();\n\t\t\tif ( markupVersion === 1 && imageChoicesAdmin.formHasImageChoicesFields() ) {\n\t\t\t\timageChoicesAdmin.formEditorLegacyWarning();\n\t\t\t}\n\t\t\timageChoicesAdmin.formEditorInit();\n\t\t}\n\n\t});\n\n})(jQuery);\n"],"mappings":"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"}