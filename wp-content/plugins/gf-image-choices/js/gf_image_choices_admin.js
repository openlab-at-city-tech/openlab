var imageChoicesAdmin=imageChoicesAdmin||{};!function(e){var i=2;imageChoicesAdmin.markupDetect=function(){return void 0!==window.form&&window.form.hasOwnProperty("markupVersion")&&(i=""!==window.form.markupVersion?parseInt(window.form.markupVersion.toString(),10):1),i},imageChoicesAdmin.isLegacyMode=function(){return!(imageChoicesVars.hasOwnProperty("useNewFeatures")&&"true"===imageChoicesVars.useNewFeatures.toString())},imageChoicesAdmin.formHasImageChoicesFields=function(){var i=!1;return e.each(window.form.fields,(function(e,o){if(o.hasOwnProperty("imageChoices_enableImages")&&o.imageChoices_enableImages)return i=!0,!1})),i},imageChoicesAdmin.markup={removeChoicesButton:function(){return'<button class="button image-choices-remove-choices-btn" type="button" onclick="imageChoicesAdmin.removeAllChoices();">'+imageChoicesFieldStrings.removeAllChoices+"</button>"},choicesAdminRow:function(e,i,o){var t=void 0!==e?e:0,s=void 0!==i?i:"";o=void 0!==o?o:"";return['<button type="button" id="image-choices-option-upload-button-'+t+'" class="button image-choices-option-upload-button" onclick="imageChoicesAdmin.OpenMediaLibrary(this);" title="'+imageChoicesFieldStrings.uploadImage+'"><i class="ic-select-icon"></i></button>','<span id="image-choices-option-preview-'+t+'" class="image-choices-option-preview-wrap">','<span class="image-choices-option-preview" style="background-image:url('+s+');"></span>','<a href="javascript:void(0);" class="image-choices-option-image-remove" onclick="imageChoicesAdmin.RemovePreview(this);" title="'+imageChoicesFieldStrings.removeImage+'"><i class="dashicons dashicons-no"></i></a>',"</span>",'<input type="hidden" id="image-choices-option-image-'+t+'" class="image-choices-option-image" value="'+s+'" />','<input type="hidden" id="image-choices-option-image-id-'+t+'" class="image-choices-option-image-id" value="'+o+'" />'].join("")},choicesPreviewRow:function(e,i,o){var t=void 0!==o?o:"";return['<span class="image-choices-choice-image-wrap" style="background-image:url('+t+')">','<img src="'+t+'" alt="" class="image-choices-choice-image" />',"</span>",'<span class="image-choices-choice-text">'+(void 0!==i?i:"")+"</span>"].join("")}},imageChoicesAdmin.getChoices=function(i){void 0===i&&(i=GetSelectedField());imageChoicesAdmin.getSettingsElement().find('[class*="-choice-row"]').each((function(){var o=e(this),t=o.data("index"),s=i.choices.length&&void 0!==i.choices[t].imageChoices_image?i.choices[t].imageChoices_image:"",a=i.choices.length&&void 0!==i.choices[t].imageChoices_imageID?i.choices[t].imageChoices_imageID:"";if(!o.find(".image-choices-option-image").length){var c=o.find('input[id*="_choice_text"]:first');c.length||(c=o.find('input[id*="-choice-text"]:first')),c.length&&c.before(imageChoicesAdmin.markup.choicesAdminRow(t,s,a))}""!==o.find(".image-choices-option-image").val()&&o.addClass("image-choices-has-image")})),imageChoicesAdmin.updateFieldPreview(i)},imageChoicesAdmin.RemovePreview=function(i){if(void 0!==i){var o=e(i).closest('[class*="-choice-row"]');o.find(".image-choices-option-image").val(""),o.find(".image-choices-option-image-id").val(""),o.find(".image-choices-option-preview").css("background-image",""),o.removeClass("image-choices-has-image"),imageChoicesAdmin.UpdateFieldChoicesObject();var t=GetSelectedField();imageChoicesAdmin.updateFieldPreview(t)}},imageChoicesAdmin.UpdateFieldChoicesObject=function(){var i=GetSelectedField();imageChoicesAdmin.getSettingsElement().find('[class*="-choice-row"]').each((function(o){var t=e(this),s=t.find(".image-choices-option-image").val(),a=t.find(".image-choices-option-image-id").val(),c=t.data("index");""!==s?(t.addClass("image-choices-has-image"),t.find(".gf-image-choices-option-preview").css("background-image","url("+s+")")):t.removeClass("image-choices-has-image"),i.choices[c].imageChoices_image=s,i.choices[c].imageChoices_imageID=a}))},imageChoicesAdmin.updateFieldPreview=function(i){var o=e("#field_"+i.id),t=i.hasOwnProperty("imageChoices_enableImages")&&!0===i.imageChoices_enableImages;t&&(t&&void 0===i.imageChoices_showLabels&&imageChoicesAdmin.toggleShowLabels(!0),imageChoicesAdmin.$fieldChoices(o).each((function(o){var t=e(this);if(!t.hasClass("gchoice_total")){t.addClass("image-choices-choice");var s=t.find("label"),a=s.find(".image-choices-choice-text").length?s.find(".image-choices-choice-text").html():s.html();if(i.imageChoices_enableImages){if(i.choices.length>o){var c=void 0!==i.choices[o].imageChoices_image?i.choices[o].imageChoices_image:"";s.html(imageChoicesAdmin.markup.choicesPreviewRow(o,a,c))}}else s.html(a)}})))},imageChoicesAdmin.getField=function(){var i=GetSelectedField();return e("#field_"+i.id)},imageChoicesAdmin.removeAllChoices=function(){imageChoicesAdmin.getSettingsElement().find(".image-choices-option-image-remove").each((function(){e(this).trigger("click")})),$settingsWrap.find(".gf_delete_field_choice").each((function(){e(this).trigger("click")})),$settingsWrap.find('.field-choice-row input[type="text"], .gquiz-choice-row input[type="text"]').val("")},imageChoicesAdmin.isColorPickerPluginActive=function(){return window.hasOwnProperty("colorPickerFieldVars")&&void 0!==window.colorPickerFieldVars},imageChoicesAdmin.toggleEnableImages=function(e){var i=imageChoicesAdmin.getSettingsElement(),o=i.find("input.field_choice_images_enabled"),t=i.find("input.field_color_picker_enabled");void 0===e&&(e=o.is(":checked")),e&&imageChoicesAdmin.isColorPickerPluginActive()&&t.length&&t.is(":checked")?window.confirm(imageChoicesFieldStrings.confirmImagesToggle)?(window.hasOwnProperty("colorPicker_toggleEnableColors")&&"function"==typeof window.colorPicker_toggleEnableColors&&window.colorPicker_toggleEnableColors(!1),imageChoicesAdmin.onToggleEnableImages(e)):o.prop("checked",!1):imageChoicesAdmin.onToggleEnableImages(e)},window.imageChoices_toggleEnableImages=imageChoicesAdmin.toggleEnableImages,imageChoicesAdmin.onToggleEnableImages=function(i){var o=GetSelectedField();if(o){var t=imageChoicesAdmin.getField(),s=imageChoicesAdmin.getSettingsElement(),a=s.find("input.field_choice_images_enabled");void 0===i&&(i=a.is(":checked")),SetFieldProperty("imageChoices_enableImages",i),a.prop("checked",i),e("#image_choices_tab_toggle").toggle(i);var c="quiz"===o.type.toLowerCase()?"#gquiz_gfield_settings_choices_container":"#gfield_settings_choices_container";e(c).toggleClass("image-choices-enabled",i),t.toggleClass("image-choices-use-images",i),s.toggleClass("image-choices-use-images",i);var n=s.find(".image-choices-remove-choices-btn");i||n.length&&n.remove();var m=e(".field_setting.other_choice_setting");("radio"===o.type||"poll"===o.type&&"radio"===o.inputType)&&m.show(),imageChoicesAdmin.updateFieldPreview(o)}},imageChoicesAdmin.toggleShowLabels=function(e){var i=imageChoicesAdmin.getField(),o=imageChoicesAdmin.getSettingsElement().find("input.image_choices_show_labels");void 0===e&&(e=o.is(":checked")),SetFieldProperty("imageChoices_showLabels",e),o.prop("checked",e),i.toggleClass("image-choices-show-labels",e)},imageChoicesAdmin.toggleShowPrices=function(e){var i=imageChoicesAdmin.getField(),o=imageChoicesAdmin.getSettingsElement().find("input.image_choices_show_prices");void 0===e&&(e=o.is(":checked")),SetFieldProperty("imageChoices_showPrices",e),o.prop("checked",e),i.toggleClass("image-choices-show-prices",e)},imageChoicesAdmin.toggleUseLightboxCaption=function(e){imageChoicesAdmin.getField();var i=imageChoicesAdmin.getSettingsElement().find("input.image_choices_use_lightbox_caption");void 0===e&&(e=i.is(":checked")),SetFieldProperty("imageChoices_useLightboxCaption",e),i.prop("checked",e)},imageChoicesAdmin.toggleUseLightbox=function(i){var o=imageChoicesAdmin.getField(),t=imageChoicesAdmin.getSettingsElement().find("input.image_choices_use_lightbox");if(void 0===i&&(i=t.is(":checked")),SetFieldProperty("imageChoices_useLightbox",i),t.prop("checked",i),o.toggleClass("image-choices-use-lightbox",i),i){var s=GetSelectedField();e.each(s.choices,(function(e,i){var o=i.hasOwnProperty("imageChoices_image")&&""!==i.imageChoices_image,t=i.hasOwnProperty("imageChoices_imageID")&&""!==i.imageChoices_imageID;if(o&&!t)return window.alert(imageChoicesFieldStrings.useLightboxWarning),!1}))}},imageChoicesAdmin.updateEntrySetting=function(e){SetFieldProperty("imageChoices_entrySetting",e),imageChoicesAdmin.getSettingsElement().find("#image-choices-entry-value").val(e)},imageChoicesAdmin.OpenMediaLibrary=function(i){if(void 0!==i){var o=e(i).closest('[class*="-choice-row"]'),t=o.data("file-frame");t?t.open():(t=wp.media({title:"Select an image to upload",button:{text:"Use this image"},frame:"post",state:"insert",multiple:!1}),setTimeout((function(){e('input[value="Insert into Post"]').val("Use this Image"),e("button.media-button-insert").text("Use this Image")}),100),jQuery("body").on("click","li.attachment",(function(){e('input[value="Insert into Post"]').val("Use this Image"),e("button.media-button-insert").text("Use this Image")})),t.on("insert",(function(i){var s=t.state();if(i=i||s.get("selection")){var a=i.first(),c=s.display(a).toJSON();a=a.toJSON();var n,m=["medium","thumbnail","full"];if(c&&c.hasOwnProperty("size")&&c.size&&m.unshift(c.size),a.hasOwnProperty("sizes")){for(var g=0,l=m[g].toString();!a.sizes.hasOwnProperty(l)||!a.sizes[l].hasOwnProperty("url")||""===a.sizes[l].url;)l=m[++g].toString();n=a.sizes[l].url,l}else n=a.url,"full";o.find(".image-choices-option-image").val(n),o.find(".image-choices-option-image-id").val(a.id),o.find(".image-choices-option-preview").css("background-image","url("+n+")"),o.addClass("image-choices-has-image"),imageChoicesAdmin.UpdateFieldChoicesObject();var h=GetSelectedField();imageChoicesAdmin.updateFieldPreview(h);var d=e("#choices-ui-flyout");d.length&&d.addClass("gform-flyout--anim-in-ready gform-flyout--anim-in-active")}})),t.open(),o.data("file-frame",t))}},imageChoicesAdmin.fieldCanHaveImages=function(e){if(void 0===e||!e.hasOwnProperty("type"))return!1;var i="radio"===e.type||"checkbox"===e.type||"quiz"===e.type&&"radio"==e.inputType||"quiz"===e.type&&"checkbox"==e.inputType||"poll"===e.type&&"radio"==e.inputType||"poll"===e.type&&"checkbox"==e.inputType||"post_custom_field"===e.type&&"radio"==e.inputType||"post_custom_field"===e.type&&"checkbox"==e.inputType||"survey"===e.type&&"radio"==e.inputType||"survey"===e.type&&"checkbox"==e.inputType||"product"===e.type&&"radio"==e.inputType||"option"===e.type&&"radio"==e.inputType||"option"===e.type&&"checkbox"==e.inputType;return gform.applyFilters("gfic_field_can_have_images",i,e)},imageChoicesAdmin.$fieldChoices=function(e){if(void 0===e||e instanceof jQuery==!1)return[];return e.find('.ginput_container .gfield_radio div[class*="gchoice"], .ginput_container .gfield_checkbox .gchoice:not(.gchoice_select_all)')},imageChoicesAdmin.getSettingsElement=function(){var i="#field_settings_container";return i+="quiz"===GetSelectedField().type?", #gquiz_gfield_settings_choices_container":", #gfield_settings_choices_container",e(i)},imageChoicesAdmin.previewHeight=function(e){if("object"!=typeof e){var i=imageChoicesAdmin.getField();e=i.find(".ginput_container")}e.length&&e.closest(".gfield").hasClass("image-choices-admin-field")&&setTimeout((function(){e.height(e.find("> ul:first").outerHeight())}),20)},imageChoicesAdmin.updateThemeSetting=function(i){SetFieldProperty("imageChoices_theme",i),imageChoicesAdmin.getSettingsElement().find("#image-choices-theme").val(i);var o,t=e("#image-choices-theme-preview");t.toggle("none"!==i),"none"===i?t.hide().find("img").hide():"form_setting"===i?((i=window.form.hasOwnProperty("gf-image-choices")&&window.form["gf-image-choices"].hasOwnProperty("gf_image_choices_theme")?window.form["gf-image-choices"].gf_image_choices_theme:"")&&"global_setting"!==i||(i=imageChoicesVars.hasOwnProperty("globals")&&imageChoicesVars.globals.hasOwnProperty("theme")?imageChoicesVars.globals.theme:imageChoicesVars.hasOwnProperty("defaults")&&imageChoicesVars.defaults.hasOwnProperty("theme")?imageChoicesVars.defaults.theme:"simple"),t.find("img").hide(),(o=t.find("img.image-choices-theme-preview-"+i)).length&&o.show()):(t.find("img").hide(),(o=t.find("img.image-choices-theme-preview-"+i)).length&&o.show())},imageChoicesAdmin.updateFeatureColorSetting=function(e){SetFieldProperty("imageChoices_featureColor",e);var i=imageChoicesAdmin.getSettingsElement().find('[for="image-choices-feature-color-custom"]'),o=imageChoicesAdmin.getSettingsElement().find("#image-choices-feature-color-custom"),t=imageChoicesAdmin.getSettingsElement().find(".image-choices-setting-feature-color .wp-picker-container"),s=o.val();imageChoicesAdmin.getSettingsElement().find("#image-choices-feature-color").val(e),"custom"===e?(i.show(),o.show(),t.length?(t.show(),setTimeout((function(){""!==s?o.wpColorPicker("color",s):t.find(".wp-picker-clear").trigger("click")}),100)):(o.wpColorPicker({change:function(e,i){imageChoicesAdmin.updateCustomFeatureColor(i.color.toString())}}),setTimeout((function(){""!==s?o.wpColorPicker("color",s):t.find(".wp-picker-clear").trigger("click")}),100))):(i.hide(),o.hide(),t.length&&(t.find(".wp-picker-clear").trigger("click"),t.hide()))},imageChoicesAdmin.updateCustomFeatureColor=function(e){imageChoicesAdmin.getSettingsElement().find("#image-choices-feature-color-custom").val(e),SetFieldProperty("imageChoices_featureColorCustom",e)},imageChoicesAdmin.updateAlignSetting=function(e){SetFieldProperty("imageChoices_align",e),imageChoicesAdmin.getSettingsElement().find("#image-choices-align").val(e)},imageChoicesAdmin.updateImageStyleSetting=function(e){SetFieldProperty("imageChoices_imageStyle",e),imageChoicesAdmin.getSettingsElement().find("#image-choices-image-style").val(e)},imageChoicesAdmin.validateNumericValue=function(e){var i="";if(""!==(e=e.toString()).trim()){var o=parseInt(e,10);i=isNaN(o)||o<=0?"":o.toString()}return i!==e?i:e},imageChoicesAdmin.updateColumnsSetting=function(e){SetFieldProperty("imageChoices_columns",e);var i=imageChoicesAdmin.getSettingsElement();i.find("#image-choices-columns").val(e),i.find(".image-choices-setting-columns-width").toggle("fixed"===e)},imageChoicesAdmin.updateColumnsWidthSetting=function(e){var i=imageChoicesAdmin.validateNumericValue(e);SetFieldProperty("imageChoices_columnsWidth",i),imageChoicesAdmin.getSettingsElement().find("#image-choices-columns-width").val(i)},imageChoicesAdmin.updateColumnsMediumSetting=function(e){SetFieldProperty("imageChoices_columnsMedium",e);var i=imageChoicesAdmin.getSettingsElement();i.find("#image-choices-columns-medium").val(e),i.find(".image-choices-setting-columns-width-medium").toggle("fixed"===e)},imageChoicesAdmin.updateColumnsMediumWidthSetting=function(e){var i=imageChoicesAdmin.validateNumericValue(e);SetFieldProperty("imageChoices_columnsWidthMedium",i),imageChoicesAdmin.getSettingsElement().find("#image-choices-columns-width-medium").val(i)},imageChoicesAdmin.updateColumnsSmallSetting=function(e){SetFieldProperty("imageChoices_columnsSmall",e);var i=imageChoicesAdmin.getSettingsElement();i.find("#image-choices-columns-small").val(e),i.find(".image-choices-setting-columns-width-small").toggle("fixed"===e)},imageChoicesAdmin.updateColumnsSmallWidthSetting=function(e){var i=imageChoicesAdmin.validateNumericValue(e);SetFieldProperty("imageChoices_columnsWidthSmall",i),imageChoicesAdmin.getSettingsElement().find("#image-choices-columns-width-small").val(i)},imageChoicesAdmin.updateHeightSetting=function(e){var i=imageChoicesAdmin.validateNumericValue(e);SetFieldProperty("imageChoices_height",i),imageChoicesAdmin.getSettingsElement().find("#image-choices-height").val(i)},imageChoicesAdmin.updateMediumHeightSetting=function(e){var i=imageChoicesAdmin.validateNumericValue(e);SetFieldProperty("imageChoices_heightMedium",i),imageChoicesAdmin.getSettingsElement().find("#image-choices-height-medium").val(i)},imageChoicesAdmin.updateSmallHeightSetting=function(e){var i=imageChoicesAdmin.validateNumericValue(e);SetFieldProperty("imageChoices_heightSmall",i),imageChoicesAdmin.getSettingsElement().find("#image-choices-height-small").val(i)},imageChoicesAdmin.formEditorInit=function(){e(".gfield.image-choices-admin-field").each((function(){imageChoicesAdmin.$fieldChoices(e(this)).each((function(){let i=e(this);i.hasClass("gchoice_total")||i.addClass("image-choices-choice")}))})),e("#gform_fields .gfield .ginput_container").each((function(){imageChoicesAdmin.previewHeight(e(this))})),e(window).on("gf_update_field_choices",(function(){setTimeout((function(){imageChoicesAdmin.getChoices()}),10),imageChoicesAdmin.previewHeight()})),e(document).on("click",".gf_insert_field_choice, .gf_delete_field_choice",(function(e){imageChoicesAdmin.previewHeight()})),gform.addAction("gform_load_field_choices",(function(i){var o=void 0!==i&&i.length?i[0]:GetSelectedField();setTimeout((function(){var i=e("#field_"+o.id),t=imageChoicesAdmin.getSettingsElement();if(imageChoicesAdmin.fieldCanHaveImages(o)){var s=!0===o.imageChoices_enableImages,a=void 0!==o.imageChoices_useLightbox&&o.imageChoices_useLightbox,c=void 0===o.imageChoices_showLabels||o.imageChoices_showLabels,n="product"===o.type&&void 0!==o.imageChoices_showPrices&&o.imageChoices_showPrices,m=void 0!==o.imageChoices_entrySetting?o.imageChoices_entrySetting:"form_setting",g=void 0!==o.imageChoices_theme?o.imageChoices_theme:"form_setting",l=void 0!==o.imageChoices_featureColor?o.imageChoices_featureColor:"form_setting",h=void 0!==o.imageChoices_featureColorCustom?o.imageChoices_featureColorCustom:"",d=void 0!==o.imageChoices_align?o.imageChoices_align:"form_setting",r=void 0!==o.imageChoices_imageStyle?o.imageChoices_imageStyle:"form_setting",u=void 0!==o.imageChoices_columns?o.imageChoices_columns:"form_setting",f=void 0!==o.imageChoices_columnsWidth?o.imageChoices_columnsWidth:"",_=void 0!==o.imageChoices_columnsMedium?o.imageChoices_columnsMedium:"form_setting",C=void 0!==o.imageChoices_columnsWidthMedium?o.imageChoices_columnsWidthMedium:"",p=void 0!==o.imageChoices_columnsSmall?o.imageChoices_columnsSmall:"form_setting",v=void 0!==o.imageChoices_columnsWidthSmall?o.imageChoices_columnsWidthSmall:"",w=void 0===o.imageChoices_useLightboxCaption||o.imageChoices_useLightboxCaption;"form_setting"!==w&&""!==w||(w=!0);var A=void 0!==o.imageChoices_height?o.imageChoices_height:"",S=void 0!==o.imageChoices_heightMedium?o.imageChoices_heightMedium:"",b=void 0!==o.imageChoices_heightSmall?o.imageChoices_heightSmall:"";i.toggleClass("image-choices-admin-field",s),t.addClass("image-choices-field-settings"),t.toggleClass("image-choices-product-field","product"===o.type),imageChoicesAdmin.toggleEnableImages(s),imageChoicesAdmin.toggleUseLightbox(a),imageChoicesAdmin.toggleShowLabels(c),imageChoicesAdmin.toggleShowPrices(n),imageChoicesAdmin.updateEntrySetting(m),imageChoicesAdmin.toggleUseLightboxCaption(w),imageChoicesAdmin.isLegacyMode()||(imageChoicesAdmin.updateThemeSetting(g),imageChoicesAdmin.updateCustomFeatureColor(h),imageChoicesAdmin.updateFeatureColorSetting(l),imageChoicesAdmin.updateAlignSetting(d),imageChoicesAdmin.updateImageStyleSetting(r),imageChoicesAdmin.updateHeightSetting(A),imageChoicesAdmin.updateMediumHeightSetting(S),imageChoicesAdmin.updateSmallHeightSetting(b),imageChoicesAdmin.updateColumnsWidthSetting(f),imageChoicesAdmin.updateColumnsMediumWidthSetting(C),imageChoicesAdmin.updateColumnsSmallWidthSetting(v),imageChoicesAdmin.updateColumnsSetting(u),imageChoicesAdmin.updateColumnsMediumSetting(_),imageChoicesAdmin.updateColumnsSmallSetting(p)),imageChoicesAdmin.getChoices(o)}else imageChoicesAdmin.toggleEnableImages(!1),imageChoicesAdmin.toggleUseLightboxCaption(!0),imageChoicesAdmin.isLegacyMode()||(imageChoicesAdmin.updateThemeSetting("form_setting"),imageChoicesAdmin.updateCustomFeatureColor(""),imageChoicesAdmin.updateFeatureColorSetting("form_setting"),imageChoicesAdmin.updateAlignSetting("form_setting"),imageChoicesAdmin.updateImageStyleSetting("form_setting"),imageChoicesAdmin.updateHeightSetting(""),imageChoicesAdmin.updateMediumHeightSetting(""),imageChoicesAdmin.updateSmallHeightSetting(""),imageChoicesAdmin.updateColumnsWidthSetting(""),imageChoicesAdmin.updateColumnsMediumWidthSetting(""),imageChoicesAdmin.updateColumnsSmallWidthSetting(""),imageChoicesAdmin.updateColumnsSetting("form_setting"),imageChoicesAdmin.updateColumnsMediumSetting("form_setting"),imageChoicesAdmin.updateColumnsSmallSetting("form_setting")),i.removeClass("image-choices-admin-field"),i.removeClass("image-choices-show-labels"),t.removeClass("image-choices-field-settings"),t.remove("image-choices-product-field")}),100)})),e(document).bind("gform_load_field_settings",(function(i,o,t){"function"!=typeof window.imageChoices_GF_UpdateFieldChoices&&(window.imageChoices_GF_UpdateFieldChoices=UpdateFieldChoices,window.UpdateFieldChoices=function(){window.imageChoices_GF_UpdateFieldChoices.apply(this,arguments),e(window).trigger("gf_update_field_choices")}),imageChoicesAdmin.previewHeight()}))},imageChoicesAdmin.formEditorLegacyWarning=function(){},e(document).bind("gform_main_scripts_loaded",(function(){void 0!==window.form&&(1===imageChoicesAdmin.markupDetect()&&imageChoicesAdmin.formHasImageChoicesFields()&&imageChoicesAdmin.formEditorLegacyWarning(),imageChoicesAdmin.formEditorInit());var i=e("#gf_image_choices_custom_css_global, #gf_image_choices_custom_css, #gf_image_choices_user_css_global, #gf_image_choices_user_css_form");if(i.length){var o=wp.codeEditor.defaultSettings?_.clone(wp.codeEditor.defaultSettings):{};o.codemirror=_.extend({},o.codemirror,{indentUnit:4,tabSize:4,mode:"css",lineNumbers:!0,autoCloseBrackets:!0,continueComments:!0,indentWithTabs:!0,inputStyle:"contenteditable",lineWrapping:!0,lint:!1,matchBrackets:!0,styleActiveLine:!0,gutters:[],extraKeys:{"Alt-F":"findPersistent","Cmd-F":"findPersistent","Ctrl-F":"findPersistent","Cmd-/":"toggleComment","Ctrl-/":"toggleComment","Ctrl-Space":"autocomplete"}}),i.each((function(){window[this.id+"_editor"]=wp.codeEditor.initialize(e(this),o)}))}var t=e("#gform_settings_section_collapsed_gf_image_choices_legacy_custom_css_section, #gform_settings_section_collapsed_gf_image_choices_legacy_custom_form_css_section");t.length&&t.on("click",(function(){e(this).closest(".gform-settings-panel").find("textarea").each((function(){var i=e(this).attr("id")+"_editor";try{window[i].codemirror.refresh()}catch(e){}}))}));var s=e("#_gform_setting_gf_image_choices_use_legacy_styles"),a=e("#gform-settings-section-theme, #gform-settings-section-feature-color, #gform-settings-section-choices-layout, #gform-settings-section-image-options, #gform-settings-section-custom-css, #gform-settings-section-gf_image_choices_legacy_custom_css_section .gform-settings-label");s.length&&(s.on("change",(function(e){var i=s.is(":checked");a.length&&a.toggle(!i),t.length&&(i&&t.is(":checked")||!i&&!t.is(":checked"))&&t.click()})),s.trigger("change"));var c=e("#tab_gf-image-choices .gform-settings-tabs__navigation a");c.length&&c.each((function(){e(this).on("click",(function(i){e("#tab_gf-image-choices #gform-settings-save").toggle("gf_image_choices_settings_tab"===e(this).data("tab"))}))}));var n=e('input[id^="gf_image_choices"][id*="columns_width"], input[id^="gf_image_choices"][id*="height"]');n.length&&n.each((function(){e(this).on("keyup",(function(e){var i=e.currentTarget.value.toString(),o=imageChoicesAdmin.validateNumericValue(i);o!==i&&(e.currentTarget.value=o)}))}));var m=e("#gf_image_choices_theme, #gf_image_choices_global_theme").first(),g=e("#gform_setting_gf_image_choices_theme_preview .image-choices-theme-preview, #gform_setting_gf_image_choices_global_theme_preview .image-choices-theme-preview").first();m.length&&g.length&&(m.on("change",(function(i){var o=e(this).val();""!==o&&"global_setting"!=o||(o=imageChoicesVars.hasOwnProperty("globals")&&imageChoicesVars.globals.hasOwnProperty("theme")?imageChoicesVars.globals.theme:imageChoicesVars.hasOwnProperty("defaults")&&imageChoicesVars.defaults.hasOwnProperty("theme")?imageChoicesVars.defaults.theme:"simple"),g.toggle("none"!==o),"none"===o?g.hide().find("img").hide():(g.find("img").hide(),g.find("img.image-choices-theme-preview-"+o).show())})),m.trigger("change"));var l,h,d=e("#gf_image_choices_feature_color, #gf_image_choices_global_feature_color").first(),r=e("#gform_setting_gf_image_choices_feature_color_custom, #gform_setting_gf_image_choices_global_feature_color_custom").first(),u=e("#gf_image_choices_feature_color_custom, #gf_image_choices_global_feature_color_custom").first();d.length&&r.length&&(h=r.find(".wp-picker-container"),l=u.val(),d.on("change",(function(i){"custom"===e(this).val()?(r.show(),h.length?setTimeout((function(){""!==customColor?u.wpColorPicker("color",l):h.find(".wp-picker-clear").trigger("click")}),100):(u.wpColorPicker(),setTimeout((function(){""!==l?u.wpColorPicker("color",l):h.find(".wp-picker-clear").trigger("click")}),100))):(r.hide(),h.length&&h.find(".wp-picker-clear").trigger("click"))})),d.trigger("change"));var f=e("#image_choices_url_replacement"),C=f.length?e("#image_choices_url_replacement_submit"):null,p=f.length?f.find(".jetbase-tool__progress"):null,v=f.length?f.find(".jetbase-tool__progress-percent"):null,w=f.length?f.find(".jetbase-tool__progress-status"):null,A={old:"",new:"",forms:[],index:0,replacements:[]};imageChoicesAdmin.processUrlReplacement=function(){if(!A.forms.length||A.replacements.length===A.forms.length||A.index>=A.forms.length)return v.css("width","100%"),w.html(`Done! ${A.forms.length} form(s) processed`),f.removeClass("busy"),void(S.length&&S.removeClass("disabled"));e.ajax({url:window.ajaxurl,method:"POST",data:{action:"gf_image_choices_url_replacement",id:A.forms[A.index],old:A.old,new:A.new},beforeSend:function(e,i){w.html(`Processing form ${A.index+1}/${A.forms.length}`)},success:function(e){e&&e.success?A.replacements[A.index]=e.total:e&&e.error?(A.replacements[A.index]=!1,w.html("Error: "+e.error)):(A.replacements[A.index]=!1,w.html("Error")),A.index++,v.css("width",`${Math.ceil(A.index/A.forms.length*100)}%`),imageChoicesAdmin.processUrlReplacement()}})},C&&C.length&&C.on("click",(function(i){i.preventDefault();var o=f.find("#image_choices_url_replacement_form_select").val().trim(),t=f.find("#image_choices_url_replacement_from_input").val().trim(),s=f.find("#image_choices_url_replacement_to_input").val().trim();t&&s&&t!==s&&(A.old=t,A.new=s,A.forms=[],A.index=0,A.replacements=[],"all"===o?(w.html("Scanning for forms with old URL in image choices..."),v.css("width","0%"),f.addClass("busy"),p.addClass("active"),S.length&&S.addClass("disabled"),e.ajax({url:window.ajaxurl,method:"POST",data:{action:"gf_image_choices_get_url_replacement_form_ids",form_id:A.formId,old:A.old,new:A.new},success:function(e){e&&e.success?e.forms&&e.forms.length?(A.forms=e.forms,imageChoicesAdmin.processUrlReplacement()):(v.css("width","100%"),w.html("Done! No image choices found containing that old URL"),f.removeClass("busy"),S.length&&S.removeClass("disabled")):e&&e.error?w.html("Error: "+e.error):w.html("Error")}})):(w.html("..."),v.css("width","0%"),f.addClass("busy"),p.addClass("active"),S.length&&S.addClass("disabled"),A.forms=[o],imageChoicesAdmin.processUrlReplacement()))}));var S=e("#image_choices_image_replacement"),b=S.length?e("#image_choices_image_replacement_submit"):null,y=S.length?S.find(".jetbase-tool__progress"):null,P=S.length?S.find(".jetbase-tool__progress-percent"):null,k=S.length?S.find(".jetbase-tool__progress-status"):null,F={new:"",forms:[],index:0,replacements:[]};imageChoicesAdmin.processSizeReplacement=function(){if(!F.forms.length||F.replacements.length===F.forms.length||F.index>=F.forms.length)return P.css("width","100%"),k.html(`Done! ${F.forms.length} form(s) processed`),S.removeClass("busy"),void(f.length&&f.removeClass("disabled"));e.ajax({url:window.ajaxurl,method:"POST",data:{action:"gf_image_choices_image_size_replacement",id:F.forms[F.index],new:F.new},beforeSend:function(e,i){k.html(`Processing form ${F.index+1}/${F.forms.length}`)},success:function(e){e&&e.success?F.replacements[F.index]=e.total:e&&e.error?(F.replacements[F.index]=!1,k.html("Error: "+e.error)):(F.replacements[F.index]=!1,k.html("Error")),F.index++,P.css("width",`${Math.ceil(F.index/F.forms.length*100)}%`),imageChoicesAdmin.processSizeReplacement()}})},b&&b.length&&b.on("click",(function(i){i.preventDefault();var o=S.find("#image_choices_image_replacement_size_select").val().trim(),t=S.find("#image_choices_image_replacement_form_select").val().trim();o&&(F.new=o,F.forms=[],F.index=0,F.replacements=[],"all"===t?(k.html("Scanning for forms with image choices enabled..."),P.css("width","0%"),S.addClass("busy"),y.addClass("active"),f.length&&f.addClass("disabled"),e.ajax({url:window.ajaxurl,method:"POST",data:{action:"gf_image_choices_get_image_size_replacement_form_ids"},success:function(e){e&&e.success?e.forms&&e.forms.length?(F.forms=e.forms,imageChoicesAdmin.processSizeReplacement()):(P.css("width","100%"),k.html("Done! No forms found with image choices enabled"),S.removeClass("busy"),f.length&&f.removeClass("disabled")):e&&e.error?k.html("Error: "+e.error):k.html("Error")}})):(k.html("..."),P.css("width","0%"),S.addClass("busy"),y.addClass("active"),f.length&&f.addClass("disabled"),F.forms=[t],imageChoicesAdmin.processSizeReplacement()))}))}))}(jQuery);
//# sourceMappingURL=gf_image_choices_admin.js.map
