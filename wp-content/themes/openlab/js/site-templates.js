(()=>{"use strict";const{endpoint:e,perPage:t,categoryMap:n}=window.SiteTemplatePicker,a=window.CBOXOL_Group_Create.new_group_type;const s=document.querySelector("#site-template-categories"),o=document.querySelector(".site-template-picker"),i=document.querySelector(".panel-template-picker"),l=document.querySelector(".site-template-pagination"),r=document.querySelector('[name="source_blog"]'),c=document.querySelector("#set-up-site-toggle"),d=document.querySelectorAll('[name="new_or_old"]'),p=window.SiteTemplatePicker.messages,u=window.SiteTemplatePicker.defaultMap,m=window.CBOXOL_Group_Create?.new_group_type||null,g=m&&u.hasOwnProperty(m)?u[m]:0,v=g?g.toString():r.value;function h(s,i){o.innerHTML=`<p>${p.loading}</p>`,async function(s){let o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(s)o=s;else for(var l in o=[0],n)-1!==n[l].indexOf(a)&&o.push(l);const r=function(e){let t="";const n=Object.entries(e);let a;for(;a=n.shift();){let[e,s]=a;if(Array.isArray(s)||s&&s.constructor===Object){const t=Object.entries(s).reverse();for(const[a,s]of t)n.unshift([`${e}[${a}]`,s])}else void 0!==s&&(null===s&&(s=""),t+="&"+[e,s].map(encodeURIComponent).join("="))}return t.substr(1)}({_fields:["id","title","excerpt","featured_media","template_category","site_id","image","categories"],template_category:o,order:"desc",per_page:Number(t),page:i}),c=await fetch(e+"?"+r),d=await c.json();if(!c.ok)throw new Error(d.message);const p=Number(c.headers.get("X-WP-TotalPages"));return{templates:d.map((e=>({id:e.id,title:e.title.rendered,excerpt:e.excerpt.rendered,image:e.image,categories:e.categories,siteId:e.site_id}))),prev:i>1?i-1:null,next:p>i?i+1:null}}(s,i).then((e=>{let{templates:t,prev:n,next:a}=e;if(!t.length)return void(o.innerHTML=`<p>${p.noResults}</p>`);const s=t.map((e=>function(e){let{id:t,siteId:n,title:a,excerpt:s,image:o,categories:i}=e;return`\n\t<button type="button" class="site-template-component" data-template-id="${t}" data-template-site-id="${n}">\n\t\t<div class="site-template-component__image">\n\t\t\t${o?`<img src="${o}" alt="${a}">`:'<svg fill="currentColor" width="24" height="24" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"></path></svg>'}\n\t\t</div>\n\t\t<div class="site-template-component__meta">\n\t\t\t<span class="site-template-component__category">${i.join(", ")}</span>\n\t\t\t<div class="site-template-component__name">${a}</div>\n\t\t\t<div class="site-template-component__description">${s}</div>\n\t\t</div>\n\t</button>\n\t`}(e))).join("");o.innerHTML=s,_(v),function(e,t){const n=l.querySelector(".prev"),a=l.querySelector(".next"),s=l.classList.contains("hidden");!e&&!t&&!s&&l.classList.add("hidden"),n.disabled=!0,a.disabled=!0,e&&(n.dataset.page=e,n.disabled=!1),t&&(a.dataset.page=t,a.disabled=!1)}(n,a),t.length>1&&f(!c||c.checked),function(){const e=document.querySelector(".site-template-categories");let t=0;const n=e.querySelectorAll("option");for(const e of n)"0"!==e.value&&t++;t<=1?e.classList.add("hidden"):e.classList.remove("hidden")}()}))}function f(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?o.querySelectorAll(".site-template-component").length>1&&i.classList.remove("hidden"):(i.classList.add("hidden"),_(v))}function _(e){o.querySelectorAll(".site-template-component").forEach((t=>{t.dataset.templateId===e?(t.classList.add("is-selected"),r.value=t.dataset.templateSiteId):t.classList.remove("is-selected")}))}s.addEventListener("change",(function(e){const t="0"!==e.target.value?e.target.value:null;o.innerHTML=`<p>${p.loading}</p>`,h(t)})),o.addEventListener("click",(function(e){const t=e.target.closest(".site-template-component");t&&_(t.dataset.templateId)})),o.addEventListener("mouseover",(function(e){const t=e.target.closest(".site-template-component");t&&(t.classList.contains("has-hover")||t.classList.add("has-hover"))})),o.addEventListener("mouseout",(function(e){const t=e.target.closest(".site-template-component");t&&t.classList.contains("has-hover")&&t.classList.remove("has-hover")})),l.addEventListener("click",(function(e){const t=e.target.closest(".btn");t&&h("0"!==s.value?s.value:null,t.dataset.page?Number(t.dataset.page):null)})),d.forEach((e=>{e.addEventListener("change",(e=>f("new"===e.target.value)))})),c?(c.addEventListener("change",(e=>f(e.target.checked))),c.checked&&f(!0)):f(!0),h()})();